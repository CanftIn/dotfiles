<?xml version="1.0" encoding="utf-8"?>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-04-13 Mon 01:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Doom Emacs Configuration</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="tecosaur" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel='shortcut icon' type='image/png' href='https://www.gnu.org/software/emacs/favicon.png'>

<style type="text/css">
   :root {
      --theme-bg: #242730;
      --theme-bg-alt: #2a2e38;
      --theme-base0: #1c1f24;
      --theme-base1: #1c1f24;
      --theme-base2: #21272d;
      --theme-base3: #23272e;
      --theme-base4: #484854;
      --theme-base5: #62686E;
      --theme-base6: #757B80;
      --theme-base7: #9ca0a4;
      --theme-base8: #DFDFDF;
      --theme-fg: #bbc2cf;
      --theme-fg-alt: #5D656B;
      --theme-grey: #484854;
      --theme-red: #ff665c;
      --theme-orange: #e69055;
      --theme-green: #7bc275;
      --theme-teal: #4db5bd;
      --theme-yellow: #FCCE7B;
      --theme-blue: #51afef;
      --theme-dark-blue: #1f5582;
      --theme-magenta: #C57BDB;
      --theme-violet: #a991f1;
      --theme-cyan: #5cEfFF;
      --theme-dark-cyan: #6A8FBF;
   }
</style>
<link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css'/>
<link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css'/>

<script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js'></script>
<script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js'></script>

<style>
   pre.src {
     background-color: var(--theme-bg);
     color: var(--theme-fg);
     scrollbar-color:#bbb6#9992;
     scrollbar-width: thin;
     margin: 0;
     border: none;
   }
   div.org-src-container {
     border-radius: 12px;
     overflow: hidden;
     margin-bottom: 24px;
     margin-top: 1px;
     border: 1px solid#e1e4e5;
   }
   pre.src::before {
     background-color:#6666;
     top: 8px;
     border: none;
     border-radius: 5px;
     line-height: 1;
     border: 2px solid var(--theme-bg);
     opacity: 0;
     transition: opacity 200ms;
   }
   pre.src:hover::before { opacity: 1; }
   pre.src:active::before { opacity: 0; }

   pre.example {
     border-radius: 12px;
     background: var(--theme-bg-alt);
     color: var(--theme-fg);
   }

   code {
     border-radius: 5px;
     background:#e8e8e8;
     font-size: 80%;
   }

   kbd {
     display: inline-block;
     padding: 3px 5px;
     font: 80% SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;
     line-height: normal;
     line-height: 10px;
     color:#444d56;
     vertical-align: middle;
     background-color:#fafbfc;
     border: 1px solid#d1d5da;
     border-radius: 3px;
     box-shadow: inset 0 -1px 0#d1d5da;
   }

   table {
     max-width: 100%;
     overflow-x: auto;
     display: block;
     border-top: none;
   }

   a {
       text-decoration: none;
       background-image: linear-gradient(#d8dce9, #d8dce9);
       background-position: 0% 100%;
       background-repeat: no-repeat;
       background-size: 0% 2px;
       transition: background-size .3s;
   }
   #table-of-contents a {
       background-image: none;
   }
   a:hover, a:focus {
       background-size: 100% 2px;
   }
   a[href^='#'] { font-variant-numeric: oldstyle-nums; }
   a[href^='#']:visited { color:#3091d1; }

   li .checkbox {
       display: inline-block;
       width: 0.9em;
       height: 0.9em;
       border-radius: 3px;
       margin: 3px;
       top: 4px;
       position: relative;
   }
   li.on > .checkbox { background: var(--theme-green); box-shadow: 0 0 2px var(--theme-green); }
   li.trans > .checkbox { background: var(--theme-orange); box-shadow: 0 0 2px var(--theme-orange); }
   li.off > .checkbox { background: var(--theme-red); box-shadow: 0 0 2px var(--theme-red); }
   li.on > .checkbox::after {
     content: '';
     height: 0.45em;
     width: 0.225em;
     -webkit-transform-origin: left top;
     transform-origin: left top;
     transform: scaleX(-1) rotate(135deg);
     border-right: 2.8px solid#fff;
     border-top: 2.8px solid#fff;
     opacity: 0.9;
     left: 0.10em;
     top: 0.45em;
     position: absolute;
   }
   li.trans > .checkbox::after {
       content: '';
       font-weight: bold;
       font-size: 1.6em;
       position: absolute;
       top: 0.23em;
       left: 0.09em;
       width: 0.35em;
       height: 0.12em;
       background:#fff;
       opacity: 0.9;
       border-radius: 0.1em;
   }
   li.off > .checkbox::after {
    content: '✖';
    color:#fff;
    opacity: 0.9;
    position: relative;
    top: -0.40rem;
    left: 0.17em;
    font-size: 0.75em;
  }

   span.timestamp {
       color: #003280;
       background: #647CFF44;
       border-radius: 3px;
       line-height: 1.25;
   }

   #table-of-contents { overflow-y: auto; }
   blockquote p { margin: 8px 0px 16px 0px; }
   #postamble .date { color: var(--theme-green); }

   ::-webkit-scrollbar { width: 10px; height: 8px; }
   ::-webkit-scrollbar-track { background:#9992; }
   ::-webkit-scrollbar-thumb { background:#ccc; border-radius: 10px; }
   ::-webkit-scrollbar-thumb:hover { background:#888; }
</style>

<style type="text/css">
   :root {
      --theme-bg: #242730;
      --theme-bg-alt: #2a2e38;
      --theme-base0: #1c1f24;
      --theme-base1: #1c1f24;
      --theme-base2: #21272d;
      --theme-base3: #23272e;
      --theme-base4: #484854;
      --theme-base5: #62686E;
      --theme-base6: #757B80;
      --theme-base7: #9ca0a4;
      --theme-base8: #DFDFDF;
      --theme-fg: #bbc2cf;
      --theme-fg-alt: #5D656B;
      --theme-grey: #484854;
      --theme-red: #ff665c;
      --theme-orange: #e69055;
      --theme-green: #7bc275;
      --theme-teal: #4db5bd;
      --theme-yellow: #FCCE7B;
      --theme-blue: #51afef;
      --theme-dark-blue: #1f5582;
      --theme-magenta: #C57BDB;
      --theme-violet: #a991f1;
      --theme-cyan: #5cEfFF;
      --theme-dark-cyan: #6A8FBF;
   }
</style>
<link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css'/>
<link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css'/>

<script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js'></script>
<script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js'></script>

<style>
   pre.src {
     background-color: var(--theme-bg);
     color: var(--theme-fg);
     scrollbar-color:#bbb6#9992;
     scrollbar-width: thin;
     margin: 0;
     border: none;
   }
   div.org-src-container {
     border-radius: 12px;
     overflow: hidden;
     margin-bottom: 24px;
     margin-top: 1px;
     border: 1px solid#e1e4e5;
   }
   pre.src::before {
     background-color:#6666;
     top: 8px;
     border: none;
     border-radius: 5px;
     line-height: 1;
     border: 2px solid var(--theme-bg);
     opacity: 0;
     transition: opacity 200ms;
   }
   pre.src:hover::before { opacity: 1; }
   pre.src:active::before { opacity: 0; }

   pre.example {
     border-radius: 12px;
     background: var(--theme-bg-alt);
     color: var(--theme-fg);
   }

   code {
     border-radius: 5px;
     background:#e8e8e8;
     font-size: 80%;
   }

   kbd {
     display: inline-block;
     padding: 3px 5px;
     font: 80% SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;
     line-height: normal;
     line-height: 10px;
     color:#444d56;
     vertical-align: middle;
     background-color:#fafbfc;
     border: 1px solid#d1d5da;
     border-radius: 3px;
     box-shadow: inset 0 -1px 0#d1d5da;
   }

   table {
     max-width: 100%;
     overflow-x: auto;
     display: block;
     border-top: none;
   }

   a {
       text-decoration: none;
       background-image: linear-gradient(#d8dce9, #d8dce9);
       background-position: 0% 100%;
       background-repeat: no-repeat;
       background-size: 0% 2px;
       transition: background-size .3s;
   }
   #table-of-contents a {
       background-image: none;
   }
   a:hover, a:focus {
       background-size: 100% 2px;
   }
   a[href^='#'] { font-variant-numeric: oldstyle-nums; }
   a[href^='#']:visited { color:#3091d1; }

   li .checkbox {
       display: inline-block;
       width: 0.9em;
       height: 0.9em;
       border-radius: 3px;
       margin: 3px;
       top: 4px;
       position: relative;
   }
   li.on > .checkbox { background: var(--theme-green); box-shadow: 0 0 2px var(--theme-green); }
   li.trans > .checkbox { background: var(--theme-orange); box-shadow: 0 0 2px var(--theme-orange); }
   li.off > .checkbox { background: var(--theme-red); box-shadow: 0 0 2px var(--theme-red); }
   li.on > .checkbox::after {
     content: '';
     height: 0.45em;
     width: 0.225em;
     -webkit-transform-origin: left top;
     transform-origin: left top;
     transform: scaleX(-1) rotate(135deg);
     border-right: 2.8px solid#fff;
     border-top: 2.8px solid#fff;
     opacity: 0.9;
     left: 0.10em;
     top: 0.45em;
     position: absolute;
   }
   li.trans > .checkbox::after {
       content: '';
       font-weight: bold;
       font-size: 1.6em;
       position: absolute;
       top: 0.23em;
       left: 0.09em;
       width: 0.35em;
       height: 0.12em;
       background:#fff;
       opacity: 0.9;
       border-radius: 0.1em;
   }
   li.off > .checkbox::after {
    content: '✖';
    color:#fff;
    opacity: 0.9;
    position: relative;
    top: -0.40rem;
    left: 0.17em;
    font-size: 0.75em;
  }

   span.timestamp {
       color: #003280;
       background: #647CFF44;
       border-radius: 3px;
       line-height: 1.25;
   }

   #table-of-contents { overflow-y: auto; }
   blockquote p { margin: 8px 0px 16px 0px; }
   #postamble .date { color: var(--theme-green); }

   ::-webkit-scrollbar { width: 10px; height: 8px; }
   ::-webkit-scrollbar-track { background:#9992; }
   ::-webkit-scrollbar-thumb { background:#ccc; border-radius: 10px; }
   ::-webkit-scrollbar-thumb:hover { background:#888; }
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Doom Emacs Configuration</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org5d8b1bd">1. Intro</a></li>
<li><a href="#org5ab1c9b">2. Rudimentary configuration</a>
<ul>
<li><a href="#org1c80183">2.1. Personal Information</a></li>
<li><a href="#org8e66e25">2.2. Better defaults</a>
<ul>
<li><a href="#org09be2b8">2.2.1. Simple settings</a></li>
<li><a href="#orge05053e">2.2.2. Fullscreen</a></li>
<li><a href="#org1ff559f">2.2.3. Auto-customisations</a></li>
<li><a href="#org96a9ac9">2.2.4. Windows</a></li>
<li><a href="#orgb1289e7">2.2.5. Buffer defaults</a></li>
</ul>
</li>
<li><a href="#org1ca4560">2.3. Doom configuration</a>
<ul>
<li><a href="#org2c81794">2.3.1. Visual Settings</a>
<ul>
<li><a href="#orgaf79b7f">2.3.1.1. Font Face</a></li>
<li><a href="#orgfbbb5dc">2.3.1.2. Theme</a></li>
<li><a href="#org9624ebf">2.3.1.3. Miscellaneous</a></li>
</ul>
</li>
<li><a href="#orgd17139a">2.3.2. Some helper macros</a></li>
</ul>
</li>
<li><a href="#org391e675">2.4. Other things</a>
<ul>
<li><a href="#orgd369de9">2.4.1. Editor interaction</a>
<ul>
<li><a href="#org93eaae9">2.4.1.1. Mouse buttons</a></li>
</ul>
</li>
<li><a href="#org31d97f6">2.4.2. Window title</a></li>
<li><a href="#org2882aec">2.4.3. Splash screen</a></li>
<li><a href="#org573d5a7">2.4.4. Systemd daemon</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge475161">3. Package loading</a>
<ul>
<li><a href="#org4e146a9">3.1. Loading instructions</a>
<ul>
<li><a href="#orgc4fb16f">3.1.1. Packages in MELPA/ELPA/emacsmirror</a></li>
<li><a href="#orgadb1cc1">3.1.2. Packages from git repositories</a></li>
<li><a href="#orgd72a892">3.1.3. Disabling built-in packages</a></li>
<li><a href="#org60552cf">3.1.4. Updating all pins in file</a></li>
</ul>
</li>
<li><a href="#orga021ccc">3.2. General packages</a>
<ul>
<li><a href="#org76c093a">3.2.1. Auto-complete</a></li>
<li><a href="#org52b7d23">3.2.2. Prettification</a></li>
<li><a href="#org5d34768">3.2.3. Window management</a></li>
<li><a href="#orge5ec05a">3.2.4. Fun</a></li>
<li><a href="#org9428f5f">3.2.5. Other</a>
<ul>
<li><a href="#orgc7d437d">3.2.5.1. Flyspell-lazy</a></li>
<li><a href="#org710f8e4">3.2.5.2. CalcTeX</a></li>
<li><a href="#orge0bce94">3.2.5.3. ESS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0f568c0">3.3. Language packages</a>
<ul>
<li><a href="#orgcda341f">3.3.1. Systemd</a></li>
<li><a href="#org5d9e0a4">3.3.2. Org Mode</a>
<ul>
<li><a href="#org28a5a8f">3.3.2.1. Improve agenda/capture</a></li>
<li><a href="#org9137837">3.3.2.2. Visuals</a></li>
<li><a href="#org9f2d5d8">3.3.2.3. Extra functionality</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5d67e53">4. Package configuration</a>
<ul>
<li><a href="#orgfa72a8f">4.1. Abbrev mode</a></li>
<li><a href="#orge4fa8c9">4.2. Centaur Tabs</a></li>
<li><a href="#org8e2898d">4.3. Company</a>
<ul>
<li><a href="#org2b33551">4.3.1. Plain Text</a></li>
<li><a href="#org7fd54da">4.3.2. ESS</a></li>
</ul>
</li>
<li><a href="#org00d56cd">4.4. Emacs Anywhere configuration</a></li>
<li><a href="#org8ab5168">4.5. Flyspell</a></li>
<li><a href="#org6b636f0">4.6. Tramp</a>
<ul>
<li>
<ul>
<li><a href="#org92421a2">4.6.0.1. Troubleshooting</a>
<ul>
<li><a href="#orge2517c1">4.6.0.1.1. Zsh</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3e0b5e6">4.7. Treemacs</a></li>
<li><a href="#org10a4234">4.8. Miscellaneous</a>
<ul>
<li><a href="#orgb3c8243">4.8.1. calc</a></li>
<li><a href="#org6029ee6">4.8.2. electric pair mode</a></li>
<li><a href="#orgf934ead">4.8.3. ispell</a></li>
<li><a href="#org8a0467e">4.8.4. spray</a></li>
<li><a href="#org5a7262f">4.8.5. theme magic</a></li>
<li><a href="#org5bab949">4.8.6. wttrin</a></li>
<li><a href="#org3cda1ed">4.8.7. elcord</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org439378a">5. Language configuration</a>
<ul>
<li>
<ul>
<li><a href="#orga489f89">5.0.1. File Templates</a></li>
</ul>
</li>
<li><a href="#orgeec1b44">5.1. Org Mode</a>
<ul>
<li><a href="#orge36f700">5.1.1. System config</a></li>
<li><a href="#org05ff4fe">5.1.2. Behaviour</a>
<ul>
<li><a href="#orgf6f1f36">5.1.2.1. Tweaking defaults</a></li>
<li><a href="#org78e87df">5.1.2.2. Extra functionality</a></li>
<li><a href="#orge720fb0">5.1.2.3. Super agenda</a></li>
<li><a href="#orgbc508de">5.1.2.4. Capture</a></li>
<li><a href="#org520167e">5.1.2.5. Nicer headings</a></li>
<li><a href="#org5c7491a">5.1.2.6. Nicer <code>org-return</code></a></li>
</ul>
</li>
<li><a href="#org5ead467">5.1.3. Visuals</a>
<ul>
<li><a href="#org471beb1">5.1.3.1. In editor</a>
<ul>
<li><a href="#org1d04371">5.1.3.1.1. Font Display</a></li>
<li><a href="#org2c0aa0e">5.1.3.1.2. Symbols</a></li>
<li><a href="#orgb206e16">5.1.3.1.3. LaTeX Fragments</a></li>
<li><a href="#orgb45eb12">5.1.3.1.4. Stolen from scimax (semi-working right now)</a></li>
</ul>
</li>
<li><a href="#org78b3661">5.1.3.2. Exporting (general)</a></li>
<li><a href="#org956020f">5.1.3.3. Exporting to HTML</a>
<ul>
<li><a href="#org43a07b2">5.1.3.3.1. Custom CSS/JS</a></li>
<li><a href="#org1fa49b7">5.1.3.3.2. Make verbatim different to code</a></li>
<li><a href="#org7d01eb8">5.1.3.3.3. Change checkbox type</a></li>
<li><a href="#org1df6216">5.1.3.3.4. LaTeX Rendering</a></li>
</ul>
</li>
<li><a href="#orgfb8310c">5.1.3.4. Exporting to LaTeX</a></li>
<li><a href="#orgbf642a1">5.1.3.5. Exporting to Beamer</a></li>
<li><a href="#org62ac7a3">5.1.3.6. Exporting to GFM</a></li>
</ul>
</li>
<li><a href="#orgbcfdf00">5.1.4. Babel</a></li>
<li><a href="#orgf71b26a">5.1.5. ESS</a></li>
</ul>
</li>
<li><a href="#orge478182">5.2. LaTeX</a>
<ul>
<li><a href="#org9bf6abf">5.2.1. To-be-implemented ideas</a></li>
<li><a href="#org926a361">5.2.2. Compilation</a></li>
<li><a href="#orgc008dac">5.2.3. Snippet value</a></li>
<li><a href="#org46175a5">5.2.4. Editor visuals</a></li>
<li><a href="#org0d253ef">5.2.5. CDLaTeX</a></li>
<li><a href="#org8a25f33">5.2.6. SyncTeX</a></li>
</ul>
</li>
<li><a href="#org9013058">5.3. R</a>
<ul>
<li><a href="#org7511e8a">5.3.1. Editor Visuals</a></li>
</ul>
</li>
<li><a href="#org9d7b800">5.4. hledger</a></li>
<li><a href="#org7fad74f">5.5. Markdown</a></li>
<li><a href="#org2096635">5.6. Beancount</a></li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
Let us change our traditional attitude to the construction of programs:
Instead of imagining that our main task is to instruct a computer what to do,
let us concentrate rather on explaining to human beings what we want a
computer to do. &#x2014; Donald Knuth
</p>
</blockquote>

<div id="outline-container-org5d8b1bd" class="outline-2">
<h2 id="org5d8b1bd"><span class="section-number-2">1</span> Intro</h2>
<div class="outline-text-2" id="text-1">
<p>
Customising an editor can be very rewarding &#x2026; until you have to leave it.
For years I have been looking for ways to avoid this pain.
Then I discovered <a href="https://github.com/cknadler/vim-anywhere">vim-anywhere</a>, and found that it had an emacs companion,<a href="https://github.com/zachcurry/emacs-anywhere">
emacs-anywhere</a>. To me, this looked most attractive.
</p>

<p>
Separately, online I have seen the following statement enough times I think it&rsquo;s a catchphrase
</p>
<blockquote>
<p>
Redditor1: I just discovered this thing, isn&rsquo;t it cool.
Redditor2: Oh, there&rsquo;s an emacs mode for that.
</p>
</blockquote>

<p>
I tried out the <kbd>spacemacs</kbd> distribution a bit, but it wasn&rsquo;t quite to my liking.
Then I heard about <kbd>doom emacs</kbd> and thought I may as well give that a try.
TLDR; it&rsquo;s great.
</p>

<p>
Now I&rsquo;ve discovered the wonders of literate programming, and am becoming more
settled by the day. This is my config.
</p>
</div>
</div>
<div id="outline-container-org5ab1c9b" class="outline-2">
<h2 id="org5ab1c9b"><span class="section-number-2">2</span> Rudimentary configuration</h2>
<div class="outline-text-2" id="text-2">
<p>
Make this file run (slightly) faster with lexical binding (see <a href="https://nullprogram.com/blog/2016/12/22/">this blog post</a>
for more info).
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;;; </span><span style="color: #62686E;">config.el -*- lexical-binding: t; -*-</span>
</pre>
</div>
</div>
<div id="outline-container-org1c80183" class="outline-3">
<h3 id="org1c80183"><span class="section-number-3">2.1</span> Personal Information</h3>
<div class="outline-text-3" id="text-2-1">
<p>
It&rsquo;s useful to have some basic personal information
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">user-full-name</span> <span style="color: #7bc275;">"tecosaur"</span>
      <span style="color: #DFDFDF;">user-mail-address</span> <span style="color: #7bc275;">"tecosaur@gmail.com"</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Apparently this is used by <code>GPG</code>, and all sorts of other things.
</p>
</div>
</div>
<div id="outline-container-org8e66e25" class="outline-3">
<h3 id="org8e66e25"><span class="section-number-3">2.2</span> Better defaults</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org09be2b8" class="outline-4">
<h4 id="org09be2b8"><span class="section-number-4">2.2.1</span> Simple settings</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Browsing the web and seeing <a href="https://github.com/angrybacon/dotemacs/blob/master/dotemacs.org#use-better-defaults">angrybacon/dotemacs</a> and comparing with the values
shown by <kbd>SPC h v</kbd> and selecting what I thought looks good, I&rsquo;ve ended up adding the following:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq-default</span>
 <span style="color: #DFDFDF;">delete-by-moving-to-trash</span> t                      <span style="color: #62686E;">; </span><span style="color: #62686E;">Delete files to trash</span>
 <span style="color: #DFDFDF;">tab-width</span> <span style="color: #e69055; font-weight: bold;">4</span>                                      <span style="color: #62686E;">; </span><span style="color: #62686E;">Set width for tabs</span>
 <span style="color: #DFDFDF;">uniquify-buffer-name-style</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">forward</span>              <span style="color: #62686E;">; </span><span style="color: #62686E;">Uniquify buffer names</span>
 <span style="color: #DFDFDF;">window-combination-resize</span> t                      <span style="color: #62686E;">; </span><span style="color: #62686E;">take new window space from all other windows (not just current)</span>
 <span style="color: #DFDFDF;">x-stretch-cursor</span> t<span style="color: #51afef;">)</span>                              <span style="color: #62686E;">; </span><span style="color: #62686E;">Stretch cursor to the glyph width</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">undo-limit</span> <span style="color: #e69055; font-weight: bold;">80000000</span>                         <span style="color: #62686E;">; </span><span style="color: #62686E;">Raise undo-limit to 80Mb</span>
      <span style="color: #DFDFDF;">evil-want-fine-undo</span> t                       <span style="color: #62686E;">; </span><span style="color: #62686E;">By default while in insert all changes are one big blob. Be more granular</span>
      <span style="color: #DFDFDF;">auto-save-default</span> t                         <span style="color: #62686E;">; </span><span style="color: #62686E;">Nobody likes to loose work, I certainly don't</span>
      <span style="color: #DFDFDF;">inhibit-compacting-font-caches</span> t<span style="color: #51afef;">)</span>           <span style="color: #62686E;">; </span><span style="color: #62686E;">When there are lots of glyphs, keep them in memory</span>

<span style="color: #51afef;">(</span><span style="color: #DFDFDF;">delete-selection-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #51afef;">)</span>                         <span style="color: #62686E;">; </span><span style="color: #62686E;">Replace selection when inserting text</span>
<span style="color: #51afef;">(</span><span style="color: #DFDFDF;">display-time-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #51afef;">)</span>                             <span style="color: #62686E;">; </span><span style="color: #62686E;">Enable time in the mode-line</span>
<span style="color: #51afef;">(</span><span style="color: #DFDFDF;">display-battery-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #51afef;">)</span>                          <span style="color: #62686E;">; </span><span style="color: #62686E;">On laptops it's nice to know how much power you have</span>
<span style="color: #51afef;">(</span><span style="color: #DFDFDF;">global-subword-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #51afef;">)</span>                           <span style="color: #62686E;">; </span><span style="color: #62686E;">Iterate through CamelCase words</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge05053e" class="outline-4">
<h4 id="orge05053e"><span class="section-number-4">2.2.2</span> Fullscreen</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
I also like the idea of fullscreen-ing when opened by <code>emacs</code> or the <code>.desktop</code> file.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #DFDFDF;">initial-window-system</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">x</span><span style="color: #C57BDB;">)</span>                 <span style="color: #62686E;">; </span><span style="color: #62686E;">if started by emacs command or desktop file</span>
    <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">toggle-frame-maximized</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">toggle-frame-fullscreen</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1ff559f" class="outline-4">
<h4 id="org1ff559f"><span class="section-number-4">2.2.3</span> Auto-customisations</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
By default changes made via a customisation interface are added to <kbd>init.el</kbd>.
I prefer the idea of using a separate file for this. We just need to change a
setting, and load it if it exists.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq-default</span> <span style="color: #DFDFDF;">custom-file</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">".custom.el"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">when</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">file-exists-p</span> <span style="color: #DFDFDF;">custom-file</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">load</span> <span style="color: #DFDFDF;">custom-file</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org96a9ac9" class="outline-4">
<h4 id="org96a9ac9"><span class="section-number-4">2.2.4</span> Windows</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
I find it rather handy to be asked which buffer I want to see after splitting
the window. Let&rsquo;s make that happen.
First, we&rsquo;ll enter the new window
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">evil-vsplit-window-right</span> t
      <span style="color: #DFDFDF;">evil-split-window-below</span> t<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Then, we&rsquo;ll pull up <code>ivy</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defadvice!</span> prompt-for-buffer <span style="color: #C57BDB;">(</span><span style="color: #FCCE7B;">&amp;rest</span> _<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:after</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>evil-window-split evil-window-vsplit<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">+ivy/switch-buffer</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb1289e7" class="outline-4">
<h4 id="orgb1289e7"><span class="section-number-4">2.2.5</span> Buffer defaults</h4>
<div class="outline-text-4" id="text-2-2-5">
<p>
I&rsquo;d much rather have my new buffers in <code>org-mode</code> than <code>fundamental-mode</code>, hence
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #62686E;">(setq-default major-mode 'org-mode)</span>
</pre>
</div>
<p>
For some reason this + the mixed pitch hook causes issues with hydra and so I&rsquo;ll
just need to resort to <kbd>SPC b o</kbd> for now.
</p>
</div>
</div>
</div>
<div id="outline-container-org1ca4560" class="outline-3">
<h3 id="org1ca4560"><span class="section-number-3">2.3</span> Doom configuration</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org2c81794" class="outline-4">
<h4 id="org2c81794"><span class="section-number-4">2.3.1</span> Visual Settings</h4>
<div class="outline-text-4" id="text-2-3-1">
</div>
<div id="outline-container-orgaf79b7f" class="outline-5">
<h5 id="orgaf79b7f"><span class="section-number-5">2.3.1.1</span> Font Face</h5>
<div class="outline-text-5" id="text-2-3-1-1">
<p>
&rsquo;Fira Code&rsquo; is nice, and &rsquo;Overpass&rsquo; makes for a nice sans companion. We just need to
fiddle with the font sizes a tad so that they visually match.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">doom-font</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">font-spec</span> <span style="color: #C57BDB;">:family</span> <span style="color: #7bc275;">"Fira Code"</span> <span style="color: #C57BDB;">:size</span> <span style="color: #e69055; font-weight: bold;">22</span><span style="color: #C57BDB;">)</span>
      <span style="color: #DFDFDF;">doom-big-font</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">font-spec</span> <span style="color: #C57BDB;">:family</span> <span style="color: #7bc275;">"Fira Code"</span> <span style="color: #C57BDB;">:size</span> <span style="color: #e69055; font-weight: bold;">36</span><span style="color: #C57BDB;">)</span>
      <span style="color: #DFDFDF;">doom-variable-pitch-font</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">font-spec</span> <span style="color: #C57BDB;">:family</span> <span style="color: #7bc275;">"Overpass"</span> <span style="color: #C57BDB;">:size</span> <span style="color: #e69055; font-weight: bold;">24</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfbbb5dc" class="outline-5">
<h5 id="orgfbbb5dc"><span class="section-number-5">2.3.1.2</span> Theme</h5>
<div class="outline-text-5" id="text-2-3-1-2">
<p>
<code>doom-one</code> is nice and all, but I find the <code>vibrant</code> variant nicer.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">doom-theme</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">doom-vibrant</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
However, by default <code>red</code> text is used in the <code>modeline</code>, so let&rsquo;s make that orange
so I don&rsquo;t feel like something&rsquo;s gone <i>wrong</i> when editing files.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">custom-set-faces!</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>doom-modeline-buffer-modified <span style="color: #C57BDB;">:foreground</span> <span style="color: #7bc275;">"orange"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9624ebf" class="outline-5">
<h5 id="org9624ebf"><span class="section-number-5">2.3.1.3</span> Miscellaneous</h5>
<div class="outline-text-5" id="text-2-3-1-3">
<p>
Relative line numbers are fantastic for knowing how far away line numbers are,
then <kbd>ESC 12 &lt;UP&gt;</kbd> gets you exactly where you think.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">display-line-numbers-type</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">relative</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
I&rsquo;d like some slightly nicer default buffer names
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">doom-fallback-buffer-name</span> <span style="color: #7bc275;">"&#9658; Doom"</span>
      <span style="color: #DFDFDF;">+doom-dashboard-name</span> <span style="color: #7bc275;">"&#9658; Doom"</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
There&rsquo;s a bug with the modeline in insert mode for org documents (<a href="https://github.com/seagle0128/doom-modeline/issues/300">issue</a>), so
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">custom-set-faces!</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>doom-modeline-evil-insert-state <span style="color: #C57BDB;">:weight</span> bold <span style="color: #C57BDB;">:foreground</span> <span style="color: #7bc275;">"#339CDB"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd17139a" class="outline-4">
<h4 id="orgd17139a"><span class="section-number-4">2.3.2</span> Some helper macros</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
There are a few handy macros added by doom, namely
</p>
<ul class="org-ul">
<li><code>load!</code> for loading external <code>.el</code> files relative to this one</li>
<li><code>use-package</code> for configuring packages</li>
<li><code>add-load-path!</code> for adding directories to the <code>load-path</code> where <code>emacs</code> looks when
you load packages with <code>require</code> or <code>use-package</code></li>
<li><code>map</code> for binding new keys</li>
</ul>
<p>
To find more,
</p>
</div>
</div>
</div>
<div id="outline-container-org391e675" class="outline-3">
<h3 id="org391e675"><span class="section-number-3">2.4</span> Other things</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-orgd369de9" class="outline-4">
<h4 id="orgd369de9"><span class="section-number-4">2.4.1</span> Editor interaction</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<div id="outline-container-org93eaae9" class="outline-5">
<h5 id="org93eaae9"><span class="section-number-5">2.4.1.1</span> Mouse buttons</h5>
<div class="outline-text-5" id="text-2-4-1-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">map!</span> <span style="color: #C57BDB;">:n</span> <span style="color: #C57BDB;">[</span>mouse-8<span style="color: #C57BDB;">]</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">better-jumper-jump-backward</span>
      <span style="color: #C57BDB;">:n</span> <span style="color: #C57BDB;">[</span>mouse-9<span style="color: #C57BDB;">]</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">better-jumper-jump-forward</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org31d97f6" class="outline-4">
<h4 id="org31d97f6"><span class="section-number-4">2.4.2</span> Window title</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
I&rsquo;d like to have just the buffer name, then if applicable the project folder
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">frame-title-format</span>
    <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">""</span>
      <span style="color: #7bc275;">"%b"</span>
      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:eval</span>
       <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>project-name <span style="color: #51afef;">(</span><span style="color: #DFDFDF;">projectile-project-name</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">unless</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string=</span> <span style="color: #7bc275;">"-"</span> project-name<span style="color: #7bc275;">)</span>
           <span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">buffer-modified-p</span><span style="color: #C57BDB;">)</span>  <span style="color: #7bc275;">" &#9673; %s"</span> <span style="color: #7bc275;">" &#8198;&#9679;&#8198; %s"</span><span style="color: #51afef;">)</span> project-name<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2882aec" class="outline-4">
<h4 id="org2882aec"><span class="section-number-4">2.4.3</span> Splash screen</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
Emacs can render an image as the splash screen, and <a href="https://github.com/MarioRicalde">@MarioRicalde</a> came up with a
cracker! He&rsquo;s also provided me with a nice emacs-style <i>E</i>, which is good for
smaller windows. <b>@MarioRicalde</b> you have my sincere thanks, you&rsquo;re great!
<object type="image/svg+xml" data="misc/splash-images/blackhole-lines.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
By incrementally stripping away the outer layers of the logo one can obtain
quite a nice resizing effect.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">fancy-splash-image-template</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-template.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Default template svg used for the splash image, with substitutions from "</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">fancy-splash-image-nil</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/transparent-pixel.png"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"An image to use at minimum size, usually a transparent pixel"</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">fancy-splash-sizes</span>
  <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">500</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">50</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">0</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-0.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">440</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">42</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">4</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-0.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">400</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">38</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">4</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-1.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">350</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">36</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">3</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-2.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">300</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">34</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">3</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-3.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">250</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">32</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-4.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">200</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">30</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/blackhole-lines-5.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">100</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">24</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:template</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"misc/splash-images/emacs-e-template.svg"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">0</span>   <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">0</span>  <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">0</span> . <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:file</span> ,<span style="color: #DFDFDF;">fancy-splash-image-nil</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">fancy-splash-sizes</span>
  <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">500</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">50</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">0</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">440</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">42</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">4</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">330</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">35</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">3</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">200</span> <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">30</span> <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">1</span> . <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">0</span>   <span style="color: #C57BDB;">:min-height</span> <span style="color: #e69055; font-weight: bold;">0</span>  <span style="color: #C57BDB;">:padding</span> <span style="color: #51afef;">(</span><span style="color: #e69055; font-weight: bold;">0</span> . <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:file</span> ,<span style="color: #DFDFDF;">fancy-splash-image-nil</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"list of plists with the following properties</span>
<span style="color: #7e7e87;">  :height the height of the image</span>
<span style="color: #7e7e87;">  :min-height minimum `</span><span style="color: #a991f1;">frame-height</span><span style="color: #7e7e87;">' for image</span>
<span style="color: #7e7e87;">  :padding `</span><span style="color: #a991f1;">+doom-dashboard-banner-padding</span><span style="color: #7e7e87;">' to apply</span>
<span style="color: #7e7e87;">  :template non-default template file</span>
<span style="color: #7e7e87;">  :file file to use instead of template"</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">fancy-splash-template-colours</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"$colour1"</span> . keywords<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"$colour2"</span> . type<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"$colour3"</span> . base5<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"$colour4"</span> . base8<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"list of colour-replacement alists of the form (\"$placeholder\" . 'theme-colour) which applied the template"</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">unless</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">file-exists-p</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"theme-splashes"</span> <span style="color: #DFDFDF;">doom-cache-dir</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">make-directory</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"theme-splashes"</span> <span style="color: #DFDFDF;">doom-cache-dir</span><span style="color: #7bc275;">)</span> t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">fancy-splash-filename</span> <span style="color: #C57BDB;">(</span>theme-name height<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">file-name-as-directory</span> <span style="color: #7bc275;">"theme-splashes"</span><span style="color: #51afef;">)</span>
                            <span style="color: #51afef;">(</span><span style="color: #a991f1;">symbol-name</span> <span style="color: #DFDFDF;">doom-theme</span><span style="color: #51afef;">)</span>
                            <span style="color: #7bc275;">"-"</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">number-to-string</span> height<span style="color: #51afef;">)</span> <span style="color: #7bc275;">".svg"</span><span style="color: #7bc275;">)</span>
                    <span style="color: #DFDFDF;">doom-cache-dir</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">fancy-splash-clear-cache</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #7e7e87;">"Delete all cached fancy splash images"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">interactive</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">delete-directory</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"theme-splashes"</span> <span style="color: #DFDFDF;">doom-cache-dir</span><span style="color: #7bc275;">)</span> t<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"Cache cleared!"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">fancy-splash-generate-image</span> <span style="color: #C57BDB;">(</span>template height<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Read TEMPLATE and create an image if HEIGHT with colour substitutions as  ;described by `</span><span style="color: #a991f1;">fancy-splash-template-colours</span><span style="color: #7e7e87;">' for the current theme"</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">with-temp-buffer</span>
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">insert-file-contents</span> template<span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">re-search-forward</span> <span style="color: #7bc275;">"$height"</span> nil t<span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">replace-match</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">number-to-string</span> height<span style="color: #51afef;">)</span> nil nil<span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #51afef;">(</span>substitution <span style="color: #DFDFDF;">fancy-splash-template-colours</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">beginning-of-buffer</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">while</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">re-search-forward</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">car</span> substitution<span style="color: #7bc275;">)</span> nil t<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">replace-match</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">cdr</span> substitution<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> nil nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">write-region</span> nil nil
                    <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">fancy-splash-filename</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">symbol-name</span> <span style="color: #DFDFDF;">doom-theme</span><span style="color: #C57BDB;">)</span> height<span style="color: #51afef;">)</span> nil nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">fancy-splash-generate-images</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #7e7e87;">"Perform `</span><span style="color: #a991f1;">fancy-splash-generate-image</span><span style="color: #7e7e87;">' in bulk"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #7bc275;">(</span>size <span style="color: #DFDFDF;">fancy-splash-sizes</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">unless</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-get</span> size <span style="color: #C57BDB;">:file</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">fancy-splash-generate-image</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">or</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">plist-get</span> size <span style="color: #C57BDB;">:file</span><span style="color: #7bc275;">)</span>
                                       <span style="color: #7bc275;">(</span><span style="color: #a991f1;">plist-get</span> size <span style="color: #C57BDB;">:template</span><span style="color: #7bc275;">)</span>
                                       <span style="color: #DFDFDF;">fancy-splash-image-template</span><span style="color: #C57BDB;">)</span>
                                   <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-get</span> size <span style="color: #C57BDB;">:height</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">ensure-theme-splash-images-exist</span> <span style="color: #C57BDB;">(</span><span style="color: #FCCE7B;">&amp;optional</span> height<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">unless</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">file-exists-p</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">fancy-splash-filename</span>
                          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">symbol-name</span> <span style="color: #DFDFDF;">doom-theme</span><span style="color: #C57BDB;">)</span>
                          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">or</span> height
                              <span style="color: #7bc275;">(</span><span style="color: #a991f1;">plist-get</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> <span style="color: #DFDFDF;">fancy-splash-sizes</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:height</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">fancy-splash-generate-images</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">get-appropriate-splash</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>height <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">frame-height</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">cl-some</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>size<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">&gt;=</span> height <span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-get</span> size <span style="color: #C57BDB;">:min-height</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> size<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
             <span style="color: #DFDFDF;">fancy-splash-sizes</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> fancy-splash-last-size nil<span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> fancy-splash-last-theme nil<span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">set-appropriate-splash</span> <span style="color: #C57BDB;">(</span><span style="color: #FCCE7B;">&amp;optional</span> frame<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>appropriate-image <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">get-appropriate-splash</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">unless</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">equal</span> appropriate-image fancy-splash-last-size<span style="color: #C57BDB;">)</span>
                 <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">equal</span> <span style="color: #DFDFDF;">doom-theme</span> fancy-splash-last-theme<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">unless</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-get</span> appropriate-image <span style="color: #C57BDB;">:file</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">ensure-theme-splash-images-exist</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-get</span> appropriate-image <span style="color: #C57BDB;">:height</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">fancy-splash-image</span>
          <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-get</span> appropriate-image <span style="color: #C57BDB;">:file</span><span style="color: #C57BDB;">)</span>
              <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">fancy-splash-filename</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">symbol-name</span> <span style="color: #DFDFDF;">doom-theme</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">plist-get</span> appropriate-image <span style="color: #C57BDB;">:height</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">+doom-dashboard-banner-padding</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-get</span> appropriate-image <span style="color: #C57BDB;">:padding</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> fancy-splash-last-size appropriate-image<span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> fancy-splash-last-theme <span style="color: #DFDFDF;">doom-theme</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">+doom-dashboard-reload</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">window-size-change-functions</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">set-appropriate-splash</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">doom-load-theme-hook</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">set-appropriate-splash</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org573d5a7" class="outline-4">
<h4 id="org573d5a7"><span class="section-number-4">2.4.4</span> Systemd daemon</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
For running a systemd service for a emacs server I have the following
</p>
<div class="org-src-container">
<pre class="src src-systemd"><span style="color: #FCCE7B;">[Unit]</span>
<span style="color: #51afef;">Description</span>=Emacs server daemon
<span style="color: #51afef;">Documentation</span>=info:emacs man:emacs(<span style="color: #e69055; font-weight: bold;">1</span>) https://gnu.org/software/emacs/

<span style="color: #FCCE7B;">[Service]</span>
<span style="color: #51afef;">Type</span>=<span style="color: #C57BDB;">forking</span>
<span style="color: #51afef;">ExecStart</span>=/usr/bin/emacs --daemon
<span style="color: #51afef;">ExecStop</span>=/usr/bin/emacsclient --eval <span style="color: #7bc275;">"(progn (setq kill-emacs-hook nil) (kill emacs))"</span>
<span style="color: #51afef;">Environment</span>=SSH_AUTH_SOCK=<span style="color: #a991f1;">%t</span>/keyring/ssh
<span style="color: #51afef;">Restart</span>=<span style="color: #C57BDB;">on-failure</span>

<span style="color: #FCCE7B;">[Install]</span>
<span style="color: #51afef;">WantedBy</span>=default.target
</pre>
</div>
<p>
which is then enabled by
</p>
<div class="org-src-container">
<pre class="src src-sh">systemctl --user enable emacs.service
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orge475161" class="outline-2">
<h2 id="orge475161"><span class="section-number-2">3</span> Package loading</h2>
<div class="outline-text-2" id="text-3">
<p>
This file shouldn&rsquo;t be byte compiled.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #62686E;">-*- no-byte-compile: t; -*-</span>
</pre>
</div>
</div>
<div id="outline-container-org4e146a9" class="outline-3">
<h3 id="org4e146a9"><span class="section-number-3">3.1</span> Loading instructions</h3>
<div class="outline-text-3" id="text-3-1">
<p>
This is where you install packages, by declaring them with the <code>package!</code>
macro, then running <code>doom refresh</code> on the command line. You&rsquo;ll need to
restart Emacs for your changes to take effect! Or at least, run <kbd>M-x doom/reload</kbd>.
</p>

<p>
WARNING: Don&rsquo;t disable core packages listed in <code>~/.emacs.d/core/packages.el</code>.
Doom requires these, and disabling them may have terrible side effects.
</p>
</div>

<div id="outline-container-orgc4fb16f" class="outline-4">
<h4 id="orgc4fb16f"><span class="section-number-4">3.1.1</span> Packages in MELPA/ELPA/emacsmirror</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
To install <code>some-package</code> from MELPA, ELPA or emacsmirror:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> some-package<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgadb1cc1" class="outline-4">
<h4 id="orgadb1cc1"><span class="section-number-4">3.1.2</span> Packages from git repositories</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
To install a package directly from a particular repo, you&rsquo;ll need to specify
a <code>:recipe</code>. You&rsquo;ll find documentation on what <code>:recipe</code> accepts <a href="https://github.com/raxod502/straight.el#the-recipe-format">here</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> another-package
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"username/repo"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
If the package you are trying to install does not contain a <code>PACKAGENAME.el</code>
file, or is located in a subdirectory of the repo, you&rsquo;ll need to specify
<code>:files</code> in the <code>:recipe</code>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> this-package
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"username/repo"</span>
           <span style="color: #C57BDB;">:files</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"some-file.el"</span> <span style="color: #7bc275;">"src/lisp/*.el"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd72a892" class="outline-4">
<h4 id="orgd72a892"><span class="section-number-4">3.1.3</span> Disabling built-in packages</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
If you&rsquo;d like to disable a package included with Doom, for whatever reason,
you can do so here with the <code>:disable</code> property:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> builtin-package <span style="color: #C57BDB;">:disable</span> t<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
You can override the recipe of a built in package without having to specify
all the properties for <code>:recipe</code>. These will inherit the rest of its recipe
from Doom or MELPA/ELPA/Emacsmirror:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> builtin-package <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:nonrecursive</span> t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> builtin-package-2 <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"myfork/package"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Specify a <code>:branch</code> to install a package from a particular branch or tag.
This is required for some packages whose default branch isn&rsquo;t &rsquo;master&rsquo; (which
our package manager can&rsquo;t deal with; see <a href="https://github.com/raxod502/straight.el/issues/279">raxod502/straight.el#279</a>)
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> builtin-package <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:branch</span> <span style="color: #7bc275;">"develop"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org60552cf" class="outline-4">
<h4 id="org60552cf"><span class="section-number-4">3.1.4</span> Updating all pins in file</h4>
<div class="outline-text-4" id="text-3-1-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">+doom/update-all-pinned-package-form</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #7e7e87;">"Call `</span><span style="color: #a991f1;">doom/update-pinned-package-form</span><span style="color: #7e7e87;">' on every package! statement in the buffer"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">interactive</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">beginning-of-buffer</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>progress <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span>total <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">how-many</span> <span style="color: #7bc275;">"package!"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span>updated <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">while</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">search-forward</span> <span style="color: #7bc275;">"package!"</span> nil t<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> progress <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">1+</span> progress<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">forward-char</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">move cursor to package name "package! |name"</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">message</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"Re-pinning package: %s/%s (%s)"</span> progress total <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">current-word</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">backward-char</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">evil-scroll-line-to-center</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">line-number-at-pos</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">redisplay</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">s-contains-p</span> <span style="color: #7bc275;">"Updated"</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">condition-case</span> nil
                                      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">doom/update-pinned-package-form</span><span style="color: #51afef;">)</span>
                                    <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">user-error</span> <span style="color: #7bc275;">""</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> updated <span style="color: #7bc275;">(</span><span style="color: #a991f1;">1+</span> updated<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">search-forward</span> <span style="color: #7bc275;">"package!"</span> nil t<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">because of cursor-moving done</span>
    <span style="color: #7bc275;">(</span><span style="color: #a991f1;">message</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s packages updated"</span> updated<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga021ccc" class="outline-3">
<h3 id="orga021ccc"><span class="section-number-3">3.2</span> General packages</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org76c093a" class="outline-4">
<h4 id="org76c093a"><span class="section-number-4">3.2.1</span> Auto-complete</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> company-tabnine <span style="color: #62686E;">; </span><span style="color: #62686E;">tab9 autocomplete</span>
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"TommyX12/company-tabnine"</span>
           <span style="color: #C57BDB;">:files</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"company-tabnine.el"</span> <span style="color: #7bc275;">"fetch-binaries.sh"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"e986a4ad0d"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org52b7d23" class="outline-4">
<h4 id="org52b7d23"><span class="section-number-4">3.2.2</span> Prettification</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
<code>prettify-mode</code> is nice and all, but adding substitutions is a little verbose.
This helps with that.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> prettify-utils <span style="color: #62686E;">; </span><span style="color: #62686E;">simplify messing with prettify-mode</span>
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"Ilazki/prettify-utils.el"</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"8b783d316c"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5d34768" class="outline-4">
<h4 id="org5d34768"><span class="section-number-4">3.2.3</span> Window management</h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> rotate <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"091b5ac4fc"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge5ec05a" class="outline-4">
<h4 id="orge5ec05a"><span class="section-number-4">3.2.4</span> Fun</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
Sometimes one just wants a little fun.
XKCD comics are fun.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> xkcd <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"66e928706f"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Every so often, you want everyone else to <i>know</i> that you&rsquo;re typing, or just to
amuse oneself. Introducing: typewriter sounds!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> <span style="color: #DFDFDF;">selectric-mode</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"bb9e66678f"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Hey, let&rsquo;s get the weather in here while we&rsquo;re at it.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> wttrin <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"df5427ce2a"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Why not flash words on the screen. Why not &#x2014; hey, it could be fun.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> spray <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"00638bc916"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
With all our fancy emacs themes, my terminal is missing out!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> theme-magic <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"844c4311bd"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
What&rsquo;s even the point of using Emacs unless you&rsquo;re constantly telling everyone
about it?
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> elcord <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"94b0afb9ba"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9428f5f" class="outline-4">
<h4 id="org9428f5f"><span class="section-number-4">3.2.5</span> Other</h4>
<div class="outline-text-4" id="text-3-2-5">
</div>
<div id="outline-container-orgc7d437d" class="outline-5">
<h5 id="orgc7d437d"><span class="section-number-5">3.2.5.1</span> Flyspell-lazy</h5>
<div class="outline-text-5" id="text-3-2-5-1">
<p>
To alleviate some <a href="#org8ab5168">issues with flyspell</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> flyspell-lazy<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org710f8e4" class="outline-5">
<h5 id="org710f8e4"><span class="section-number-5">3.2.5.2</span> CalcTeX</h5>
<div class="outline-text-5" id="text-3-2-5-2">
<p>
This is a nice extension to <code>calc</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> calctex <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"johnbcoughlin/calctex"</span>
                                 <span style="color: #C57BDB;">:files</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"*.el"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"542b628eb4"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge0bce94" class="outline-5">
<h5 id="orge0bce94"><span class="section-number-5">3.2.5.3</span> ESS</h5>
<div class="outline-text-5" id="text-3-2-5-3">
<p>
View dataframes better with
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> ess-view <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"d4e5a340b7"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org0f568c0" class="outline-3">
<h3 id="org0f568c0"><span class="section-number-3">3.3</span> Language packages</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-orgcda341f" class="outline-4">
<h4 id="orgcda341f"><span class="section-number-4">3.3.1</span> Systemd</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
For editing systemd unit files
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> systemd <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"51c148e09a"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5d9e0a4" class="outline-4">
<h4 id="org5d9e0a4"><span class="section-number-4">3.3.2</span> Org Mode</h4>
<div class="outline-text-4" id="text-3-3-2">
</div>
<div id="outline-container-org28a5a8f" class="outline-5">
<h5 id="org28a5a8f"><span class="section-number-5">3.3.2.1</span> Improve agenda/capture</h5>
<div class="outline-text-5" id="text-3-3-2-1">
<p>
The agenda is nice, but a souped up version is nicer.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-super-agenda <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"dd0d104c26"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Similarly <code>doct</code> (Declarative Org Capture Templates) seems to be a nicer way to
set up org-capture.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> doct
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"progfolio/doct"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"6cf1943ad7"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9137837" class="outline-5">
<h5 id="org9137837"><span class="section-number-5">3.3.2.2</span> Visuals</h5>
<div class="outline-text-5" id="text-3-3-2-2">
<p>
Org tables aren&rsquo;t the prettiest thing to look at. This package is supposed to
redraw them in the buffer with box-drawing characters. Sounds like an
improvement to me! Just need to get it working&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-pretty-table-mode
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"Fuco1/org-pretty-table"</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"88380f865a"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
For automatically toggling LaTeX fragment previews there&rsquo;s this nice package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-fragtog <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"8eca8084cc"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
<code>org-superstar-mode</code> seems better than <code>org-bullets</code>, so let&rsquo;s switch to that
instead. Since we&rsquo;re making stuff look nicer we may as well make priorities and
tags prettier as well :)
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-bullets <span style="color: #C57BDB;">:disable</span> t <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"767f55feb5"</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-superstar
  <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"integral-dw/org-superstar-mode"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"4659cfc120"</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-fancy-priorities <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"819bb993b7"</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-pretty-tags <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"40fd72f3e7"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9f2d5d8" class="outline-5">
<h5 id="org9f2d5d8"><span class="section-number-5">3.3.2.3</span> Extra functionality</h5>
<div class="outline-text-5" id="text-3-3-2-3">
<p>
Because of the <i><a href="https://github.com/commonmark/commonmark-spec/wiki/markdown-flavors">lovely variety in markdown implementations</a></i> there isn&rsquo;t actually
such a thing a standard table spec &#x2026; or standard anything really. Because
<code>org-md</code> is a goody-two-shoes, it just uses HTML for all these non-standardised
elements (a lot of them). So <code>ox-gfm</code> is handy for exporting markdown with all the
features that GitHub has. Initialised in <a href="#org62ac7a3">5.1.3.6</a>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> ox-gfm <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"99f93011b0"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Now and then citations need to happen
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-ref <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"5bb9be2232"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Came across this and &#x2026; it&rsquo;s cool
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-graph-view <span style="color: #C57BDB;">:recipe</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:host</span> github <span style="color: #C57BDB;">:repo</span> <span style="color: #7bc275;">"alphapapa/org-graph-view"</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"13314338d7"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
I <b>need</b> this in my life. It take a URL to a recipe from a common site, and
inserts an org-ified version at point. Isn&rsquo;t that just great.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">package!</span> org-chef <span style="color: #C57BDB;">:pin</span> <span style="color: #7bc275;">"67f50aa2a2"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org5d67e53" class="outline-2">
<h2 id="org5d67e53"><span class="section-number-2">4</span> Package configuration</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgfa72a8f" class="outline-3">
<h3 id="orgfa72a8f"><span class="section-number-3">4.1</span> Abbrev mode</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Thanks to <a href="https://emacs.stackexchange.com/questions/45462/use-a-single-abbrev-table-for-multiple-modes/45476#45476">use a single abbrev-table for multiple modes? - Emacs Stack Exchange</a> I
have the following.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package</span> abbrev
  <span style="color: #C57BDB;">:init</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq-default</span> <span style="color: #DFDFDF;">abbrev-mode</span> t<span style="color: #C57BDB;">)</span>
  <span style="color: #62686E;">;; </span><span style="color: #62686E;">a hook funtion that sets the abbrev-table to org-mode-abbrev-table</span>
  <span style="color: #62686E;">;; </span><span style="color: #62686E;">whenever the major mode is a text mode</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">tec/set-text-mode-abbrev-table</span> <span style="color: #7bc275;">()</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">derived-mode-p</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">text-mode</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">local-abbrev-table</span> <span style="color: #DFDFDF;">org-mode-abbrev-table</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:commands</span> <span style="color: #DFDFDF;">abbrev-mode</span>
  <span style="color: #C57BDB;">:hook</span>
  <span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">abbrev-mode</span> . tec/set-text-mode-abbrev-table<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:config</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">abbrev-file-name</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">"abbrev.el"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">save-abbrevs</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">silently</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge4fa8c9" class="outline-3">
<h3 id="orge4fa8c9"><span class="section-number-3">4.2</span> Centaur Tabs</h3>
<div class="outline-text-3" id="text-4-2">
<p>
We want to make the tabs a nice, comfy size (<code>36</code>), with icons. The modifier
marker is nice, but the particular default Unicode one causes a lag spike, so
let&rsquo;s just switch to an <code>o</code>, which still looks decent but doesn&rsquo;t cause any
issues.
A &rsquo;active-bar&rsquo; is nice, so let&rsquo;s have one of those. If we have it <code>under</code> needs us to
turn on <code>x-underline-at-decent</code> though. For some reason this didn&rsquo;t seem to work
inside the <code>(after! ... )</code> block ¯\<sub>(ツ)</sub>_/¯.
Then let&rsquo;s change the font to a sans serif, but the default one doesn&rsquo;t fit too
well somehow, so let&rsquo;s switch to &rsquo;P22 Underground Book&rsquo;; it looks much nicer.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> centaur-tabs
  <span style="color: #C57BDB;">(</span>centaur-tabs-mode <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> centaur-tabs-height <span style="color: #e69055; font-weight: bold;">36</span>
        centaur-tabs-set-icons t
        centaur-tabs-modified-marker <span style="color: #7bc275;">"o"</span>
        centaur-tabs-close-button <span style="color: #7bc275;">"&#215;"</span>
        centaur-tabs-set-bar <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">above</span><span style="color: #C57BDB;">)</span>
        centaur-tabs-gray-out-icons <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">buffer</span>
  <span style="color: #C57BDB;">(</span>centaur-tabs-change-fonts <span style="color: #7bc275;">"P22 Underground Book"</span> <span style="color: #e69055; font-weight: bold;">160</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #62686E;">;; </span><span style="color: #62686E;">(setq x-underline-at-descent-line t)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8e2898d" class="outline-3">
<h3 id="org8e2898d"><span class="section-number-3">4.3</span> Company</h3>
<div class="outline-text-3" id="text-4-3">
<p>
It&rsquo;s nice to have completions almost all the time, in my opinion. Key strokes
are just waiting to be saved!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> company
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">company-idle-delay</span> <span style="color: #e69055; font-weight: bold;">0.5</span>
        <span style="color: #DFDFDF;">company-minimum-prefix-length</span> <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">company-show-numbers</span> t<span style="color: #C57BDB;">)</span>
<span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">evil-normal-state-entry-hook</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">company-abort</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">make aborting less annoying.</span>
</pre>
</div>
<p>
Now, the improvements from <code>precident</code> are mostly from remembering history, so
let&rsquo;s improve that memory.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq-default</span> <span style="color: #DFDFDF;">history-length</span> <span style="color: #e69055; font-weight: bold;">1000</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">setq-default</span> <span style="color: #DFDFDF;">prescient-history-length</span> <span style="color: #e69055; font-weight: bold;">1000</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org2b33551" class="outline-4">
<h4 id="org2b33551"><span class="section-number-4">4.3.1</span> Plain Text</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
<code>ispell</code> is nice, let&rsquo;s have it in <code>text</code>, <code>markdown</code>, and <code>GFM</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">set-company-backend!</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>text-mode
                        markdown-mode
                        gfm-mode<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:seperate</span> company-ispell
              company-files
              company-yasnippet<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
We then configure the dictionary we&rsquo;re using in <a href="#orgf934ead">ispell</a>.
</p>
</div>
</div>
<div id="outline-container-org7fd54da" class="outline-4">
<h4 id="org7fd54da"><span class="section-number-4">4.3.2</span> ESS</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
<code>company-dabbrev-code</code> is nice. Let&rsquo;s have it.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">set-company-backend!</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">ess-r-mode</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>company-R-args company-R-objects company-dabbrev-code <span style="color: #C57BDB;">:separate</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org00d56cd" class="outline-3">
<h3 id="org00d56cd"><span class="section-number-3">4.4</span> <a href="https://github.com/zachcurry/emacs-anywhere">Emacs Anywhere</a> configuration</h3>
<div class="outline-text-3" id="text-4-4">
<p>
It&rsquo;s nice to recognise GitHub (so we can use <code>GFM</code>), and other apps which we know
take markdown
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">markdown-window-p</span> <span style="color: #C57BDB;">(</span>window-title<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Judges from WINDOW-TITLE whether the current window likes markdown"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-match-p</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">rx</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #7bc275;">"Stack Exchange"</span> <span style="color: #7bc275;">"Stack Overflow"</span>
                          <span style="color: #7bc275;">"Pull Request"</span> <span style="color: #7bc275;">"Issue"</span> <span style="color: #7bc275;">"Discord"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  window-title<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
When the window opens, we generally want text so let&rsquo;s use a nice sans serif font,
a position the window below and to the left. Oh, and don&rsquo;t forget about checking
for <code>GFM</code>, otherwise let&rsquo;s just use <code>markdown</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">define-minor-mode</span> <span style="color: #DFDFDF;">emacs-anywhere-mode</span>
  <span style="color: #7e7e87;">"To tweak the current buffer for some emacs-anywhere considerations"</span>
  <span style="color: #C57BDB;">:init-value</span> nil
  <span style="color: #C57BDB;">:keymap</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">list</span>
           <span style="color: #62686E;">;; </span><span style="color: #62686E;">Finish edit, but be smart in org mode</span>
           <span style="color: #7bc275;">(</span><span style="color: #a991f1;">cons</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">kbd</span> <span style="color: #7bc275;">"C-c C-c"</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">lambda!</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">and</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #DFDFDF;">major-mode</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-mode</span><span style="color: #51afef;">)</span>
                                                   <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-in-src-block-p</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                                              <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-ctrl-c-ctrl-c</span><span style="color: #7bc275;">)</span>
                                            <span style="color: #7bc275;">(</span><span style="color: #a991f1;">delete-frame</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
           <span style="color: #62686E;">;; </span><span style="color: #62686E;">Abort edit. emacs-anywhere saves the current edit for next time.</span>
           <span style="color: #7bc275;">(</span><span style="color: #a991f1;">cons</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">kbd</span> <span style="color: #7bc275;">"C-c C-k"</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">lambda!</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> ea-on nil<span style="color: #C57BDB;">)</span>
                                          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">delete-frame</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #DFDFDF;">emacs-anywhere-mode</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">line breaking</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">turn-off-auto-fill</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #DFDFDF;">visual-line-mode</span> t<span style="color: #7bc275;">)</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">DEL/C-SPC to clear (first keystroke only)</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">set-transient-map</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>keymap <span style="color: #51afef;">(</span><span style="color: #a991f1;">make-sparse-keymap</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                         <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">define-key</span> keymap <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">kbd</span> <span style="color: #7bc275;">"DEL"</span><span style="color: #7bc275;">)</span>   <span style="color: #7bc275;">(</span><span style="color: #51afef;">lambda!</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">delete-region</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-max</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                         <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">define-key</span> keymap <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">kbd</span> <span style="color: #7bc275;">"C-SPC"</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">lambda!</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">delete-region</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-max</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                         keymap<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">disable tabs</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">bound-and-true-p</span> centaur-tabs-mode<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span>centaur-tabs-local-mode t<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">ea-popup-handler</span> <span style="color: #C57BDB;">(</span>app-name window-title x y w h<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">interactive</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">set-frame-size</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">selected-frame</span><span style="color: #7bc275;">)</span> <span style="color: #e69055; font-weight: bold;">80</span> <span style="color: #e69055; font-weight: bold;">12</span><span style="color: #C57BDB;">)</span>
  <span style="color: #62686E;">;; </span><span style="color: #62686E;">position the frame near the mouse</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let*</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>mousepos <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">split-string</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">shell-command-to-string</span> <span style="color: #7bc275;">"xdotool getmouselocation | sed -E \"s/ screen:0 window:[</span><span style="color: #C57BDB; font-weight: bold;">^</span><span style="color: #7bc275;"> ]*|x:|y://g\""</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
         <span style="color: #51afef;">(</span>mouse-x <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">-</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-to-number</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">nth</span> <span style="color: #e69055; font-weight: bold;">0</span> mousepos<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> <span style="color: #e69055; font-weight: bold;">100</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
         <span style="color: #51afef;">(</span>mouse-y <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">-</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-to-number</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">nth</span> <span style="color: #e69055; font-weight: bold;">1</span> mousepos<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> <span style="color: #e69055; font-weight: bold;">50</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #a991f1;">set-frame-position</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">selected-frame</span><span style="color: #51afef;">)</span> mouse-x mouse-y<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">set-frame-name</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">"Quick Edit &#8759; "</span> ea-app-name <span style="color: #7bc275;">" &#8212; "</span>
                          <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">truncate-string-to-width</span>
                           <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-trim</span>
                            <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">string-trim-right</span> window-title
                                               <span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"-[A-Za-z0-9 ]*%s"</span> ea-app-name<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                            <span style="color: #7bc275;">"[\s-]+"</span> <span style="color: #7bc275;">"[\s-]+"</span><span style="color: #C57BDB;">)</span>
                           <span style="color: #e69055; font-weight: bold;">45</span> nil nil <span style="color: #7bc275;">"&#8230;"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"window-title: %s"</span> window-title<span style="color: #C57BDB;">)</span>

  <span style="color: #62686E;">;; </span><span style="color: #62686E;">set major mode</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">cond</span>
   <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">markdown-window-p</span> window-title<span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">gfm-mode</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
   <span style="color: #7bc275;">(</span>t <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-mode</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> <span style="color: #62686E;">; </span><span style="color: #62686E;">default major mode</span>
   <span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">gui-get-selection</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">PRIMARY</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">gui-get-selection</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">PRIMARY</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">evil-insert-state</span><span style="color: #C57BDB;">)</span> <span style="color: #62686E;">; </span><span style="color: #62686E;">start in insert</span>
  <span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">emacs-anywhere-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">ea-popup-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">ea-popup-handler</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8ab5168" class="outline-3">
<h3 id="org8ab5168"><span class="section-number-3">4.5</span> Flyspell</h3>
<div class="outline-text-3" id="text-4-5">
<p>
At one point, typing became noticably laggy, Profiling revealed
<code>flyspell-post-command-hook</code> was responsible for 47% of CPU cycles by itself!
So I&rsquo;m going to make use of <code>flyspell-lazy</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> flyspell <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">require</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">flyspell-lazy</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">flyspell-lazy-mode</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6b636f0" class="outline-3">
<h3 id="org6b636f0"><span class="section-number-3">4.6</span> Tramp</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Let&rsquo;s try to make tramp handle prompts better
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> tramp
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">setenv</span> <span style="color: #7bc275;">"SHELL"</span> <span style="color: #7bc275;">"/bin/bash"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">tramp-shell-prompt-pattern</span> <span style="color: #7bc275;">"</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(?:</span><span style="color: #7bc275;">^</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">|</span><span style="color: #7bc275;"></span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">)</span><span style="color: #7bc275;">[</span><span style="color: #C57BDB; font-weight: bold;">^</span><span style="color: #7bc275;">]#$%&gt;\n]*#?[]#$%&gt;&#57520;] *</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(</span><span style="color: #7bc275;">&#27;\\[[0-9;]*[a-zA-Z] *</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">)</span><span style="color: #7bc275;">*"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">defult + &#57520;</span>
</pre>
</div>
</div>
<div id="outline-container-org92421a2" class="outline-5">
<h5 id="org92421a2"><span class="section-number-5">4.6.0.1</span> Troubleshooting</h5>
<div class="outline-text-5" id="text-4-6-0-1">
<p>
In case the remote shell is misbehaving, here are some things to try
</p>
</div>
<div id="outline-container-orge2517c1" class="outline-6">
<h6 id="orge2517c1"><span class="section-number-6">4.6.0.1.1</span> Zsh</h6>
<div class="outline-text-6" id="text-4-6-0-1-1">
<p>
There are some escape code you don&rsquo;t want, let&rsquo;s make it behave more considerately.
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #51afef;">if</span> <span style="color: #51afef;">[</span><span style="color: #C57BDB;">[</span> <span style="color: #7bc275;">"</span><span style="color: #a991f1;">$</span><span style="color: #DFDFDF;">TERM</span><span style="color: #7bc275;">"</span> == <span style="color: #7bc275;">"dumb"</span> <span style="color: #C57BDB;">]</span><span style="color: #51afef;">]</span>; <span style="color: #51afef;">then</span>
        <span style="color: #C57BDB;">unset</span> zle_bracketed_paste
        <span style="color: #C57BDB;">unset</span> zle
        <span style="color: #DFDFDF;">PS1</span>=<span style="color: #7bc275;">'$ '</span>
        <span style="color: #51afef;">return</span>
<span style="color: #51afef;">fi</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org3e0b5e6" class="outline-3">
<h3 id="org3e0b5e6"><span class="section-number-3">4.7</span> Treemacs</h3>
<div class="outline-text-3" id="text-4-7">
<p>
Quite often there are superfluous files I&rsquo;m not that interested in. There&rsquo;s no
good reason for them to take up space. Let&rsquo;s add a mechanism to ignore them.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> treemacs
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">treemacs-file-ignore-extensions</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"File extension which `</span><span style="color: #a991f1;">treemacs-ignore-filter</span><span style="color: #7e7e87;">' will ensure are ignored"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">treemacs-file-ignore-globs</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"Globs which will are transformed to `</span><span style="color: #a991f1;">treemacs-file-ignore-regexps</span><span style="color: #7e7e87;">' which `</span><span style="color: #a991f1;">treemacs-ignore-filter</span><span style="color: #7e7e87;">' will ensure are ignored"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defvar</span> <span style="color: #DFDFDF;">treemacs-file-ignore-regexps</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"RegExps to be tested to ignore files, generated from `</span><span style="color: #a991f1;">treeemacs-file-ignore-globs</span><span style="color: #7e7e87;">'"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">treemacs-file-ignore-generate-regexps</span> <span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"Generate `</span><span style="color: #a991f1;">treemacs-file-ignore-regexps</span><span style="color: #7e7e87;">' from `</span><span style="color: #a991f1;">treemacs-file-ignore-globs</span><span style="color: #7e7e87;">'"</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> treemacs-file-ignore-regexps <span style="color: #51afef;">(</span><span style="color: #a991f1;">mapcar</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">dired-glob-regexp</span> treemacs-file-ignore-globs<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">equal</span> treemacs-file-ignore-globs <span style="color: #C57BDB;">'</span><span style="color: #51afef;">()</span><span style="color: #7bc275;">)</span> nil <span style="color: #7bc275;">(</span>treemacs-file-ignore-generate-regexps<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">treemacs-ignore-filter</span> <span style="color: #7bc275;">(</span>file full-path<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"Ignore files specified by `</span><span style="color: #a991f1;">treemacs-file-ignore-extensions</span><span style="color: #7e7e87;">', and `</span><span style="color: #a991f1;">treemacs-file-ignore-regexps</span><span style="color: #7e7e87;">'"</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">member</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">file-name-extension</span> file<span style="color: #C57BDB;">)</span> treemacs-file-ignore-extensions<span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>ignore-file nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #7bc275;">(</span>regexp treemacs-file-ignore-regexps ignore-file<span style="color: #7bc275;">)</span>
            <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> ignore-file <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> ignore-file <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">string-match-p</span> regexp full-path<span style="color: #7bc275;">)</span> t nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">treemacs-ignored-file-predicates</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">treemacs-ignore-filter</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Now, we just identify the files in question.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> treemacs-file-ignore-extensions <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #62686E;">;; </span><span style="color: #62686E;">LaTeX</span>
                                        <span style="color: #7bc275;">"aux"</span>
                                        <span style="color: #7bc275;">"ptc"</span>
                                        <span style="color: #7bc275;">"fdb_latexmk"</span>
                                        <span style="color: #7bc275;">"fls"</span>
                                        <span style="color: #7bc275;">"synctex.gz"</span>
                                        <span style="color: #7bc275;">"toc"</span>
                                        <span style="color: #62686E;">;; </span><span style="color: #62686E;">LaTeX - glossary</span>
                                        <span style="color: #7bc275;">"glg"</span>
                                        <span style="color: #7bc275;">"glo"</span>
                                        <span style="color: #7bc275;">"gls"</span>
                                        <span style="color: #7bc275;">"glsdefs"</span>
                                        <span style="color: #7bc275;">"ist"</span>
                                        <span style="color: #7bc275;">"acn"</span>
                                        <span style="color: #7bc275;">"acr"</span>
                                        <span style="color: #7bc275;">"alg"</span>
                                        <span style="color: #62686E;">;; </span><span style="color: #62686E;">LaTeX - pgfplots</span>
                                        <span style="color: #7bc275;">"mw"</span>
                                        <span style="color: #62686E;">;; </span><span style="color: #62686E;">LaTeX - pdfx</span>
                                        <span style="color: #7bc275;">"pdfa.xmpi"</span>
                                        <span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> treemacs-file-ignore-globs <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #62686E;">;; </span><span style="color: #62686E;">LaTeX</span>
                                   <span style="color: #7bc275;">"*/_minted-*"</span>
                                   <span style="color: #62686E;">;; </span><span style="color: #62686E;">AucTeX</span>
                                   <span style="color: #7bc275;">"*/.auctex-auto"</span>
                                   <span style="color: #7bc275;">"*/_region_.log"</span>
                                   <span style="color: #7bc275;">"*/_region_.tex"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org10a4234" class="outline-3">
<h3 id="org10a4234"><span class="section-number-3">4.8</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-4-8">
</div>
<div id="outline-container-orgb3c8243" class="outline-4">
<h4 id="orgb3c8243"><span class="section-number-4">4.8.1</span> calc</h4>
<div class="outline-text-4" id="text-4-8-1">
<p>
Radians are just better
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> calc-angle-mode <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">rad</span>  <span style="color: #62686E;">;; </span><span style="color: #62686E;">radians are rad</span>
      calc-algebraic-mode t <span style="color: #62686E;">;; </span><span style="color: #62686E;">allows '2*x instead of 'x&lt;RET&gt;2*</span>
      calc-symbolic-mode t<span style="color: #51afef;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">keeps stuff like &#8730;2 irrational for as long as possible</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> calctex
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> calctex-format-latex-header <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> calctex-format-latex-header
                                            <span style="color: #7bc275;">"\n\\usepackage{arevmath}"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">calc-mode-hook</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">calctex-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6029ee6" class="outline-4">
<h4 id="org6029ee6"><span class="section-number-4">4.8.2</span> electric pair mode</h4>
<div class="outline-text-4" id="text-4-8-2">
<p>
We want this everywhere
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #DFDFDF;">electric-pair-mode</span> t<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf934ead" class="outline-4">
<h4 id="orgf934ead"><span class="section-number-4">4.8.3</span> ispell</h4>
<div class="outline-text-4" id="text-4-8-3">
<p>
Let&rsquo;s get a nice big dictionary from <a href="http://app.aspell.net/create">SCOWL Custom List/Dictionary Creator</a> with
the following configuration
</p>
<dl class="org-dl">
<dt>size</dt><dd>80 (huge)</dd>
<dt>spellings</dt><dd>British(-ise) and Australian</dd>
<dt>spellling variants level</dt><dd>0</dd>
<dt>diacritics</dt><dd>keep</dd>
<dt>extra lists</dt><dd>hacker, roman numerals</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">ispell-dictionary</span> <span style="color: #7bc275;">"en_GBs_au_SCOWL_80_0_k_hr"</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Oh, and by the way, if <code>company-ispell-dictionary</code> is <code>nil</code>, then
<code>ispell-complete-word-dict</code> is used instead, which once again when <code>nil</code> is
<code>ispell-alternate-dictionary</code>, which at the moment maps to a plaintext version of
the above.
</p>

<p>
It seems reasonable to want to keep an eye on my personal dict, let&rsquo;s have it
nearby (also means that if I change the &rsquo;main&rsquo; dictionary I keep my addition).
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">ispell-personal-dictionary</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">expand-file-name</span> <span style="color: #7bc275;">".hunspell_personal"</span> <span style="color: #DFDFDF;">doom-private-dir</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8a0467e" class="outline-4">
<h4 id="org8a0467e"><span class="section-number-4">4.8.4</span> spray</h4>
<div class="outline-text-4" id="text-4-8-4">
<p>
Let&rsquo;s make this suit me slightly better.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> spray-wpm <span style="color: #e69055; font-weight: bold;">500</span>
      spray-height <span style="color: #e69055; font-weight: bold;">700</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5a7262f" class="outline-4">
<h4 id="org5a7262f"><span class="section-number-4">4.8.5</span> theme magic</h4>
<div class="outline-text-4" id="text-4-8-5">
<p>
Let&rsquo;s automatically update terminals on theme change
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">doom-load-theme-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">theme-magic-from-emacs</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5bab949" class="outline-4">
<h4 id="org5bab949"><span class="section-number-4">4.8.6</span> wttrin</h4>
<div class="outline-text-4" id="text-4-8-6">
<p>
Set the default city. It&rsquo;s initially <code>Taipei</code> but I find the IP-locating that&rsquo;s
done perfectly acceptable, so let&rsquo;s make that happen.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> wttrin-default-cities <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">""</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3cda1ed" class="outline-4">
<h4 id="org3cda1ed"><span class="section-number-4">4.8.7</span> elcord</h4>
<div class="outline-text-4" id="text-4-8-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> elcord-use-major-mode-as-main-icon t<span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org439378a" class="outline-2">
<h2 id="org439378a"><span class="section-number-2">5</span> Language configuration</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orga489f89" class="outline-4">
<h4 id="orga489f89"><span class="section-number-4">5.0.1</span> File Templates</h4>
<div class="outline-text-4" id="text-5-0-1">
<p>
For some file types, we overwrite defaults in the <a href="./snippets">snippets</a> directory, others
need to have a template assigned.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">set-file-template!</span> <span style="color: #7bc275;">"\\.tex$"</span> <span style="color: #C57BDB;">:trigger</span> <span style="color: #7bc275;">"__"</span> <span style="color: #C57BDB;">:mode</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeec1b44" class="outline-3">
<h3 id="orgeec1b44"><span class="section-number-3">5.1</span> Org Mode</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-orge36f700" class="outline-4">
<h4 id="orge36f700"><span class="section-number-4">5.1.1</span> System config</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
Org mode isn&rsquo;t recognised as it&rsquo;s own mime type by default, but that can easily
be changed with the following file. For system-wide changes try
<code>~/usr/share/mime/packages/org.xml</code>.
</p>
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #7bc275;">&lt;?</span><span style="color: #51afef;">xml</span><span style="color: #7bc275;"> </span><span style="color: #7e7e87;">version="1.0" encoding="utf-8"</span><span style="color: #7bc275;">?&gt;</span>
<span style="color: #7bc275;">&lt;?</span><span style="color: #51afef;">xml</span><span style="color: #7bc275;"> </span><span style="color: #7e7e87;">version="1.0" encoding="utf-8"</span><span style="color: #7bc275;">?&gt;</span>
&lt;<span style="color: #5cEfFF;">mime-info</span> <span style="color: #C57BDB;">xmlns</span>=<span style="color: #7bc275;">'http://www.freedesktop.org/standards/shared-mime-info'</span>&gt;
  &lt;<span style="color: #5cEfFF;">mime-type</span> <span style="color: #DFDFDF;">type</span>=<span style="color: #7bc275;">"text/org"</span>&gt;
    &lt;<span style="color: #5cEfFF;">comment</span>&gt;Emacs Org-mode File&lt;/<span style="color: #5cEfFF;">comment</span>&gt;
    &lt;<span style="color: #5cEfFF;">glob</span> <span style="color: #DFDFDF;">pattern</span>=<span style="color: #7bc275;">"*.org"</span>/&gt;
    &lt;<span style="color: #5cEfFF;">alias</span> <span style="color: #DFDFDF;">type</span>=<span style="color: #7bc275;">"text/org"</span>/&gt;
  &lt;/<span style="color: #5cEfFF;">mime-type</span>&gt;
&lt;/<span style="color: #5cEfFF;">mime-info</span>&gt;
</pre>
</div>
<p>
What&rsquo;s nice is that Papirus <a href="https://github.com/PapirusDevelopmentTeam/papirus-icon-theme/commit/a10fb7f2423d5e30b9c4477416ccdc93c4f3849d">now</a> has an icon for <kbd>text/org</kbd>.
One simply needs to refresh their mime database
</p>
<div class="org-src-container">
<pre class="src src-shell">update-mime-database ~/.local/share/mime
</pre>
</div>
<p>
Then set emacs as the default editor
</p>
<div class="org-src-container">
<pre class="src src-shell">xdg-mime default emacs.desktop text/org
</pre>
</div>
</div>
</div>
<div id="outline-container-org05ff4fe" class="outline-4">
<h4 id="org05ff4fe"><span class="section-number-4">5.1.2</span> Behaviour</h4>
<div class="outline-text-4" id="text-5-1-2">
</div>
<div id="outline-container-orgf6f1f36" class="outline-5">
<h5 id="orgf6f1f36"><span class="section-number-5">5.1.2.1</span> Tweaking defaults</h5>
<div class="outline-text-5" id="text-5-1-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-directory</span> <span style="color: #7bc275;">"~/.org"</span>                      <span style="color: #62686E;">; </span><span style="color: #62686E;">let's put files here</span>
      <span style="color: #DFDFDF;">org-use-property-inheritance</span> t              <span style="color: #62686E;">; </span><span style="color: #62686E;">it's convenient to have properties inherited</span>
      <span style="color: #DFDFDF;">org-log-done</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">time</span>                          <span style="color: #62686E;">; </span><span style="color: #62686E;">having the time a item is done sounds convininet</span>
      <span style="color: #DFDFDF;">org-list-allow-alphabetical</span> t               <span style="color: #62686E;">; </span><span style="color: #62686E;">have a. A. a) A) list bullets</span>
      <span style="color: #DFDFDF;">org-export-in-background</span> t                  <span style="color: #62686E;">; </span><span style="color: #62686E;">run export processes in external emacs process</span>
      <span style="color: #DFDFDF;">org-catch-invisible-edits</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">smart</span><span style="color: #51afef;">)</span>           <span style="color: #62686E;">; </span><span style="color: #62686E;">try not to accidently do weird stuff in invisible regions</span>
</pre>
</div>
<p>
I also like the <code>:comments</code> header-argument, so let&rsquo;s make that a default.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-babel-default-header-args</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:session</span> . <span style="color: #7bc275;">"none"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:results</span> . <span style="color: #7bc275;">"replace"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:exports</span> . <span style="color: #7bc275;">"code"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:cache</span> . <span style="color: #7bc275;">"no"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:noweb</span> . <span style="color: #7bc275;">"no"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:hlines</span> . <span style="color: #7bc275;">"no"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:tangle</span> . <span style="color: #7bc275;">"no"</span><span style="color: #7bc275;">)</span>
                                      <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:comments</span> . <span style="color: #7bc275;">"link"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org78e87df" class="outline-5">
<h5 id="org78e87df"><span class="section-number-5">5.1.2.2</span> Extra functionality</h5>
<div class="outline-text-5" id="text-5-1-2-2">
<p>
Let&rsquo;s also make creating an org buffer just that little bit easier.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">evil-define-command</span> <span style="color: #5cEfFF;">evil-buffer-org-new</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">count</span> file<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Creates a new ORG buffer replacing the current window, optionally</span>
<span style="color: #7e7e87;">   editing a certain FILE"</span>
  <span style="color: #C57BDB;">:repeat</span> nil
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">interactive</span> <span style="color: #7bc275;">"P&lt;f&gt;"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> file
      <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">evil-edit</span> file<span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>buffer <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">generate-new-buffer</span> <span style="color: #7bc275;">"*new org*"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">set-window-buffer</span> nil buffer<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">with-current-buffer</span> buffer
        <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-mode</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">map!</span> <span style="color: #C57BDB;">:leader</span>
  <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:prefix</span> <span style="color: #7bc275;">"b"</span>
    <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">"New empty ORG buffer"</span> <span style="color: #7bc275;">"o"</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">evil-buffer-org-new</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
I think it makes sense to have list bullets change with depth
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-list-demote-modify-bullet</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"+"</span> . <span style="color: #7bc275;">"-"</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"-"</span> . <span style="color: #7bc275;">"+"</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"*"</span> . <span style="color: #7bc275;">"+"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Occasionally I want to cite something.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package!</span> org-ref
   <span style="color: #C57BDB;">:after</span> org
   <span style="color: #C57BDB;">:config</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-ref-completion-library</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-ref-ivy-cite</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
It&rsquo;s also nice to be able to use <code>cdlatex</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-mode-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">turn-on-org-cdlatex</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
At some point in the future it could be good to investigate <a href="https://scripter.co/splitting-an-org-block-into-two/">splitting org blocks</a>.
Likewise <a href="https://archive.casouri.cat/note/2020/insert-math-symbol-in-emacs/">this</a> looks good for symbols.
</p>

<p>
My spelling is atrocious, so let&rsquo;s get flycheck going.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-mode-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">turn-on-flyspell</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge720fb0" class="outline-5">
<h5 id="orge720fb0"><span class="section-number-5">5.1.2.3</span> Super agenda</h5>
<div class="outline-text-5" id="text-5-1-2-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package!</span> org-super-agenda
  <span style="color: #C57BDB;">:commands</span> <span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">org-super-agenda-mode</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org-agenda
  <span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">org-super-agenda-mode</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-agenda-skip-scheduled-if-done</span> t
      <span style="color: #DFDFDF;">org-agenda-skip-deadline-if-done</span> t
      <span style="color: #DFDFDF;">org-agenda-include-deadlines</span> t
      <span style="color: #DFDFDF;">org-agenda-block-separator</span> nil
      <span style="color: #DFDFDF;">org-agenda-compact-blocks</span> t<span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-agenda-custom-commands</span>
      <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"o"</span> <span style="color: #7bc275;">"Overview"</span>
         <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>agenda <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #DFDFDF;">org-agenda-span</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">day</span><span style="color: #51afef;">)</span>
                      <span style="color: #51afef;">(</span><span style="color: #DFDFDF;">org-super-agenda-groups</span>
                       <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Today"</span>
                                <span style="color: #C57BDB;">:time-grid</span> t
                                <span style="color: #C57BDB;">:date</span> today
                                <span style="color: #C57BDB;">:todo</span> <span style="color: #7bc275;">"TODAY"</span>
                                <span style="color: #C57BDB;">:scheduled</span> today
                                <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span>alltodo <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #DFDFDF;">org-agenda-overriding-header</span> <span style="color: #7bc275;">""</span><span style="color: #51afef;">)</span>
                       <span style="color: #51afef;">(</span><span style="color: #DFDFDF;">org-super-agenda-groups</span>
                        <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Next to do"</span>
                                 <span style="color: #C57BDB;">:todo</span> <span style="color: #7bc275;">"NEXT"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Important"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Important"</span>
                                 <span style="color: #C57BDB;">:priority</span> <span style="color: #7bc275;">"A"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">6</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Due Today"</span>
                                 <span style="color: #C57BDB;">:deadline</span> today
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Due Soon"</span>
                                 <span style="color: #C57BDB;">:deadline</span> future
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">8</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Overdue"</span>
                                 <span style="color: #C57BDB;">:deadline</span> past
                                 <span style="color: #C57BDB;">:face</span> error
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">7</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Assignments"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Assignment"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">10</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Issues"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Issue"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">12</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Projects"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Project"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">14</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Emacs"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Emacs"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">13</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Research"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Research"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">15</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"To read"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #7bc275;">"Read"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">30</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Waiting"</span>
                                 <span style="color: #C57BDB;">:todo</span> <span style="color: #7bc275;">"WAITING"</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">20</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"Trivial"</span>
                                 <span style="color: #C57BDB;">:priority&lt;=</span> <span style="color: #7bc275;">"E"</span>
                                 <span style="color: #C57BDB;">:tag</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"Trivial"</span> <span style="color: #7bc275;">"Unimportant"</span><span style="color: #51afef;">)</span>
                                 <span style="color: #C57BDB;">:todo</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"SOMEDAY"</span> <span style="color: #51afef;">)</span>
                                 <span style="color: #C57BDB;">:order</span> <span style="color: #e69055; font-weight: bold;">90</span><span style="color: #7bc275;">)</span>
                          <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:discard</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">:tag</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"Chore"</span> <span style="color: #7bc275;">"Routine"</span> <span style="color: #7bc275;">"Daily"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbc508de" class="outline-5">
<h5 id="orgbc508de"><span class="section-number-5">5.1.2.4</span> Capture</h5>
<div class="outline-text-5" id="text-5-1-2-4">
<p>
Let&rsquo;s setup some org-capture templates
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package!</span> doct
  <span style="color: #C57BDB;">:commands</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">doct</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org-capture
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">org-capture-select-template-prettier</span> <span style="color: #7bc275;">(</span><span style="color: #FCCE7B;">&amp;optional</span> keys<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"Select a capture template, in a prettier way than default</span>
<span style="color: #7e7e87;">  Lisp programs can force the template by setting KEYS to a string."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">org-capture-templates</span>
           <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-contextualize-keys</span>
                <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-capture-upgrade-templates</span> <span style="color: #DFDFDF;">org-capture-templates</span><span style="color: #C57BDB;">)</span>
                <span style="color: #DFDFDF;">org-capture-templates-contexts</span><span style="color: #51afef;">)</span>
               <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"t"</span> <span style="color: #7bc275;">"Task"</span> entry <span style="color: #7bc275;">(</span>file+headline <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">"Tasks"</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> %?\n  %u\n  %a"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> keys
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">or</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">assoc</span> keys <span style="color: #DFDFDF;">org-capture-templates</span><span style="color: #7bc275;">)</span>
              <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">error</span> <span style="color: #7bc275;">"No capture template referred to by \"%s\" keys"</span> keys<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-mks</span> <span style="color: #DFDFDF;">org-capture-templates</span>
                 <span style="color: #7bc275;">"Select a capture template\n&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;"</span>
                 <span style="color: #7bc275;">"Template key: "</span>
                 <span style="color: #C57BDB;">`</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"q"</span> ,<span style="color: #C57BDB;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"stop"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-red</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"\tAbort"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-capture-select-template</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-capture-select-template-prettier</span><span style="color: #C57BDB;">)</span>
  
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">org-mks-pretty</span> <span style="color: #7bc275;">(</span>table title <span style="color: #FCCE7B;">&amp;optional</span> prompt specials<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"Select a member of an alist with multiple keys. Prettified.</span>
<span style="color: #7e7e87;">  </span>
<span style="color: #7e7e87;">  TABLE is the alist which should contain entries where the car is a string.</span>
<span style="color: #7e7e87;">  There should be two types of entries.</span>
<span style="color: #7e7e87;">  </span>
<span style="color: #7e7e87;">  1. prefix descriptions like (\"a\" \"Description\")</span>
<span style="color: #7e7e87;">     This indicates that `a' is a prefix key for multi-letter selection, and</span>
<span style="color: #7e7e87;">     that there are entries following with keys like \"ab\", \"ax\"&#8230;</span>
<span style="color: #7e7e87;">  </span>
<span style="color: #7e7e87;">  2. Select-able members must have more than two elements, with the first</span>
<span style="color: #7e7e87;">     being the string of keys that lead to selecting it, and the second a</span>
<span style="color: #7e7e87;">     short description string of the item.</span>
<span style="color: #7e7e87;">  </span>
<span style="color: #7e7e87;">  The command will then make a temporary buffer listing all entries</span>
<span style="color: #7e7e87;">  that can be selected with a single key, and all the single key</span>
<span style="color: #7e7e87;">  prefixes.  When you press the key for a single-letter entry, it is selected.</span>
<span style="color: #7e7e87;">  When you press a prefix key, the commands (and maybe further prefixes)</span>
<span style="color: #7e7e87;">  under this key will be shown and offered for selection.</span>
<span style="color: #7e7e87;">  </span>
<span style="color: #7e7e87;">  TITLE will be placed over the selection in the temporary buffer,</span>
<span style="color: #7e7e87;">  PROMPT will be used when prompting for a key.  SPECIALS is an</span>
<span style="color: #7e7e87;">  alist with (\"key\" \"description\") entries.  When one of these</span>
<span style="color: #7e7e87;">  is selected, only the bare key is returned."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">save-window-excursion</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #DFDFDF;">inhibit-quit</span> t<span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span>buffer <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-switch-to-buffer-other-window</span> <span style="color: #7bc275;">"*Org Select*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span>prompt <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> prompt <span style="color: #7bc275;">"Select: "</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #DFDFDF;">case-fold-search</span>
      current<span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">unwind-protect</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">catch</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">while</span> t
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq-local</span> <span style="color: #DFDFDF;">evil-normal-state-cursor</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">list</span> nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">erase-buffer</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">insert</span> title <span style="color: #7bc275;">"\n\n"</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>des-keys nil<span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span>allowed-keys <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\C-g"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span>tab-alternatives <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\s"</span> <span style="color: #7bc275;">"\t"</span> <span style="color: #7bc275;">"\r"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #DFDFDF;">cursor-type</span> nil<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">Populate allowed keys and descriptions keys</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">available with CURRENT selector.</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>re <span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"\\`%s</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(</span><span style="color: #7bc275;">.</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">)</span><span style="color: #7bc275;">\\'"</span>
            <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> current <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">regexp-quote</span> current<span style="color: #C57BDB;">)</span> <span style="color: #7bc275;">""</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
            <span style="color: #C57BDB;">(</span>prefix <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> current <span style="color: #51afef;">(</span><span style="color: #a991f1;">concat</span> current <span style="color: #7bc275;">" "</span><span style="color: #51afef;">)</span> <span style="color: #7bc275;">""</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #C57BDB;">(</span>entry table<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">pcase</span> entry
            <span style="color: #62686E;">;; </span><span style="color: #62686E;">Description.</span>
            <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">`</span><span style="color: #51afef;">(</span>,<span style="color: #C57BDB;">(</span><span style="color: #51afef;">and</span> key <span style="color: #7bc275;">(</span>pred <span style="color: #51afef;">(</span><span style="color: #a991f1;">string-match</span> re<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span> ,desc<span style="color: #51afef;">)</span>
             <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>k <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">1</span> key<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> k des-keys<span style="color: #C57BDB;">)</span>
         <span style="color: #62686E;">;; </span><span style="color: #62686E;">Keys ending in tab, space or RET are equivalent.</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">member</span> k tab-alternatives<span style="color: #7bc275;">)</span>
             <span style="color: #7bc275;">(</span><span style="color: #51afef;">push</span> <span style="color: #7bc275;">"\t"</span> allowed-keys<span style="color: #7bc275;">)</span>
           <span style="color: #7bc275;">(</span><span style="color: #51afef;">push</span> k allowed-keys<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> prefix <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> k <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bold</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> <span style="color: #7bc275;">"&#8250;"</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"  "</span> desc <span style="color: #7bc275;">"&#8230;"</span> <span style="color: #7bc275;">"\n"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
            <span style="color: #62686E;">;; </span><span style="color: #62686E;">Usable entry.</span>
            <span style="color: #7bc275;">(</span><span style="color: #C57BDB;">`</span><span style="color: #51afef;">(</span>,<span style="color: #C57BDB;">(</span><span style="color: #51afef;">and</span> key <span style="color: #7bc275;">(</span>pred <span style="color: #51afef;">(</span><span style="color: #a991f1;">string-match</span> re<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span> ,desc . ,_<span style="color: #51afef;">)</span>
             <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>k <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">1</span> key<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> prefix <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> k <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bold</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"   "</span> desc <span style="color: #7bc275;">"\n"</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> k allowed-keys<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
            <span style="color: #7bc275;">(</span>_ nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">Insert special entries, if any.</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> specials
        <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;\n"</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">pcase-dolist</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">`</span><span style="color: #7bc275;">(</span>,key ,description<span style="color: #7bc275;">)</span> specials<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s   %s\n"</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">propertize</span> key <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>bold all-the-icons-red<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> description<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> key allowed-keys<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">Display UI and let user select an entry or</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">a sub-level prefix.</span>
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">goto-char</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">unless</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">pos-visible-in-window-p</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-max</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-fit-window-to-buffer</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>pressed <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org--mks-read-key</span> allowed-keys prompt<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> current <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">concat</span> current pressed<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">cond</span>
         <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #a991f1;">equal</span> pressed <span style="color: #7bc275;">"\C-g"</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">user-error</span> <span style="color: #7bc275;">"Abort"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection is a prefix: open a new menu.</span>
         <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #a991f1;">member</span> pressed des-keys<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection matches an association: return it.</span>
         <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>entry <span style="color: #7bc275;">(</span><span style="color: #a991f1;">assoc</span> current table<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
            <span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> entry <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">throw</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span> entry<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection matches a special entry: return the</span>
         <span style="color: #62686E;">;; </span><span style="color: #62686E;">selection prefix.</span>
         <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #a991f1;">assoc</span> current specials<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">throw</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span> current<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span>t <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">error</span> <span style="color: #7bc275;">"No entry available"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> buffer <span style="color: #51afef;">(</span><span style="color: #a991f1;">kill-buffer</span> buffer<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-mks</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-mks-pretty</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> +org-capture-uni-units <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">split-string</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">f-read-text</span> <span style="color: #7bc275;">"~/.org/.uni-units"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">add-transient-hook!</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-capture-select-template</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-capture-templates</span>
          <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">doct</span> <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tPersonal todo"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"checklist"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-green</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"t"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Inbox"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> %?"</span>
                              <span style="color: #7bc275;">"%i %a"</span><span style="color: #51afef;">)</span>
                   <span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tPersonal note"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"sticky-note-o"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-green</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"n"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Inbox"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* %?"</span>
                              <span style="color: #7bc275;">"%i %a"</span><span style="color: #51afef;">)</span>
                   <span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tUniversity"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"graduation-cap"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-purple</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"u"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"University"</span>
                   <span style="color: #C57BDB;">:unit-prompt</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%%^{Unit|%s}"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-join</span> +org-capture-uni-units <span style="color: #7bc275;">"|"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:children</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tTest"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-material</span> <span style="color: #7bc275;">"timer"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-red</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"t"</span>
                               <span style="color: #C57BDB;">:template</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> [#C] %{unit-prompt} %? :uni:tests:"</span>
                                          <span style="color: #7bc275;">"SCHEDULED: %^{Test date:}T"</span>
                                          <span style="color: #7bc275;">"%i %a"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tAssignment"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-material</span> <span style="color: #7bc275;">"library_books"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-orange</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"a"</span>
                               <span style="color: #C57BDB;">:template</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> [#B] %{unit-prompt} %? :uni:assignments:"</span>
                                          <span style="color: #7bc275;">"DEADLINE: %^{Due date:}T"</span>
                                          <span style="color: #7bc275;">"%i %a"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tLecture"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-fileicon</span> <span style="color: #7bc275;">"keynote"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-orange</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"l"</span>
                               <span style="color: #C57BDB;">:template</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> [#C] %{unit-prompt} %? :uni:lecture:"</span>
                                          <span style="color: #7bc275;">"%i %a"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tMiscellaneous task"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"list"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-yellow</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"u"</span>
                               <span style="color: #C57BDB;">:template</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> [#D] %{unit-prompt} %? :uni:"</span>
                                          <span style="color: #7bc275;">"%i %a"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tEmail"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"envelope"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-blue</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"e"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Inbox"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> %? :email:"</span>
                              <span style="color: #7bc275;">"%i %a"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tInteresting"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"eye"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-lcyan</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"i"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Interesting"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* [ ] %{desc}%? :%{i-type}:"</span>
                              <span style="color: #7bc275;">"%i %a"</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:children</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tWebpage"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"globe"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-green</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"w"</span>
                               <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">"%(org-cliplink-capture) "</span>
                               <span style="color: #C57BDB;">:i-type</span> <span style="color: #7bc275;">"read:web"</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tArticle"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"file-text"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-yellow</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"a"</span>
                               <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">""</span>
                               <span style="color: #C57BDB;">:i-type</span> <span style="color: #7bc275;">"read:reaserch"</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tInformation"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"info-circle"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-blue</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"i"</span>
                               <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">""</span>
                               <span style="color: #C57BDB;">:i-type</span> <span style="color: #7bc275;">"read:info"</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tIdea"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-material</span> <span style="color: #7bc275;">"bubble_chart"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-silver</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"I"</span>
                               <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">""</span>
                               <span style="color: #C57BDB;">:i-type</span> <span style="color: #7bc275;">"idea"</span>
                               <span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tTasks"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"inbox"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-yellow</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"k"</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #DFDFDF;">+org-capture-todo-file</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Tasks"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> %? %^G%{extra}"</span>
                              <span style="color: #7bc275;">"%i"</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:children</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tGeneral Task"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"inbox"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-yellow</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"k"</span>
                               <span style="color: #C57BDB;">:extra</span> <span style="color: #7bc275;">""</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tTask with deadline"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-material</span> <span style="color: #7bc275;">"timer"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-orange</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">-0.1</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"d"</span>
                               <span style="color: #C57BDB;">:extra</span> <span style="color: #7bc275;">"\nDEADLINE: %^{Deadline:}t"</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tScheduled Task"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"calendar"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-orange</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"s"</span>
                               <span style="color: #C57BDB;">:extra</span> <span style="color: #7bc275;">"\nSCHEDULED: %^{Start time:}t"</span>
                               <span style="color: #C57BDB;">)</span>
                              <span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tProject"</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"repo"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-silver</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"p"</span>
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:headline</span> <span style="color: #7bc275;">"Inbox"</span>
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* %{time-or-todo} %?"</span>
                              <span style="color: #7bc275;">"%i"</span>
                              <span style="color: #7bc275;">"%a"</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:file</span> <span style="color: #7bc275;">""</span>
                   <span style="color: #C57BDB;">:custom</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">""</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:children</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tProject-local todo"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"checklist"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-green</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"t"</span>
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"</span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;">"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-project-todo-file<span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tProject-local note"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"sticky-note"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-yellow</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"n"</span>
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"%U"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-project-notes-file<span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span>,<span style="color: #7bc275;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s\tProject-local changelog"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">all-the-icons-faicon</span> <span style="color: #7bc275;">"list"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-blue</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"c"</span>
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"%U"</span>
                               <span style="color: #C57BDB;">:heading</span> <span style="color: #7bc275;">"Unreleased"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-project-changelog-file<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"\tCentralised project templates"</span>
                   <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"o"</span>
                   <span style="color: #C57BDB;">:type</span> entry
                   <span style="color: #C57BDB;">:prepend</span> t
                   <span style="color: #C57BDB;">:template</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"* %{time-or-todo} %?"</span>
                              <span style="color: #7bc275;">"%i"</span>
                              <span style="color: #7bc275;">"%a"</span><span style="color: #51afef;">)</span>
                   <span style="color: #C57BDB;">:children</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"Project todo"</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"t"</span>
                               <span style="color: #C57BDB;">:prepend</span> nil
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"</span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;">"</span>
                               <span style="color: #C57BDB;">:heading</span> <span style="color: #7bc275;">"Tasks"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-central-project-todo-file<span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"Project note"</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"n"</span>
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"%U"</span>
                               <span style="color: #C57BDB;">:heading</span> <span style="color: #7bc275;">"Notes"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-central-project-notes-file<span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"Project changelog"</span>
                               <span style="color: #C57BDB;">:keys</span> <span style="color: #7bc275;">"c"</span>
                               <span style="color: #C57BDB;">:time-or-todo</span> <span style="color: #7bc275;">"%U"</span>
                               <span style="color: #C57BDB;">:heading</span> <span style="color: #7bc275;">"Unreleased"</span>
                               <span style="color: #C57BDB;">:file</span> +org-capture-central-project-changelog-file<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
It would also be nice to improve how the capture dialouge looks
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgbf1343c"><span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">org-capture-select-template-prettier</span> <span style="color: #C57BDB;">(</span><span style="color: #FCCE7B;">&amp;optional</span> keys<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Select a capture template, in a prettier way than default</span>
<span style="color: #7e7e87;">Lisp programs can force the template by setting KEYS to a string."</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #DFDFDF;">org-capture-templates</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">or</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-contextualize-keys</span>
              <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-capture-upgrade-templates</span> <span style="color: #DFDFDF;">org-capture-templates</span><span style="color: #51afef;">)</span>
              <span style="color: #DFDFDF;">org-capture-templates-contexts</span><span style="color: #7bc275;">)</span>
             <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"t"</span> <span style="color: #7bc275;">"Task"</span> entry <span style="color: #C57BDB;">(</span>file+headline <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">"Tasks"</span><span style="color: #C57BDB;">)</span>
                <span style="color: #7bc275;">"* </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #7bc275;"> %?\n  %u\n  %a"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> keys
        <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">assoc</span> keys <span style="color: #DFDFDF;">org-capture-templates</span><span style="color: #C57BDB;">)</span>
            <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">error</span> <span style="color: #7bc275;">"No capture template referred to by \"%s\" keys"</span> keys<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-mks</span> <span style="color: #DFDFDF;">org-capture-templates</span>
               <span style="color: #7bc275;">"Select a capture template\n&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;"</span>
               <span style="color: #7bc275;">"Template key: "</span>
               <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"q"</span> ,<span style="color: #51afef;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">all-the-icons-octicon</span> <span style="color: #7bc275;">"stop"</span> <span style="color: #C57BDB;">:face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">all-the-icons-red</span> <span style="color: #C57BDB;">:v-adjust</span> <span style="color: #e69055; font-weight: bold;">0.01</span><span style="color: #C57BDB;">)</span> <span style="color: #7bc275;">"\tAbort"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-capture-select-template</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-capture-select-template-prettier</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">org-mks-pretty</span> <span style="color: #C57BDB;">(</span>table title <span style="color: #FCCE7B;">&amp;optional</span> prompt specials<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Select a member of an alist with multiple keys. Prettified.</span>

<span style="color: #7e7e87;">TABLE is the alist which should contain entries where the car is a string.</span>
<span style="color: #7e7e87;">There should be two types of entries.</span>

<span style="color: #7e7e87;">1. prefix descriptions like (\"a\" \"Description\")</span>
<span style="color: #7e7e87;">   This indicates that `a' is a prefix key for multi-letter selection, and</span>
<span style="color: #7e7e87;">   that there are entries following with keys like \"ab\", \"ax\"&#8230;</span>

<span style="color: #7e7e87;">2. Select-able members must have more than two elements, with the first</span>
<span style="color: #7e7e87;">   being the string of keys that lead to selecting it, and the second a</span>
<span style="color: #7e7e87;">   short description string of the item.</span>

<span style="color: #7e7e87;">The command will then make a temporary buffer listing all entries</span>
<span style="color: #7e7e87;">that can be selected with a single key, and all the single key</span>
<span style="color: #7e7e87;">prefixes.  When you press the key for a single-letter entry, it is selected.</span>
<span style="color: #7e7e87;">When you press a prefix key, the commands (and maybe further prefixes)</span>
<span style="color: #7e7e87;">under this key will be shown and offered for selection.</span>

<span style="color: #7e7e87;">TITLE will be placed over the selection in the temporary buffer,</span>
<span style="color: #7e7e87;">PROMPT will be used when prompting for a key.  SPECIALS is an</span>
<span style="color: #7e7e87;">alist with (\"key\" \"description\") entries.  When one of these</span>
<span style="color: #7e7e87;">is selected, only the bare key is returned."</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">save-window-excursion</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">inhibit-quit</span> t<span style="color: #C57BDB;">)</span>
    <span style="color: #C57BDB;">(</span>buffer <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-switch-to-buffer-other-window</span> <span style="color: #7bc275;">"*Org Select*"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #C57BDB;">(</span>prompt <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span> prompt <span style="color: #7bc275;">"Select: "</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #DFDFDF;">case-fold-search</span>
    current<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">unwind-protect</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">catch</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">while</span> t
        <span style="color: #51afef;">(</span><span style="color: #51afef;">setq-local</span> <span style="color: #DFDFDF;">evil-normal-state-cursor</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">list</span> nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #a991f1;">erase-buffer</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> title <span style="color: #7bc275;">"\n\n"</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>des-keys nil<span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>allowed-keys <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"\C-g"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>tab-alternatives <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"\s"</span> <span style="color: #7bc275;">"\t"</span> <span style="color: #7bc275;">"\r"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #DFDFDF;">cursor-type</span> nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Populate allowed keys and descriptions keys</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">available with CURRENT selector.</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>re <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"\\`%s</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(</span><span style="color: #7bc275;">.</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">)</span><span style="color: #7bc275;">\\'"</span>
          <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> current <span style="color: #51afef;">(</span><span style="color: #a991f1;">regexp-quote</span> current<span style="color: #51afef;">)</span> <span style="color: #7bc275;">""</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span>prefix <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> current <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> current <span style="color: #7bc275;">" "</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">""</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #51afef;">(</span>entry table<span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">pcase</span> entry
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">Description.</span>
          <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">`</span><span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> key <span style="color: #C57BDB;">(</span>pred <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-match</span> re<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> ,desc<span style="color: #7bc275;">)</span>
           <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>k <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">1</span> key<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #51afef;">(</span><span style="color: #51afef;">push</span> k des-keys<span style="color: #51afef;">)</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">Keys ending in tab, space or RET are equivalent.</span>
       <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">member</span> k tab-alternatives<span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> <span style="color: #7bc275;">"\t"</span> allowed-keys<span style="color: #C57BDB;">)</span>
         <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> k allowed-keys<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">propertize</span> prefix <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">propertize</span> k <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bold</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">propertize</span> <span style="color: #7bc275;">"&#8250;"</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #C57BDB;">)</span> <span style="color: #7bc275;">"  "</span> desc <span style="color: #7bc275;">"&#8230;"</span> <span style="color: #7bc275;">"\n"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">Usable entry.</span>
          <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">`</span><span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> key <span style="color: #C57BDB;">(</span>pred <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-match</span> re<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> ,desc . ,_<span style="color: #7bc275;">)</span>
           <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>k <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">1</span> key<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">propertize</span> prefix <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-comment-face</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">propertize</span> k <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bold</span><span style="color: #C57BDB;">)</span> <span style="color: #7bc275;">"   "</span> desc <span style="color: #7bc275;">"\n"</span><span style="color: #51afef;">)</span>
       <span style="color: #51afef;">(</span><span style="color: #51afef;">push</span> k allowed-keys<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span>_ nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Insert special entries, if any.</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> specials
      <span style="color: #7bc275;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;\n"</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">pcase-dolist</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span>,key ,description<span style="color: #C57BDB;">)</span> specials<span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s   %s\n"</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">propertize</span> key <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">face</span> <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span>bold all-the-icons-red<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> description<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">push</span> key allowed-keys<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Display UI and let user select an entry or</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">a sub-level prefix.</span>
    <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">goto-char</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">unless</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">pos-visible-in-window-p</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">point-max</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-fit-window-to-buffer</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>pressed <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org--mks-read-key</span> allowed-keys prompt<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> current <span style="color: #51afef;">(</span><span style="color: #a991f1;">concat</span> current pressed<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">cond</span>
       <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #a991f1;">equal</span> pressed <span style="color: #7bc275;">"\C-g"</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">user-error</span> <span style="color: #7bc275;">"Abort"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection is a prefix: open a new menu.</span>
       <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #a991f1;">member</span> pressed des-keys<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection matches an association: return it.</span>
       <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>entry <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">assoc</span> current table<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
          <span style="color: #7bc275;">(</span><span style="color: #51afef;">and</span> entry <span style="color: #51afef;">(</span><span style="color: #a991f1;">throw</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span> entry<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">Selection matches a special entry: return the</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">selection prefix.</span>
       <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #a991f1;">assoc</span> current specials<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">throw</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">exit</span> current<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
       <span style="color: #51afef;">(</span>t <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">error</span> <span style="color: #7bc275;">"No entry available"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> buffer <span style="color: #7bc275;">(</span><span style="color: #a991f1;">kill-buffer</span> buffer<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-mks</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-mks-pretty</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
The <a href="file:///home/tec/.emacs.d/bin/org-capture">org-capture bin</a> is rather nice, but I&rsquo;d be nicer with a smaller frame, and
no modeline.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setf</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">alist-get</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">height</span> <span style="color: #DFDFDF;">+org-capture-frame-parameters</span><span style="color: #C57BDB;">)</span> <span style="color: #e69055; font-weight: bold;">15</span><span style="color: #51afef;">)</span>
      <span style="color: #62686E;">;; </span><span style="color: #62686E;">(alist-get 'name +org-capture-frame-parameters) "&#10070; Capture") ;; ATM hardcoded in other places, so changing breaks stuff</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> +org-capture-fn
      <span style="color: #C57BDB;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #7bc275;">()</span>
        <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #a991f1;">set-window-parameter</span> nil <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">mode-line-format</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">none</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-capture</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org520167e" class="outline-5">
<h5 id="org520167e"><span class="section-number-5">5.1.2.5</span> Nicer headings</h5>
<div class="outline-text-5" id="text-5-1-2-5">
<p>
Thanks to alphapapa&rsquo;s <a href="https://github.com/alphapapa/unpackaged.el#export-to-html-with-useful-anchors">unpackaged.el</a>.
Unfortunately this currently seems to break some of the other modifications I&rsquo;ve made.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">define-minor-mode</span> <span style="color: #5cEfFF;">unpackaged/org-export-html-with-useful-ids-mode</span>
  <span style="color: #7e7e87;">"Attempt to export Org as HTML with useful link IDs.</span>
<span style="color: #7e7e87;">Instead of random IDs like \"#orga1b2c3\", use heading titles,</span>
<span style="color: #7e7e87;">made unique when necessary."</span>
  <span style="color: #C57BDB;">:global</span> t
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> unpackaged/org-export-html-with-useful-ids-mode
      <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-export-get-reference</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">unpackaged/org-export-get-reference</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">advice-remove</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-export-get-reference</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">unpackaged/org-export-get-reference</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">unpackaged/org-export-get-reference</span> <span style="color: #C57BDB;">(</span>datum info<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Like `</span><span style="color: #a991f1;">org-export-get-reference</span><span style="color: #7e7e87;">', except uses heading titles instead of random numbers."</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">let</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>cache <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-get</span> info <span style="color: #C57BDB;">:internal-references</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">rassq</span> datum cache<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">let*</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>crossrefs <span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-get</span> info <span style="color: #C57BDB;">:crossrefs</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
               <span style="color: #7bc275;">(</span>cells <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-export-search-cells</span> datum<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">Preserve any pre-existing association between</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">a search cell and a reference, i.e., when some</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">previously published document referenced a location</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">within current file (see</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">`</span><span style="color: #a991f1;">org-publish-resolve-external-link</span><span style="color: #62686E;">').</span>
               <span style="color: #62686E;">;;</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">However, there is no guarantee that search cells are</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">unique, e.g., there might be duplicate custom ID or</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">two headings with the same title in the file.</span>
               <span style="color: #62686E;">;;</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">As a consequence, before re-using any reference to</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">an element or object, we check that it doesn't refer</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">to a previous element or object.</span>
               <span style="color: #7bc275;">(</span>new <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">cl-some</span>
                         <span style="color: #7bc275;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #51afef;">(</span>cell<span style="color: #51afef;">)</span>
                           <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>stored <span style="color: #51afef;">(</span><span style="color: #a991f1;">cdr</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">assoc</span> cell crossrefs<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                             <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> stored
                               <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>old <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-export-format-reference</span> stored<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                 <span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">not</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">assoc</span> old cache<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span> stored<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                         cells<span style="color: #C57BDB;">)</span>
                        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:raw-value</span> datum<span style="color: #7bc275;">)</span>
                          <span style="color: #62686E;">;; </span><span style="color: #62686E;">Heading with a title</span>
                          <span style="color: #7bc275;">(</span>unpackaged/org-export-new-title-reference datum cache<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                        <span style="color: #62686E;">;; </span><span style="color: #7bc275; font-weight: bold;">NOTE:</span><span style="color: #62686E;"> This probably breaks some Org Export</span>
                        <span style="color: #62686E;">;; </span><span style="color: #62686E;">feature, but if it does what I need, fine.</span>
                        <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-export-format-reference</span>
                         <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-export-new-reference</span> cache<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
               <span style="color: #7bc275;">(</span>reference-string new<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">Cache contains both data already associated to</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">a reference and in-use internal references, so as to make</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">unique references.</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">dolist</span> <span style="color: #7bc275;">(</span>cell cells<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">push</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">cons</span> cell new<span style="color: #51afef;">)</span> cache<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">Retain a direct association between reference string and</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">DATUM since (1) not every object or element can be given</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">a search cell (2) it permits quick lookup.</span>
          <span style="color: #C57BDB;">(</span><span style="color: #51afef;">push</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">cons</span> reference-string datum<span style="color: #7bc275;">)</span> cache<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-put</span> info <span style="color: #C57BDB;">:internal-references</span> cache<span style="color: #C57BDB;">)</span>
          reference-string<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">unpackaged/org-export-new-title-reference</span> <span style="color: #C57BDB;">(</span>datum cache<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Return new reference for DATUM that is unique in CACHE."</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">cl-macrolet</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>inc-suffixf <span style="color: #C57BDB;">(</span>place<span style="color: #C57BDB;">)</span>
                             <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #51afef;">progn</span>
                                <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-match</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">rx</span> bos
                                                  <span style="color: #C57BDB;">(</span>minimal-match <span style="color: #7bc275;">(</span>group <span style="color: #51afef;">(</span><span style="color: #a991f1;">1+</span> anything<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                                                  <span style="color: #C57BDB;">(</span>optional <span style="color: #7bc275;">"--"</span> <span style="color: #7bc275;">(</span>group <span style="color: #51afef;">(</span><span style="color: #a991f1;">1+</span> digit<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                                                  eos<span style="color: #51afef;">)</span>
                                              ,place<span style="color: #7bc275;">)</span>
                                <span style="color: #62686E;">;; </span><span style="color: #a991f1; font-weight: bold;">HACK:</span><span style="color: #62686E;"> `</span><span style="color: #a991f1;">s1</span><span style="color: #62686E;">' instead of a gensym.</span>
                                <span style="color: #7bc275;">(</span><span style="color: #51afef;">-let*</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>s1 suffix<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">list</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">1</span> ,place<span style="color: #51afef;">)</span>
                                                           <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">match-string</span> <span style="color: #e69055; font-weight: bold;">2</span> ,place<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                                        <span style="color: #C57BDB;">(</span>suffix <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> suffix
                                                    <span style="color: #51afef;">(</span><span style="color: #a991f1;">string-to-number</span> suffix<span style="color: #51afef;">)</span>
                                                  <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                  <span style="color: #51afef;">(</span><span style="color: #51afef;">setf</span> ,place <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"%s--%s"</span> s1 <span style="color: #7bc275;">(</span><span style="color: #51afef;">cl-incf</span> suffix<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let*</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>title <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:raw-value</span> datum<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>ref <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">url-hexify-string</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">substring-no-properties</span> title<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>parent <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:parent</span> datum<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">while</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">--any</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">equal</span> ref <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> it<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                    cache<span style="color: #C57BDB;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">Title not unique: make it so.</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> parent
            <span style="color: #62686E;">;; </span><span style="color: #62686E;">Append ancestor title.</span>
            <span style="color: #7bc275;">(</span><span style="color: #51afef;">setf</span> title <span style="color: #51afef;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:raw-value</span> parent<span style="color: #C57BDB;">)</span>
                                <span style="color: #7bc275;">"--"</span> title<span style="color: #51afef;">)</span>
                  ref <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">url-hexify-string</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">substring-no-properties</span> title<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                  parent <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:parent</span> parent<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
          <span style="color: #62686E;">;; </span><span style="color: #62686E;">No more ancestors: add and increment a number.</span>
          <span style="color: #7bc275;">(</span>inc-suffixf ref<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      ref<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5c7491a" class="outline-5">
<h5 id="org5c7491a"><span class="section-number-5">5.1.2.6</span> Nicer <code>org-return</code></h5>
<div class="outline-text-5" id="text-5-1-2-6">
<p>
Once again, from <a href="https://github.com/alphapapa/unpackaged.el#org-return-dwim">unpackaged.el</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">unpackaged/org-element-descendant-of</span> <span style="color: #7bc275;">(</span>type element<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"Return non-nil if ELEMENT is a descendant of TYPE.</span>
<span style="color: #7e7e87;">TYPE should be an element type, like `</span><span style="color: #a991f1;">item</span><span style="color: #7e7e87;">' or `</span><span style="color: #a991f1;">paragraph</span><span style="color: #7e7e87;">'.</span>
<span style="color: #7e7e87;">ELEMENT should be a list like that returned by `</span><span style="color: #a991f1;">org-element-context</span><span style="color: #7e7e87;">'."</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">MAYBE: Use `</span><span style="color: #a991f1;">org-element-lineage</span><span style="color: #62686E;">'.</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">when-let*</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>parent <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:parent</span> element<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">eq</span> type <span style="color: #7bc275;">(</span><span style="color: #a991f1;">car</span> parent<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">unpackaged/org-element-descendant-of</span> type parent<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

<span style="color: #62686E;">;;;</span><span style="color: #62686E;">###</span><span style="color: #FCCE7B;">autoload</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">unpackaged/org-return-dwim</span> <span style="color: #7bc275;">(</span><span style="color: #FCCE7B;">&amp;optional</span> default<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"A helpful replacement for `</span><span style="color: #a991f1;">org-return-indent</span><span style="color: #7e7e87;">'.  With prefix, call `</span><span style="color: #a991f1;">org-return-indent</span><span style="color: #7e7e87;">'.</span>

<span style="color: #7e7e87;">On headings, move point to position after entry content.  In</span>
<span style="color: #7e7e87;">lists, insert a new item or end the list, with checkbox if</span>
<span style="color: #7e7e87;">appropriate.  In tables, insert a new row or end the table."</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Inspired by John Kitchin: http://kitchingroup.cheme.cmu.edu/blog/2017/04/09/A-better-return-in-org-mode/</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span> <span style="color: #7bc275;">"P"</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> default
        <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-return</span> t<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">cond</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">Act depending on context around point.</span>

       <span style="color: #62686E;">;; </span><span style="color: #7bc275; font-weight: bold;">NOTE:</span><span style="color: #62686E;"> I prefer RET to not follow links, but by uncommenting this block, links will be</span>
       <span style="color: #62686E;">;; </span><span style="color: #62686E;">followed.</span>

       <span style="color: #62686E;">;; </span><span style="color: #62686E;">((eq 'link (car (org-element-context)))</span>
       <span style="color: #62686E;">;;  </span><span style="color: #62686E;">;; Link: Open it.</span>
       <span style="color: #62686E;">;;  </span><span style="color: #62686E;">(org-open-at-point-global))</span>

       <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-at-heading-p</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">Heading: Move to position after entry content.</span>
        <span style="color: #62686E;">;; </span><span style="color: #7bc275; font-weight: bold;">NOTE:</span><span style="color: #62686E;"> This is probably the most interesting feature of this function.</span>
        <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>heading-start <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-entry-beginning-position</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #a991f1;">goto-char</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-entry-end-position</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #51afef;">cond</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">and</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-at-heading-p</span><span style="color: #51afef;">)</span>
                      <span style="color: #51afef;">(</span><span style="color: #a991f1;">=</span> heading-start <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-entry-beginning-position</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                 <span style="color: #62686E;">;; </span><span style="color: #62686E;">Entry ends on its heading; add newline after</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">end-of-line</span><span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"\n\n"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                <span style="color: #C57BDB;">(</span>t
                 <span style="color: #62686E;">;; </span><span style="color: #62686E;">Entry ends after its heading; back up</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">forward-line</span> <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">end-of-line</span><span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-at-heading-p</span><span style="color: #51afef;">)</span>
                   <span style="color: #62686E;">;; </span><span style="color: #62686E;">At the same heading</span>
                   <span style="color: #51afef;">(</span><span style="color: #a991f1;">forward-line</span><span style="color: #51afef;">)</span>
                   <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"\n"</span><span style="color: #51afef;">)</span>
                   <span style="color: #51afef;">(</span><span style="color: #a991f1;">forward-line</span> <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                 <span style="color: #62686E;">;; </span><span style="color: #ff665c; font-weight: bold;">FIXME:</span><span style="color: #62686E;"> looking-back is supposed to be called with more arguments.</span>
                 <span style="color: #7bc275;">(</span><span style="color: #51afef;">while</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">not</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">looking-back</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">rx</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">repeat</span> <span style="color: #e69055; font-weight: bold;">3</span> <span style="color: #C57BDB;">(</span>seq <span style="color: #7bc275;">(</span>optional blank<span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"\n"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                   <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"\n"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">forward-line</span> <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

       <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-at-item-checkbox-p</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">Checkbox: Insert new item with checkbox.</span>
        <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-insert-todo-heading</span> nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

       <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-in-item-p</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">Plain list.  Yes, this gets a little complicated...</span>
        <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>context <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-context</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">or</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">plain-list</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> context<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>  <span style="color: #62686E;">; </span><span style="color: #62686E;">First item in list</span>
                  <span style="color: #7bc275;">(</span><span style="color: #51afef;">and</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">item</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">car</span> context<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                       <span style="color: #51afef;">(</span><span style="color: #a991f1;">not</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:contents-begin</span> context<span style="color: #7bc275;">)</span>
                                <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:contents-end</span> context<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                  <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">unpackaged/org-element-descendant-of</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">item</span> context<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>  <span style="color: #62686E;">; </span><span style="color: #62686E;">Element in list item, e.g. a link</span>
              <span style="color: #62686E;">;; </span><span style="color: #62686E;">Non-empty item: Add new item.</span>
              <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-insert-item</span><span style="color: #C57BDB;">)</span>
            <span style="color: #62686E;">;; </span><span style="color: #62686E;">Empty item: Close the list.</span>
            <span style="color: #62686E;">;; </span><span style="color: #FCCE7B; font-weight: bold;">TODO:</span><span style="color: #62686E;"> Do this with org functions rather than operating on the text. Can't seem to find the right function.</span>
            <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">delete-region</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">line-beginning-position</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">line-end-position</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
            <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">insert</span> <span style="color: #7bc275;">"\n"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

       <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">fboundp</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-inlinetask-in-task-p</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span>org-inlinetask-in-task-p<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">Inline task: Don't insert a new heading.</span>
        <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-return</span> t<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

       <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-at-table-p</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #51afef;">cond</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #51afef;">save-excursion</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">beginning-of-line</span><span style="color: #7bc275;">)</span>
                 <span style="color: #62686E;">;; </span><span style="color: #62686E;">See `</span><span style="color: #a991f1;">org-table-next-field</span><span style="color: #62686E;">'.</span>
                 <span style="color: #7bc275;">(</span><span style="color: #51afef;">cl-loop</span> with end = <span style="color: #51afef;">(</span><span style="color: #a991f1;">line-end-position</span><span style="color: #51afef;">)</span>
                          for cell = <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-element-table-cell-parser</span><span style="color: #51afef;">)</span>
                          always <span style="color: #51afef;">(</span><span style="color: #a991f1;">equal</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:contents-begin</span> cell<span style="color: #C57BDB;">)</span>
                                        <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:contents-end</span> cell<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                          while <span style="color: #51afef;">(</span><span style="color: #a991f1;">re-search-forward</span> <span style="color: #7bc275;">"|"</span> end t<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">Empty row: end the table.</span>
               <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">delete-region</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">line-beginning-position</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">line-end-position</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
               <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-return</span> t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
              <span style="color: #51afef;">(</span>t
               <span style="color: #62686E;">;; </span><span style="color: #62686E;">Non-empty row: call `</span><span style="color: #a991f1;">org-return-indent</span><span style="color: #62686E;">'.</span>
               <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-return</span> t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
       <span style="color: #C57BDB;">(</span>t
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">All other cases: call `</span><span style="color: #a991f1;">org-return-indent</span><span style="color: #62686E;">'.</span>
        <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-return</span> t<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">org-return-indent</span> <span style="color: #C57BDB;">:override</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">unpackaged/org-return-dwim</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5ead467" class="outline-4">
<h4 id="org5ead467"><span class="section-number-4">5.1.3</span> Visuals</h4>
<div class="outline-text-4" id="text-5-1-3">
</div>
<div id="outline-container-org471beb1" class="outline-5">
<h5 id="org471beb1"><span class="section-number-5">5.1.3.1</span> In editor</h5>
<div class="outline-text-5" id="text-5-1-3-1">
</div>
<div id="outline-container-org1d04371" class="outline-6">
<h6 id="org1d04371"><span class="section-number-6">5.1.3.1.1</span> Font Display</h6>
<div class="outline-text-6" id="text-5-1-3-1-1">
<p>
Mixed pitch is great. As is <code>+org-pretty-mode</code>, let&rsquo;s use them.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">add-hook!</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-mode-hook</span> <span style="color: #C57BDB;">#'</span><span style="color: #DFDFDF;">+org-pretty-mode</span> <span style="color: #C57BDB;">#'</span><span style="color: #DFDFDF;">mixed-pitch-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Earlier I loaded the <code>org-pretty-table</code> package, let&rsquo;s enable it everywhere!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">global-org-pretty-table-mode</span> t<span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Let&rsquo;s make headings a bit bigger
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">custom-set-faces!</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-1 <span style="color: #C57BDB;">:weight</span> extra-bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.2</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-2 <span style="color: #C57BDB;">:weight</span> bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.12</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-3 <span style="color: #C57BDB;">:weight</span> bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.1</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-4 <span style="color: #C57BDB;">:weight</span> semi-bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.08</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-5 <span style="color: #C57BDB;">:weight</span> semi-bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.05</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-6 <span style="color: #C57BDB;">:weight</span> semi-bold <span style="color: #C57BDB;">:height</span> <span style="color: #e69055; font-weight: bold;">1.02</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-8 <span style="color: #C57BDB;">:weight</span> semi-bold<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>outline-9 <span style="color: #C57BDB;">:weight</span> semi-bold<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2c0aa0e" class="outline-6">
<h6 id="org2c0aa0e"><span class="section-number-6">5.1.3.1.2</span> Symbols</h6>
<div class="outline-text-6" id="text-5-1-3-1-2">
<p>
It&rsquo;s also nice to change the character used for collapsed items (by default <code>…</code>),
I think <code>▾</code> is better for indicating &rsquo;collapsed section&rsquo;.
and add an extra <code>org-bullet</code> to the default list of four.
I&rsquo;ve also added some fun alternatives, just commented out.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package!</span> org-superstar <span style="color: #62686E;">; </span><span style="color: #62686E;">"prettier" bullets</span>
  <span style="color: #C57BDB;">:hook</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-mode</span> . <span style="color: #DFDFDF;">org-superstar-mode</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">use-package</span> org-fancy-priorities
  <span style="color: #C57BDB;">:diminish</span>
  <span style="color: #C57BDB;">:defines</span> <span style="color: #DFDFDF;">org-fancy-priorities-list</span>
  <span style="color: #C57BDB;">:hook</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">org-mode</span> . <span style="color: #DFDFDF;">org-fancy-priorities-mode</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:config</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">unless</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">char-displayable-p</span> ?&#10071;<span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-fancy-priorities-list</span> <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"HIGH"</span> <span style="color: #7bc275;">"MID"</span> <span style="color: #7bc275;">"LOW"</span> <span style="color: #7bc275;">"OPTIONAL"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">use-package</span> org-pretty-tags
  <span style="color: #C57BDB;">:config</span>
   <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-pretty-tags-surrogate-strings</span>
         <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"uni"</span> . <span style="color: #7bc275;">"&#127891;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"assignment"</span> . <span style="color: #7bc275;">"&#128211;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"email"</span> . <span style="color: #7bc275;">"&#128386;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"read"</span> . <span style="color: #7bc275;">"&#128366;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"article"</span> . <span style="color: #7bc275;">"&#128441;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"web"</span> . <span style="color: #7bc275;">"&#127760;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"info"</span> . <span style="color: #7bc275;">"&#128712;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"issue"</span> . <span style="color: #7bc275;">"&#128027;"</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"emacs"</span> . <span style="color: #7bc275;">"&#603;"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
   <span style="color: #7bc275;">(</span><span style="color: #DFDFDF;">org-pretty-tags-global-mode</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-ellipsis</span> <span style="color: #7bc275;">" &#9662; "</span>
        <span style="color: #DFDFDF;">org-superstar-headline-bullets-list</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#9673;"</span> <span style="color: #7bc275;">"&#9675;"</span> <span style="color: #7bc275;">"&#10040;"</span> <span style="color: #7bc275;">"&#10047;"</span> <span style="color: #7bc275;">"&#10020;"</span> <span style="color: #7bc275;">"&#10012;"</span> <span style="color: #7bc275;">"&#9670;"</span> <span style="color: #7bc275;">"&#9654;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #DFDFDF;">org-fancy-priorities-list</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>?A . <span style="color: #7bc275;">"&#9873;"</span><span style="color: #51afef;">)</span>  <span style="color: #62686E;">;; </span><span style="color: #62686E;">ASAP</span>
                                    <span style="color: #51afef;">(</span>?B . <span style="color: #7bc275;">"&#11014;"</span><span style="color: #51afef;">)</span>  <span style="color: #62686E;">;; </span><span style="color: #62686E;">High</span>
                                    <span style="color: #51afef;">(</span>?C . <span style="color: #7bc275;">"&#9632;"</span><span style="color: #51afef;">)</span>  <span style="color: #62686E;">;; </span><span style="color: #62686E;">Medium</span>
                                    <span style="color: #51afef;">(</span>?D . <span style="color: #7bc275;">"&#11015;"</span><span style="color: #51afef;">)</span>  <span style="color: #62686E;">;; </span><span style="color: #62686E;">Low</span>
                                    <span style="color: #51afef;">(</span>?E . <span style="color: #7bc275;">"&#10067;"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">Optional</span>
        <span style="color: #DFDFDF;">org-priority-faces</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>?A . all-the-icons-red<span style="color: #51afef;">)</span>
                             <span style="color: #51afef;">(</span>?B . all-the-icons-orange<span style="color: #51afef;">)</span>
                             <span style="color: #51afef;">(</span>?C . all-the-icons-yellow<span style="color: #51afef;">)</span>
                             <span style="color: #51afef;">(</span>?D . all-the-icons-green<span style="color: #51afef;">)</span>
                             <span style="color: #51afef;">(</span>?E . all-the-icons-blue<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #DFDFDF;">org-priority-highest</span> ?A
        <span style="color: #DFDFDF;">org-priority-lowest</span> ?E
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">org-superstar-headline-bullets-list '("&#8544;" "&#8545;" "&#8546;" "&#8547;" "&#8548;" "&#8549;" "&#8550;" "&#8551;" "&#8552;" "&#8553;")</span>
        <span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
It&rsquo;s also nice to make use of the unicode characters for check boxes, and other commands.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">appendq!</span> <span style="color: #DFDFDF;">+pretty-code-symbols</span>
            <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:checkbox</span>    <span style="color: #7bc275;">"&#9744;"</span>
              <span style="color: #C57BDB;">:pending</span>     <span style="color: #7bc275;">"&#9724;"</span>
              <span style="color: #C57BDB;">:checkedbox</span>  <span style="color: #7bc275;">"&#9745;"</span>
              <span style="color: #C57BDB;">:results</span>     <span style="color: #7bc275;">"&#129078;"</span>
              <span style="color: #C57BDB;">:property</span>    <span style="color: #7bc275;">"&#9784;"</span>
              <span style="color: #C57BDB;">:properties</span>  <span style="color: #7bc275;">"&#9881;"</span>
              <span style="color: #C57BDB;">:end</span>         <span style="color: #7bc275;">"&#8718;"</span>
              <span style="color: #C57BDB;">:options</span>     <span style="color: #7bc275;">"&#8997;"</span>
              <span style="color: #C57BDB;">:title</span>       <span style="color: #7bc275;">"&#120399;"</span>
              <span style="color: #C57BDB;">:author</span>      <span style="color: #7bc275;">"&#120380;"</span>
              <span style="color: #C57BDB;">:date</span>        <span style="color: #7bc275;">"&#120383;"</span>
              <span style="color: #C57BDB;">:begin_quote</span> <span style="color: #7bc275;">"&#10094;"</span>
              <span style="color: #C57BDB;">:end_quote</span>   <span style="color: #7bc275;">"&#10095;"</span>
              <span style="color: #C57BDB;">:em_dash</span>     <span style="color: #7bc275;">"&#8212;"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">set-pretty-symbols!</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-mode</span>
    <span style="color: #C57BDB;">:merge</span> t
    <span style="color: #C57BDB;">:checkbox</span>    <span style="color: #7bc275;">"[ ]"</span>
    <span style="color: #C57BDB;">:pending</span>     <span style="color: #7bc275;">"[-]"</span>
    <span style="color: #C57BDB;">:checkedbox</span>  <span style="color: #7bc275;">"[X]"</span>
    <span style="color: #C57BDB;">:results</span>     <span style="color: #7bc275;">"#+RESULTS:"</span>
    <span style="color: #C57BDB;">:property</span>    <span style="color: #7bc275;">"#+PROPERTY:"</span>
    <span style="color: #C57BDB;">:property</span>    <span style="color: #7bc275;">":PROPERTIES:"</span>
    <span style="color: #C57BDB;">:end</span>         <span style="color: #7bc275;">":END:"</span>
    <span style="color: #C57BDB;">:options</span>     <span style="color: #7bc275;">"#+OPTIONS:"</span>
    <span style="color: #C57BDB;">:title</span>       <span style="color: #7bc275;">"#+TITLE:"</span>
    <span style="color: #C57BDB;">:author</span>      <span style="color: #7bc275;">"#+AUTHOR:"</span>
    <span style="color: #C57BDB;">:date</span>        <span style="color: #7bc275;">"#+DATE:"</span>
    <span style="color: #C57BDB;">:begin_quote</span> <span style="color: #7bc275;">"#+BEGIN_QUOTE"</span>
    <span style="color: #C57BDB;">:end_quote</span>   <span style="color: #7bc275;">"#+END_QUOTE"</span>
    <span style="color: #C57BDB;">:em_dash</span>     <span style="color: #7bc275;">"---"</span><span style="color: #C57BDB;">)</span>
<span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #a991f1;">plist-put</span> <span style="color: #DFDFDF;">+pretty-code-symbols</span> <span style="color: #C57BDB;">:name</span> <span style="color: #7bc275;">"&#8269;"</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">; </span><span style="color: #62686E;">or &#8250; could be good?</span>
</pre>
</div>
<p>
We also like <code>org-fragtog</code>, and that wants a hook.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-mode-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-fragtog-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb206e16" class="outline-6">
<h6 id="orgb206e16"><span class="section-number-6">5.1.3.1.3</span> LaTeX Fragments</h6>
<div class="outline-text-6" id="text-5-1-3-1-3">
<p>
It&rsquo;s nice to customise the look of LaTeX fragments so they fit better in the
text &#x2014; like this \(\sqrt{\beta^2+3}-\sum_{\phi=1}^\infty \frac{x^\phi-1}{\Gamma(a)}\). Let&rsquo;s start by adding a sans font.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-format-latex-header</span> <span style="color: #7bc275;">"\\documentclass{article}</span>
<span style="color: #7bc275;">\\usepackage[usenames]{color}</span>

<span style="color: #7bc275;">\\usepackage[T1]{fontenc}</span>
<span style="color: #7bc275;">\\usepackage{mathtools}</span>
<span style="color: #7bc275;">\\usepackage{textcomp,amssymb}</span>
<span style="color: #7bc275;">\\usepackage[makeroom]{cancel}</span>

<span style="color: #7bc275;">\\pagestyle{empty}             % do not remove</span>
<span style="color: #7bc275;">% The settings below are copied from fullpage.sty</span>
<span style="color: #7bc275;">\\setlength{\\textwidth}{\\paperwidth}</span>
<span style="color: #7bc275;">\\addtolength{\\textwidth}{-3cm}</span>
<span style="color: #7bc275;">\\setlength{\\oddsidemargin}{1.5cm}</span>
<span style="color: #7bc275;">\\addtolength{\\oddsidemargin}{-2.54cm}</span>
<span style="color: #7bc275;">\\setlength{\\evensidemargin}{\\oddsidemargin}</span>
<span style="color: #7bc275;">\\setlength{\\textheight}{\\paperheight}</span>
<span style="color: #7bc275;">\\addtolength{\\textheight}{-\\headheight}</span>
<span style="color: #7bc275;">\\addtolength{\\textheight}{-\\headsep}</span>
<span style="color: #7bc275;">\\addtolength{\\textheight}{-\\footskip}</span>
<span style="color: #7bc275;">\\addtolength{\\textheight}{-3cm}</span>
<span style="color: #7bc275;">\\setlength{\\topmargin}{1.5cm}</span>
<span style="color: #7bc275;">\\addtolength{\\topmargin}{-2.54cm}</span>
<span style="color: #7bc275;">% my custom stuff</span>
<span style="color: #7bc275;">\\usepackage{arev}</span>
<span style="color: #7bc275;">\\usepackage{arevmath}"</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
We can either render from a <code>dvi</code> or <code>pdf</code> file, so let&rsquo;s benchmark <code>latex</code> and
<code>pdflatex</code>.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>latex</code> time</th>
<th scope="col" class="org-left"><code>pdflatex</code> time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">135±2 ms</td>
<td class="org-left">215±3 ms</td>
</tr>
</tbody>
</table>

<p>
On the rendering side, there are two <code>.dvi</code>-to-image convertors which I am
interested in: <code>dvipng</code> and <code>dvisvgm</code>. Then with the a <code>.pdf</code> we have <code>pdf2svg</code>.
For inline preview we care about speed, while for exporting we care about file
size and preffer a vector graphic.
</p>

<p>
Using the above latex expression and benchmarking lead to the following results:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>dvipng</code> time</th>
<th scope="col" class="org-left"><code>dvisvgm</code> time</th>
<th scope="col" class="org-left"><code>pdf2svg</code> time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">89±2 ms</td>
<td class="org-left">178±2 ms</td>
<td class="org-left">12±2 ms</td>
</tr>
</tbody>
</table>

<p>
Now let&rsquo;s combine this to see what&rsquo;s best
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Tool chain</th>
<th scope="col" class="org-left">Total time</th>
<th scope="col" class="org-left">Resultant file size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>latex</code> + <code>dvipng</code></td>
<td class="org-left">226±2 ms</td>
<td class="org-left">7 KiB</td>
</tr>

<tr>
<td class="org-left"><code>latex</code> + <code>dvisvgm</code></td>
<td class="org-left">392±4 ms</td>
<td class="org-left">8 KiB</td>
</tr>

<tr>
<td class="org-left"><code>pdflatex</code> + <code>pdf2svg</code></td>
<td class="org-left">230±2 ms</td>
<td class="org-left">16 KiB</td>
</tr>
</tbody>
</table>

<p>
So, let&rsquo;s use <code>dvipng</code> for previewing LaTeX fragments in-emacs, but <code>dvisvgm</code> for <a href="#org956020f">LaTeX Rendering</a>.
<i>Unfortunately: it seems that svg sizing is annoying ATM, so let&rsquo;s actually not do this right now.</i>
</p>

<p>
As well as having a sans font, there are a few other tweaks which can make them
look better. Namely making sure that the colours switch when the theme does.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
<span style="color: #62686E;">;; </span><span style="color: #62686E;">make background of fragments transparent</span>
<span style="color: #62686E;">;; </span><span style="color: #62686E;">(let ((dvipng--plist (alist-get 'dvipng org-preview-latex-process-alist)))</span>
<span style="color: #62686E;">;;   </span><span style="color: #62686E;">(plist-put dvipng--plist :use-xcolor t)</span>
<span style="color: #62686E;">;;   </span><span style="color: #62686E;">(plist-put dvipng--plist :image-converter '("dvipng -D %D -bg 'transparent' -T tight -o %O %f")))</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">add-hook!</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">doom-load-theme-hook</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">+org-refresh-latex-background</span> <span style="color: #51afef;">()</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">plist-put!</span> <span style="color: #DFDFDF;">org-format-latex-options</span>
                  <span style="color: #C57BDB;">:background</span>
                  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">face-attribute</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">cadr</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">assq</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">default</span> <span style="color: #DFDFDF;">face-remapping-alist</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                      <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">default</span><span style="color: #7bc275;">)</span>
                                  <span style="color: #C57BDB;">:background</span> nil t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
<span style="color: #51afef;">)</span>
</pre>
</div>
<p>
It&rsquo;d be nice to make <code>mhchem</code> equations able to be rendered.
NB: This doesn&rsquo;t work at the moment.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-regexps</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"\\ce"</span> <span style="color: #7bc275;">"^\\\\ce{</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(?:</span><span style="color: #7bc275;">[</span><span style="color: #C57BDB; font-weight: bold;">^</span><span style="color: #7bc275;">\000{}]</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">|</span><span style="color: #7bc275;">{[</span><span style="color: #C57BDB; font-weight: bold;">^</span><span style="color: #7bc275;">\000}]+?}</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">)</span><span style="color: #7bc275;">}"</span> <span style="color: #e69055; font-weight: bold;">0</span> nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb45eb12" class="outline-6">
<h6 id="orgb45eb12"><span class="section-number-6">5.1.3.1.4</span> Stolen from <a href="https://github.com/jkitchin/scimax">scimax</a> (semi-working right now)</h6>
<div class="outline-text-6" id="text-5-1-3-1-4">
<p>
I want fragment justification
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">scimax-org-latex-fragment-justify</span> <span style="color: #7bc275;">(</span>justification<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"Justify the latex fragment at point with JUSTIFICATION.</span>
<span style="color: #7e7e87;">JUSTIFICATION is a symbol for 'left, 'center or 'right."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span>
     <span style="color: #51afef;">(</span><span style="color: #a991f1;">list</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">intern-soft</span>
            <span style="color: #7bc275;">(</span><span style="color: #a991f1;">completing-read</span> <span style="color: #7bc275;">"Justification (left): "</span> <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span>left center right<span style="color: #51afef;">)</span>
                             nil t nil nil <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">left</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let*</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>ov <span style="color: #7bc275;">(</span>ov-at<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>beg <span style="color: #7bc275;">(</span>ov-beg ov<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>end <span style="color: #7bc275;">(</span>ov-end ov<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>shift <span style="color: #7bc275;">(</span><span style="color: #a991f1;">-</span> beg <span style="color: #51afef;">(</span><span style="color: #a991f1;">line-beginning-position</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>img <span style="color: #7bc275;">(</span><span style="color: #a991f1;">overlay-get</span> ov <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">display</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           <span style="color: #C57BDB;">(</span>img <span style="color: #7bc275;">(</span><span style="color: #51afef;">and</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">and</span> img <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">consp</span> img<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">car</span> img<span style="color: #7bc275;">)</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">image</span><span style="color: #C57BDB;">)</span>
                          <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">image-type-available-p</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">plist-get</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">cdr</span> img<span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:type</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                     img<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
           space-left offset<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">when</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">and</span> img
                 <span style="color: #62686E;">;; </span><span style="color: #62686E;">This means the equation is at the start of the line</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">=</span> beg <span style="color: #51afef;">(</span><span style="color: #a991f1;">line-beginning-position</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #51afef;">or</span>
                  <span style="color: #51afef;">(</span><span style="color: #a991f1;">string=</span> <span style="color: #7bc275;">""</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">s-trim</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">buffer-substring</span> end <span style="color: #51afef;">(</span><span style="color: #a991f1;">line-end-position</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                  <span style="color: #51afef;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex-environment</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">car</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-context</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> space-left <span style="color: #7bc275;">(</span><span style="color: #a991f1;">-</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">window-max-chars-per-line</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">image-size</span> img<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
              offset <span style="color: #7bc275;">(</span><span style="color: #a991f1;">floor</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">cond</span>
                             <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> justification <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">center</span><span style="color: #7bc275;">)</span>
                              <span style="color: #7bc275;">(</span><span style="color: #a991f1;">-</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">/</span> space-left <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span> shift<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                             <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> justification <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">right</span><span style="color: #7bc275;">)</span>
                              <span style="color: #7bc275;">(</span><span style="color: #a991f1;">-</span> space-left shift<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                             <span style="color: #C57BDB;">(</span>t
                              <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">&gt;=</span> offset <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #7bc275;">)</span>
          <span style="color: #7bc275;">(</span><span style="color: #a991f1;">overlay-put</span> ov <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">before-string</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">make-string</span> offset ?\ <span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">scimax-org-latex-fragment-justify-advice</span> <span style="color: #7bc275;">(</span>beg end image imagetype<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"After advice function to justify fragments."</span>
    <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">scimax-org-latex-fragment-justify</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">or</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">plist-get</span> <span style="color: #DFDFDF;">org-format-latex-options</span> <span style="color: #C57BDB;">:justify</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">left</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>


  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">scimax-toggle-latex-fragment-justification</span> <span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"Toggle if LaTeX fragment justification options can be used."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">not</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">get</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-latex-fragment-justify-advice</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">progn</span>
          <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org--format-latex-make-overlay</span> <span style="color: #C57BDB;">:after</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-latex-fragment-justify-advice</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">put</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-latex-fragment-justify-advice</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span> t<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"Latex fragment justification enabled"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">advice-remove</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org--format-latex-make-overlay</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-latex-fragment-justify-advice</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">put</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-latex-fragment-justify-advice</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span> nil<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"Latex fragment justification disabled"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
There&rsquo;s also this lovely equation numbering stuff I&rsquo;ll nick
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #62686E;">Numbered equations all have (1) as the number for fragments with vanilla</span>
<span style="color: #62686E;">;; </span><span style="color: #62686E;">org-mode. This code injects the correct numbers into the previews so they</span>
<span style="color: #62686E;">;; </span><span style="color: #62686E;">look good.</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">scimax-org-renumber-environment</span> <span style="color: #7bc275;">(</span>orig-func <span style="color: #FCCE7B;">&amp;rest</span> args<span style="color: #7bc275;">)</span>
    <span style="color: #7e7e87;">"A function to inject numbers in LaTeX fragment previews."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span>results <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">()</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span>counter <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">numberp</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> results <span style="color: #C57BDB;">(</span><span style="color: #51afef;">loop</span> for <span style="color: #7bc275;">(</span>begin .  env<span style="color: #7bc275;">)</span> in
                          <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-map</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-element-parse-buffer</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex-environment</span>
                            <span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>env<span style="color: #C57BDB;">)</span>
                              <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">cons</span>
                               <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:begin</span> env<span style="color: #7bc275;">)</span>
                               <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">org-element-property</span> <span style="color: #C57BDB;">:value</span> env<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
                          collect
                          <span style="color: #7bc275;">(</span><span style="color: #51afef;">cond</span>
                           <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #51afef;">and</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">string-match</span> <span style="color: #7bc275;">"\\\\begin{equation}"</span> env<span style="color: #7bc275;">)</span>
                                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">not</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">string-match</span> <span style="color: #7bc275;">"\\\\tag{"</span> env<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
                            <span style="color: #C57BDB;">(</span><span style="color: #51afef;">incf</span> counter<span style="color: #C57BDB;">)</span>
                            <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">cons</span> begin counter<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                           <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #a991f1;">string-match</span> <span style="color: #7bc275;">"\\\\begin{align}"</span> env<span style="color: #C57BDB;">)</span>
                            <span style="color: #C57BDB;">(</span><span style="color: #51afef;">prog2</span>
                                <span style="color: #7bc275;">(</span><span style="color: #51afef;">incf</span> counter<span style="color: #7bc275;">)</span>
                                <span style="color: #7bc275;">(</span><span style="color: #a991f1;">cons</span> begin counter<span style="color: #7bc275;">)</span>
                              <span style="color: #7bc275;">(</span><span style="color: #51afef;">with-temp-buffer</span>
                                <span style="color: #51afef;">(</span><span style="color: #a991f1;">insert</span> env<span style="color: #51afef;">)</span>
                                <span style="color: #51afef;">(</span><span style="color: #a991f1;">goto-char</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                <span style="color: #62686E;">;; </span><span style="color: #62686E;">\\ is used for a new line. Each one leads to a number</span>
                                <span style="color: #51afef;">(</span><span style="color: #51afef;">incf</span> counter <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">count-matches</span> <span style="color: #7bc275;">"\\\\$"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                <span style="color: #62686E;">;; </span><span style="color: #62686E;">unless there are nonumbers.</span>
                                <span style="color: #51afef;">(</span><span style="color: #a991f1;">goto-char</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point-min</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                                <span style="color: #51afef;">(</span><span style="color: #51afef;">decf</span> counter <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">count-matches</span> <span style="color: #7bc275;">"\\nonumber"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
                           <span style="color: #51afef;">(</span>t
                            <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">cons</span> begin nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

      <span style="color: #51afef;">(</span><span style="color: #51afef;">when</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> numberp <span style="color: #7bc275;">(</span><span style="color: #a991f1;">cdr</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">assoc</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">point</span><span style="color: #C57BDB;">)</span> results<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setf</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">car</span> args<span style="color: #7bc275;">)</span>
              <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span>
               <span style="color: #51afef;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"\\setcounter{equation}{%s}\n"</span> numberp<span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #a991f1;">car</span> args<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>

    <span style="color: #7bc275;">(</span><span style="color: #a991f1;">apply</span> orig-func args<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>


  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">scimax-toggle-latex-equation-numbering</span> <span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"Toggle whether LaTeX fragments are numbered."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">not</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">get</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
        <span style="color: #51afef;">(</span><span style="color: #51afef;">progn</span>
          <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-create-formula-image</span> <span style="color: #C57BDB;">:around</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span><span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">put</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span> t<span style="color: #C57BDB;">)</span>
          <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"Latex numbering enabled"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">advice-remove</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-create-formula-image</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">put</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span> nil<span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #a991f1;">message</span> <span style="color: #7bc275;">"Latex numbering disabled."</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">advice-add</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">org-create-formula-image</span> <span style="color: #C57BDB;">:around</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">put</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">scimax-org-renumber-environment</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">enabled</span> t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org78b3661" class="outline-5">
<h5 id="org78b3661"><span class="section-number-5">5.1.3.2</span> Exporting (general)</h5>
<div class="outline-text-5" id="text-5-1-3-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-export-headline-levels</span> <span style="color: #e69055; font-weight: bold;">5</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">; </span><span style="color: #62686E;">I like nesting</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org956020f" class="outline-5">
<h5 id="org956020f"><span class="section-number-5">5.1.3.3</span> Exporting to HTML</h5>
<div class="outline-text-5" id="text-5-1-3-3">
</div>
<div id="outline-container-org43a07b2" class="outline-6">
<h6 id="org43a07b2"><span class="section-number-6">5.1.3.3.1</span> Custom CSS/JS</h6>
<div class="outline-text-6" id="text-5-1-3-3-1">
<p>
There is a fantastic exporter config (<a href="https://github.com/fniessen/org-html-themes">fniessen/org-html-themes</a>) which we can
setup to be used with all our org files. Since most of the syntax highlighting
colours from our <a href="#orgfbbb5dc">2.3.1.2</a> gets used, we benefit from customising the code block style.
</p>
<p>
We also want to make the background and foreground colours of the <code>&lt;pre&gt;</code> blocks
match out theme (they don&rsquo;t by default), so I scraped some code from <code>emacs.stackexchange</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">my-org-inline-css-hook</span> <span style="color: #C57BDB;">(</span>exporter<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Insert custom inline css to automatically set the</span>
<span style="color: #7e7e87;">   background of code to whatever theme I'm using's background"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">when</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> exporter <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">html</span><span style="color: #7bc275;">)</span>
      <span style="color: #7bc275;">(</span><span style="color: #51afef;">setq</span>
       <span style="color: #DFDFDF;">org-html-head-extra</span>
       <span style="color: #51afef;">(</span><span style="color: #a991f1;">concat</span>
        <span style="color: #DFDFDF;">org-html-head-extra</span>
        <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">format</span> <span style="color: #7bc275;">"</span>
<span style="color: #7bc275;">&lt;style type=\"text/css\"&gt;</span>
<span style="color: #7bc275;">   :root {</span>
<span style="color: #7bc275;">      --theme-bg: %s;</span>
<span style="color: #7bc275;">      --theme-bg-alt: %s;</span>
<span style="color: #7bc275;">      --theme-base0: %s;</span>
<span style="color: #7bc275;">      --theme-base1: %s;</span>
<span style="color: #7bc275;">      --theme-base2: %s;</span>
<span style="color: #7bc275;">      --theme-base3: %s;</span>
<span style="color: #7bc275;">      --theme-base4: %s;</span>
<span style="color: #7bc275;">      --theme-base5: %s;</span>
<span style="color: #7bc275;">      --theme-base6: %s;</span>
<span style="color: #7bc275;">      --theme-base7: %s;</span>
<span style="color: #7bc275;">      --theme-base8: %s;</span>
<span style="color: #7bc275;">      --theme-fg: %s;</span>
<span style="color: #7bc275;">      --theme-fg-alt: %s;</span>
<span style="color: #7bc275;">      --theme-grey: %s;</span>
<span style="color: #7bc275;">      --theme-red: %s;</span>
<span style="color: #7bc275;">      --theme-orange: %s;</span>
<span style="color: #7bc275;">      --theme-green: %s;</span>
<span style="color: #7bc275;">      --theme-teal: %s;</span>
<span style="color: #7bc275;">      --theme-yellow: %s;</span>
<span style="color: #7bc275;">      --theme-blue: %s;</span>
<span style="color: #7bc275;">      --theme-dark-blue: %s;</span>
<span style="color: #7bc275;">      --theme-magenta: %s;</span>
<span style="color: #7bc275;">      --theme-violet: %s;</span>
<span style="color: #7bc275;">      --theme-cyan: %s;</span>
<span style="color: #7bc275;">      --theme-dark-cyan: %s;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">&lt;/style&gt;"</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bg</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">bg-alt</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base0</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base1</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base2</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base3</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base4</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base5</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base6</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base7</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">base8</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">fg</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">fg-alt</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">grey</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">red</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">orange</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">green</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">teal</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">yellow</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">blue</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">dark-blue</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">magenta</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">violet</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">cyan</span><span style="color: #7bc275;">)</span>
       <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">doom-color</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">dark-cyan</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #7bc275;">"</span>
<span style="color: #7bc275;">&lt;link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css'/&gt;</span>
<span style="color: #7bc275;">&lt;link rel='stylesheet' type='text/css' href='https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css'/&gt;</span>

<span style="color: #7bc275;">&lt;script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'&gt;&lt;/script&gt;</span>
<span style="color: #7bc275;">&lt;script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js'&gt;&lt;/script&gt;</span>
<span style="color: #7bc275;">&lt;script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js'&gt;&lt;/script&gt;</span>
<span style="color: #7bc275;">&lt;script type='text/javascript' src='https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js'&gt;&lt;/script&gt;</span>

<span style="color: #7bc275;">&lt;style&gt;</span>
<span style="color: #7bc275;">   pre.src {</span>
<span style="color: #7bc275;">     background-color: var(--theme-bg);</span>
<span style="color: #7bc275;">     color: var(--theme-fg);</span>
<span style="color: #7bc275;">     scrollbar-color:#bbb6#9992;</span>
<span style="color: #7bc275;">     scrollbar-width: thin;</span>
<span style="color: #7bc275;">     margin: 0;</span>
<span style="color: #7bc275;">     border: none;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   div.org-src-container {</span>
<span style="color: #7bc275;">     border-radius: 12px;</span>
<span style="color: #7bc275;">     overflow: hidden;</span>
<span style="color: #7bc275;">     margin-bottom: 24px;</span>
<span style="color: #7bc275;">     margin-top: 1px;</span>
<span style="color: #7bc275;">     border: 1px solid#e1e4e5;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   pre.src::before {</span>
<span style="color: #7bc275;">     background-color:#6666;</span>
<span style="color: #7bc275;">     top: 8px;</span>
<span style="color: #7bc275;">     border: none;</span>
<span style="color: #7bc275;">     border-radius: 5px;</span>
<span style="color: #7bc275;">     line-height: 1;</span>
<span style="color: #7bc275;">     border: 2px solid var(--theme-bg);</span>
<span style="color: #7bc275;">     opacity: 0;</span>
<span style="color: #7bc275;">     transition: opacity 200ms;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   pre.src:hover::before { opacity: 1; }</span>
<span style="color: #7bc275;">   pre.src:active::before { opacity: 0; }</span>

<span style="color: #7bc275;">   pre.example {</span>
<span style="color: #7bc275;">     border-radius: 12px;</span>
<span style="color: #7bc275;">     background: var(--theme-bg-alt);</span>
<span style="color: #7bc275;">     color: var(--theme-fg);</span>
<span style="color: #7bc275;">   }</span>

<span style="color: #7bc275;">   code {</span>
<span style="color: #7bc275;">     border-radius: 5px;</span>
<span style="color: #7bc275;">     background:#e8e8e8;</span>
<span style="color: #7bc275;">     font-size: 80%;</span>
<span style="color: #7bc275;">   }</span>

<span style="color: #7bc275;">   kbd {</span>
<span style="color: #7bc275;">     display: inline-block;</span>
<span style="color: #7bc275;">     padding: 3px 5px;</span>
<span style="color: #7bc275;">     font: 80% SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;</span>
<span style="color: #7bc275;">     line-height: normal;</span>
<span style="color: #7bc275;">     line-height: 10px;</span>
<span style="color: #7bc275;">     color:#444d56;</span>
<span style="color: #7bc275;">     vertical-align: middle;</span>
<span style="color: #7bc275;">     background-color:#fafbfc;</span>
<span style="color: #7bc275;">     border: 1px solid#d1d5da;</span>
<span style="color: #7bc275;">     border-radius: 3px;</span>
<span style="color: #7bc275;">     box-shadow: inset 0 -1px 0#d1d5da;</span>
<span style="color: #7bc275;">   }</span>

<span style="color: #7bc275;">   table {</span>
<span style="color: #7bc275;">     max-width: 100%;</span>
<span style="color: #7bc275;">     overflow-x: auto;</span>
<span style="color: #7bc275;">     display: block;</span>
<span style="color: #7bc275;">     border-top: none;</span>
<span style="color: #7bc275;">   }</span>

<span style="color: #7bc275;">   a {</span>
<span style="color: #7bc275;">       text-decoration: none;</span>
<span style="color: #7bc275;">       background-image: linear-gradient(#d8dce9, #d8dce9);</span>
<span style="color: #7bc275;">       background-position: 0% 100%;</span>
<span style="color: #7bc275;">       background-repeat: no-repeat;</span>
<span style="color: #7bc275;">       background-size: 0% 2px;</span>
<span style="color: #7bc275;">       transition: background-size .3s;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   </span><span style="color: #FCCE7B;">\</span><span style="color: #7bc275;">#table-of-contents a {</span>
<span style="color: #7bc275;">       background-image: none;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   a:hover, a:focus {</span>
<span style="color: #7bc275;">       background-size: 100% 2px;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   a[href^='#'] { font-variant-numeric: oldstyle-nums; }</span>
<span style="color: #7bc275;">   a[href^='#']:visited { color:#3091d1; }</span>

<span style="color: #7bc275;">   li .checkbox {</span>
<span style="color: #7bc275;">       display: inline-block;</span>
<span style="color: #7bc275;">       width: 0.9em;</span>
<span style="color: #7bc275;">       height: 0.9em;</span>
<span style="color: #7bc275;">       border-radius: 3px;</span>
<span style="color: #7bc275;">       margin: 3px;</span>
<span style="color: #7bc275;">       top: 4px;</span>
<span style="color: #7bc275;">       position: relative;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   li.on &gt; .checkbox { background: var(--theme-green); box-shadow: 0 0 2px var(--theme-green); }</span>
<span style="color: #7bc275;">   li.trans &gt; .checkbox { background: var(--theme-orange); box-shadow: 0 0 2px var(--theme-orange); }</span>
<span style="color: #7bc275;">   li.off &gt; .checkbox { background: var(--theme-red); box-shadow: 0 0 2px var(--theme-red); }</span>
<span style="color: #7bc275;">   li.on &gt; .checkbox::after {</span>
<span style="color: #7bc275;">     content: '';</span>
<span style="color: #7bc275;">     height: 0.45em;</span>
<span style="color: #7bc275;">     width: 0.225em;</span>
<span style="color: #7bc275;">     -webkit-transform-origin: left top;</span>
<span style="color: #7bc275;">     transform-origin: left top;</span>
<span style="color: #7bc275;">     transform: scaleX(-1) rotate(135deg);</span>
<span style="color: #7bc275;">     border-right: 2.8px solid#fff;</span>
<span style="color: #7bc275;">     border-top: 2.8px solid#fff;</span>
<span style="color: #7bc275;">     opacity: 0.9;</span>
<span style="color: #7bc275;">     left: 0.10em;</span>
<span style="color: #7bc275;">     top: 0.45em;</span>
<span style="color: #7bc275;">     position: absolute;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   li.trans &gt; .checkbox::after {</span>
<span style="color: #7bc275;">       content: '';</span>
<span style="color: #7bc275;">       font-weight: bold;</span>
<span style="color: #7bc275;">       font-size: 1.6em;</span>
<span style="color: #7bc275;">       position: absolute;</span>
<span style="color: #7bc275;">       top: 0.23em;</span>
<span style="color: #7bc275;">       left: 0.09em;</span>
<span style="color: #7bc275;">       width: 0.35em;</span>
<span style="color: #7bc275;">       height: 0.12em;</span>
<span style="color: #7bc275;">       background:#fff;</span>
<span style="color: #7bc275;">       opacity: 0.9;</span>
<span style="color: #7bc275;">       border-radius: 0.1em;</span>
<span style="color: #7bc275;">   }</span>
<span style="color: #7bc275;">   li.off &gt; .checkbox::after {</span>
<span style="color: #7bc275;">    content: '&#10006;';</span>
<span style="color: #7bc275;">    color:#fff;</span>
<span style="color: #7bc275;">    opacity: 0.9;</span>
<span style="color: #7bc275;">    position: relative;</span>
<span style="color: #7bc275;">    top: -0.40rem;</span>
<span style="color: #7bc275;">    left: 0.17em;</span>
<span style="color: #7bc275;">    font-size: 0.75em;</span>
<span style="color: #7bc275;">  }</span>

<span style="color: #7bc275;">   span.timestamp {</span>
<span style="color: #7bc275;">       color: #003280;</span>
<span style="color: #7bc275;">       background: #647CFF44;</span>
<span style="color: #7bc275;">       border-radius: 3px;</span>
<span style="color: #7bc275;">       line-height: 1.25;</span>
<span style="color: #7bc275;">   }</span>

<span style="color: #7bc275;">   </span><span style="color: #FCCE7B;">\</span><span style="color: #7bc275;">#table-of-contents { overflow-y: auto; }</span>
<span style="color: #7bc275;">   blockquote p { margin: 8px 0px 16px 0px; }</span>
<span style="color: #7bc275;">   </span><span style="color: #FCCE7B;">\</span><span style="color: #7bc275;">#postamble .date { color: var(--theme-green); }</span>

<span style="color: #7bc275;">   ::-webkit-scrollbar { width: 10px; height: 8px; }</span>
<span style="color: #7bc275;">   ::-webkit-scrollbar-track { background:#9992; }</span>
<span style="color: #7bc275;">   ::-webkit-scrollbar-thumb { background:#ccc; border-radius: 10px; }</span>
<span style="color: #7bc275;">   ::-webkit-scrollbar-thumb:hover { background:#888; }</span>
<span style="color: #7bc275;">&lt;/style&gt;</span>
<span style="color: #7bc275;">"</span>
        <span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-export-before-processing-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">my-org-inline-css-hook</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1fa49b7" class="outline-6">
<h6 id="org1fa49b7"><span class="section-number-6">5.1.3.3.2</span> Make verbatim different to code</h6>
<div class="outline-text-6" id="text-5-1-3-3-2">
<p>
Since we have <kbd>verbatim</kbd> and <code>code</code>, let&rsquo;s use <kbd>verbatim</kbd> for key strokes.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-html-text-markup-alist</span>
      <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">bold</span> . <span style="color: #7bc275;">"&lt;b&gt;%s&lt;/b&gt;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>code . <span style="color: #7bc275;">"&lt;code&gt;%s&lt;/code&gt;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>italic . <span style="color: #7bc275;">"&lt;i&gt;%s&lt;/i&gt;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>strike-through . <span style="color: #7bc275;">"&lt;del&gt;%s&lt;/del&gt;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>underline . <span style="color: #7bc275;">"&lt;span class=\"underline\"&gt;%s&lt;/span&gt;"</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>verbatim . <span style="color: #7bc275;">"&lt;kbd&gt;%s&lt;/kbd&gt;"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7d01eb8" class="outline-6">
<h6 id="org7d01eb8"><span class="section-number-6">5.1.3.3.3</span> Change checkbox type</h6>
<div class="outline-text-6" id="text-5-1-3-3-3">
<p>
We also want to use HTML checkboxes, however we want to get a bit fancier than default
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
<span style="color: #C57BDB;">(</span><span style="color: #51afef;">appendq!</span> <span style="color: #DFDFDF;">org-html-checkbox-types</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span>html-span .
    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>on . <span style="color: #7bc275;">"&lt;span class='checkbox'&gt;&lt;/span&gt;"</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span>off . <span style="color: #7bc275;">"&lt;span class='checkbox'&gt;&lt;/span&gt;"</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span>trans . <span style="color: #7bc275;">"&lt;span class='checkbox'&gt;&lt;/span&gt;"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
<span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-html-checkbox-type</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">html-span</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
<ul class="org-ul">
<li class="off"><span class='checkbox'></span> I&rsquo;m yet to do this</li>
<li class="trans"><span class='checkbox'></span> Work in progress</li>
<li class="on"><span class='checkbox'></span> This is done</li>
</ul>
</div>
</div>
<div id="outline-container-org1df6216" class="outline-6">
<h6 id="org1df6216"><span class="section-number-6">5.1.3.3.4</span> LaTeX Rendering</h6>
<div class="outline-text-6" id="text-5-1-3-3-4">
<p>
On the maths side of things, I consider <code>dvisvgm</code> to be a rather compelling
option. However this isn&rsquo;t sized very well at the moment.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #62686E;">(setq-default org-html-with-latex `dvisvgm)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfb8310c" class="outline-5">
<h5 id="orgfb8310c"><span class="section-number-5">5.1.3.4</span> Exporting to LaTeX</h5>
<div class="outline-text-5" id="text-5-1-3-4">
<p>
I like automatically using spaced small caps for acronyms. For strings I want to
be unaffected lest&rsquo;s use <code>;</code> as a prefix to prevent the transformation &#x2014; i.e.
<code>;JFK</code> (as one would want for two-letter geographic locations and names).
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #62686E;"> make this /only/ apply to text (i.e. not URL)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> org
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">tec/org-export-latex-filter-acronym</span> <span style="color: #7bc275;">(</span>text backend info<span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">when</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">org-export-derived-backend-p</span> backend <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span><span style="color: #51afef;">let</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span><span style="color: #DFDFDF;">case-fold-search</span> nil<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
        <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">replace-regexp-in-string</span>
         <span style="color: #7bc275;">";?\\b[A-Z][A-Z]+s?"</span>
         <span style="color: #7bc275;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #51afef;">(</span>all-caps-str<span style="color: #51afef;">)</span>
           <span style="color: #62686E;">; </span><span style="color: #62686E;">only \acr if str doesn't start with ";"</span>
           <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">equal</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">aref</span> all-caps-str <span style="color: #e69055; font-weight: bold;">0</span><span style="color: #7bc275;">)</span> <span style="color: #e69055; font-weight: bold;">59</span><span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">substring</span> all-caps-str <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #C57BDB;">)</span>
             <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">equal</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">aref</span> all-caps-str <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">-</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">length</span> all-caps-str<span style="color: #7bc275;">)</span> <span style="color: #e69055; font-weight: bold;">1</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> ?s<span style="color: #7bc275;">)</span>
                 <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">"\\textls*[70]{\\textsc{"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">s-downcase</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">substring</span> all-caps-str <span style="color: #e69055; font-weight: bold;">0</span> <span style="color: #e69055; font-weight: bold;">-1</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #7bc275;">"}\\protect\\scalebox{.91}[.84]{s}}"</span><span style="color: #7bc275;">)</span>
               <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">"\\textls*[70]{\\textsc{"</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">s-downcase</span> all-caps-str<span style="color: #51afef;">)</span> <span style="color: #7bc275;">"}}"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
         text t t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-export-filter-plain-text-functions</span>
               <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">tec/org-export-latex-filter-acronym</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-export-filter-headline-functions</span>
               <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">tec/org-export-latex-filter-acronym</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Now for a few more adjustments.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> ox-latex
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-classes</span>
               <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"fancy-article"</span>
               <span style="color: #7bc275;">"\\documentclass{scrartcl}\n\</span>
<span style="color: #7bc275;">\\usepackage[T1]{fontenc}\n\</span>
<span style="color: #7bc275;">\\usepackage[osf,largesc,helvratio=0.9]{newpxtext}\n\</span>
<span style="color: #7bc275;">\\usepackage[scale=0.92]{sourcecodepro}\n\</span>
<span style="color: #7bc275;">\\usepackage[varbb]{newpxmath}\n\</span>
<span style="color: #7bc275;">\\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=2000]{microtype}\n\</span>
<span style="color: #7bc275;">\\usepackage{xcolor}\n\</span>
<span style="color: #7bc275;">\\setlength{\\parskip}{\\baselineskip}\n\</span>
<span style="color: #7bc275;">\\setlength{\\parindent}{0pt}"</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\section{%s}"</span> . <span style="color: #7bc275;">"\\section*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsection{%s}"</span> . <span style="color: #7bc275;">"\\subsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsubsection{%s}"</span> . <span style="color: #7bc275;">"\\subsubsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\paragraph{%s}"</span> . <span style="color: #7bc275;">"\\paragraph*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subparagraph{%s}"</span> . <span style="color: #7bc275;">"\\subparagraph*{%s}"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-classes</span>
               <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"blank"</span>
               <span style="color: #7bc275;">"[NO-DEFAULT-PACKAGES]</span>
<span style="color: #7bc275;">               [NO-PACKAGES]</span>
<span style="color: #7bc275;">               [EXTRA]"</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\section{%s}"</span> . <span style="color: #7bc275;">"\\section*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsection{%s}"</span> . <span style="color: #7bc275;">"\\subsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsubsection{%s}"</span> . <span style="color: #7bc275;">"\\subsubsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\paragraph{%s}"</span> . <span style="color: #7bc275;">"\\paragraph*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subparagraph{%s}"</span> . <span style="color: #7bc275;">"\\subparagraph*{%s}"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-classes</span>
               <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"bmc-article"</span>
               <span style="color: #7bc275;">"\\documentclass[article,code,maths]{bmc}</span>
<span style="color: #7bc275;">               [NO-DEFAULT-PACKAGES]</span>
<span style="color: #7bc275;">               [NO-PACKAGES]</span>
<span style="color: #7bc275;">               [EXTRA]"</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\section{%s}"</span> . <span style="color: #7bc275;">"\\section*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsection{%s}"</span> . <span style="color: #7bc275;">"\\subsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsubsection{%s}"</span> . <span style="color: #7bc275;">"\\subsubsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\paragraph{%s}"</span> . <span style="color: #7bc275;">"\\paragraph*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subparagraph{%s}"</span> . <span style="color: #7bc275;">"\\subparagraph*{%s}"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-classes</span>
               <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"bmc"</span>
               <span style="color: #7bc275;">"\\documentclass[code,maths]{bmc}</span>
<span style="color: #7bc275;">               [NO-DEFAULT-PACKAGES]</span>
<span style="color: #7bc275;">               [NO-PACKAGES]</span>
<span style="color: #7bc275;">               [EXTRA]"</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\chapter{%s}"</span> . <span style="color: #7bc275;">"\\chapter*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\section{%s}"</span> . <span style="color: #7bc275;">"\\section*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsection{%s}"</span> . <span style="color: #7bc275;">"\\subsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subsubsection{%s}"</span> . <span style="color: #7bc275;">"\\subsubsection*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\paragraph{%s}"</span> . <span style="color: #7bc275;">"\\paragraph*{%s}"</span><span style="color: #51afef;">)</span>
               <span style="color: #51afef;">(</span><span style="color: #7bc275;">"\\subparagraph{%s}"</span> . <span style="color: #7bc275;">"\\subparagraph*{%s}"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-latex-default-class</span> <span style="color: #7bc275;">"fancy-article"</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-latex-packages-alist</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">""</span> <span style="color: #7bc275;">"minted"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-latex-listings</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">minted</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-latex-minted-options</span>
        <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"frame"</span> <span style="color: #7bc275;">"lines"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"fontsize"</span> <span style="color: #7bc275;">"\\scriptsize"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"linenos"</span> <span style="color: #7bc275;">""</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakanywhere"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakautoindent"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breaklines"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"autogobble"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"obeytabs"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"python3"</span> <span style="color: #7bc275;">"true"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakbefore"</span> <span style="color: #7bc275;">"\\\\\\.+"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakafter"</span> <span style="color: #7bc275;">"\\,"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"style"</span> <span style="color: #7bc275;">"autumn"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breaksymbol"</span> <span style="color: #7bc275;">"\\tiny\\ensuremath{\\hookrightarrow}"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakanywheresymbolpre"</span> <span style="color: #7bc275;">"\\,\\footnotesize\\ensuremath{{}_{\\rfloor}}"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakbeforesymbolpre"</span> <span style="color: #7bc275;">"\\,\\footnotesize\\ensuremath{{}_{\\rfloor}}"</span><span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #7bc275;">"breakaftersymbolpre"</span> <span style="color: #7bc275;">"\\,\\footnotesize\\ensuremath{{}_{\\rfloor}}"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>

  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-latex-hyperref-template</span> <span style="color: #7bc275;">"\\hypersetup{</span>
<span style="color: #7bc275;">  pdfauthor={%a},</span>
<span style="color: #7bc275;">  pdftitle={%t},</span>
<span style="color: #7bc275;">  pdfkeywords={%k},</span>
<span style="color: #7bc275;">  pdfsubject={%d},</span>
<span style="color: #7bc275;">  pdfcreator={%c},</span>
<span style="color: #7bc275;">  pdflang={%L},</span>
<span style="color: #7bc275;">  breaklinks=true,</span>
<span style="color: #7bc275;">  colorlinks=true,</span>
<span style="color: #7bc275;">  linkcolor=,</span>
<span style="color: #7bc275;">  urlcolor=blue!70!green,</span>
<span style="color: #7bc275;">  citecolor=green!60!blue\n}</span>
<span style="color: #7bc275;">\\urlstyle{same}\n"</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-latex-pdf-process</span>
        <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"latexmk -shell-escape -interaction=nonstopmode -f -pdf -output-directory=%o %f"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbf642a1" class="outline-5">
<h5 id="orgbf642a1"><span class="section-number-5">5.1.3.5</span> Exporting to Beamer</h5>
<div class="outline-text-5" id="text-5-1-3-5">
<p>
It&rsquo;s nice to use a different theme
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-beamer-theme</span> <span style="color: #7bc275;">"[progressbar=foot]metropolis"</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Then customise it a bit
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>
<p>
And I think that it&rsquo;s natural to divide a presentation into sections, e.g.
Introduction, Overview&#x2026; so let&rsquo;s set bump up the headline level that becomes a
frame from <code>1</code> to <code>2</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">org-beamer-frame-level</span> <span style="color: #e69055; font-weight: bold;">2</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org62ac7a3" class="outline-5">
<h5 id="org62ac7a3"><span class="section-number-5">5.1.3.6</span> Exporting to GFM</h5>
<div class="outline-text-5" id="text-5-1-3-6">
<p>
We just need to load <code>ox-gfm</code> for org-mode documents
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">eval-after-load</span> <span style="color: #7bc275;">"org"</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #51afef;">require</span> <span style="color: #C57BDB;">'</span><span style="color: #a991f1;">ox-gfm</span> nil t<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgbcfdf00" class="outline-4">
<h4 id="orgbcfdf00"><span class="section-number-4">5.1.4</span> Babel</h4>
<div class="outline-text-4" id="text-5-1-4">
<p>
Doom lazy-loads babel languages, with is lovely.
</p>

<p>
We need to tell babel to use python3. Who uses python2 anymore anyway? And why
doesn&rsquo;t <code>python</code> refer to the latest version!?
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> org-babel-python-command <span style="color: #7bc275;">"python3"</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
We also like autocompletion here
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">tec-org-python</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #DFDFDF;">major-mode</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">python-mode</span><span style="color: #7bc275;">)</span>
   <span style="color: #7bc275;">(</span><span style="color: #51afef;">progn</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">anaconda-mode</span> t<span style="color: #51afef;">)</span>
          <span style="color: #51afef;">(</span><span style="color: #DFDFDF;">company-mode</span> t<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">org-src-mode-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">tec-org-python</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf71b26a" class="outline-4">
<h4 id="orgf71b26a"><span class="section-number-4">5.1.5</span> ESS</h4>
<div class="outline-text-4" id="text-5-1-5">
<p>
We don&rsquo;t want <code>R</code> evaluation to hang the editor, hence
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> ess-eval-visibly <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">nowait</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Syntax highlighting is nice, so let&rsquo;s turn all of that on
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> ess-R-font-lock-keywords <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>ess-R-fl-keyword:keywords . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:constants . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:modifiers . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:fun-defs . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:assign-ops . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:%op% . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-fl-keyword:fun-calls . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-fl-keyword:numbers . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-fl-keyword:operators . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-fl-keyword:delimiters . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-fl-keyword:= . t<span style="color: #7bc275;">)</span>
 <span style="color: #7bc275;">(</span>ess-R-fl-keyword:F&amp;T . t<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge478182" class="outline-3">
<h3 id="orge478182"><span class="section-number-3">5.2</span> LaTeX</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-org9bf6abf" class="outline-4">
<h4 id="org9bf6abf"><span class="section-number-4">5.2.1</span> To-be-implemented ideas</h4>
<div class="outline-text-4" id="text-5-2-1">
<ul class="org-ul">
<li>Paste image from clipboard
<ul class="org-ul">
<li>Determine first folder in <code>graphicspath</code> if applicable</li>
<li>Ask for file name</li>
<li><p>
Use <code>xclip</code> to save file to graphics folder, or current directory (whichever applies)
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #C57BDB;">command</span> -v xclip &gt;/dev/null <span style="color: #e69055; font-weight: bold;">2</span>&gt;&amp;<span style="color: #e69055; font-weight: bold;">1</span> || <span style="color: #51afef;">{</span> <span style="color: #FCCE7B;">echo</span> &gt;&amp;<span style="color: #e69055; font-weight: bold;">1</span> <span style="color: #7bc275;">"no xclip"</span>; <span style="color: #51afef;">exit</span> <span style="color: #e69055; font-weight: bold;">1</span>; <span style="color: #51afef;">}</span>

<span style="color: #51afef;">if</span>
xclip -selection clipboard -target image/png -o &gt;/dev/null <span style="color: #e69055; font-weight: bold;">2</span>&gt;&amp;<span style="color: #e69055; font-weight: bold;">1</span>
<span style="color: #51afef;">then</span>
xclip -selection clipboard -target image/png -o &gt;$<span style="color: #e69055; font-weight: bold;">1</span> <span style="color: #e69055; font-weight: bold;">2</span>&gt;/dev/null
<span style="color: #FCCE7B;">echo</span> $<span style="color: #e69055; font-weight: bold;">1</span>
<span style="color: #51afef;">else</span>
<span style="color: #FCCE7B;">echo</span> <span style="color: #7bc275;">"no image"</span>
<span style="color: #51afef;">fi</span>
</pre>
</div></li>
<li>Insert figure, with filled in details as a result (activate <kbd>yasnippet</kbd> with
filename as variable maybe?)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org926a361" class="outline-4">
<h4 id="org926a361"><span class="section-number-4">5.2.2</span> Compilation</h4>
<div class="outline-text-4" id="text-5-2-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">TeX-save-query</span> nil
      <span style="color: #DFDFDF;">TeX-show-compilation</span> t
      <span style="color: #DFDFDF;">TeX-command-extra-options</span> <span style="color: #7bc275;">"-shell-escape"</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> latex
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">TeX-command-list</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"XeLaTeX"</span> <span style="color: #7bc275;">"%`xelatex%(mode)%' %t"</span> TeX-run-TeX nil t<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc008dac" class="outline-4">
<h4 id="orgc008dac"><span class="section-number-4">5.2.3</span> Snippet value</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
For use in the new-file template, let&rsquo;s set out a nice preamble we may want to use.
</p>
<div class="org-src-container">
<pre class="src src-latex" id="orgfee85ec"><span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">pdfa,unicode=true,hidelinks</span>]{<span style="color: #5cEfFF;">hyperref</span>}

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">dvipsnames,svgnames,table,hyperref</span>]{<span style="color: #5cEfFF;">xcolor</span>}
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">renewcommand</span>{<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">UrlFont</span>}{<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">ttfamily</span><span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">small</span>}

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">a-2b</span>]{<span style="color: #5cEfFF;">pdfx</span>} <span style="color: #62686E;">% why not be archival</span>

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">T1</span>]{<span style="color: #5cEfFF;">fontenc</span>}
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">osf,helvratio=0.9</span>]{<span style="color: #5cEfFF;">newpxtext</span>} <span style="color: #62686E;">% pallatino</span>
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">scale=0.92</span>]{<span style="color: #5cEfFF;">sourcecodepro</span>}

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">varbb</span>]{<span style="color: #5cEfFF;">newpxmath</span>}
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>{<span style="color: #5cEfFF;">mathtools</span>}
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>{<span style="color: #5cEfFF;">amssymb</span>}

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>[<span style="color: #DFDFDF;">activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=2000</span>]{<span style="color: #5cEfFF;">microtype</span>}
<span style="color: #62686E;">% </span><span style="color: #62686E;">microtype makes text look nicer</span>

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>{<span style="color: #5cEfFF;">graphicx</span>} <span style="color: #62686E;">% include graphics</span>
<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>{<span style="color: #5cEfFF;">grffile</span>} <span style="color: #62686E;">% fix allowed graphicx filenames</span>

<span style="color: #FCCE7B;">\</span><span style="color: #51afef;">\</span><span style="color: #51afef;">usepackage</span>{<span style="color: #5cEfFF;">booktabs</span>} <span style="color: #62686E;">% nice table rules</span>
</pre>
</div>
<p>
Then let&rsquo;s bind the content to a function, and define some nice helpers.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> tec/yas-latex-template-preamble <span style="color: #7bc275;">"</span>
<span style="color: #7bc275;">\\usepackage[pdfa,unicode=true,hidelinks]{hyperref}</span>

<span style="color: #7bc275;">\\usepackage[dvipsnames,svgnames,table,hyperref]{xcolor}</span>
<span style="color: #7bc275;">\\renewcommand{\\UrlFont}{\\ttfamily\\small}</span>

<span style="color: #7bc275;">\\usepackage[a-2b]{pdfx} % why not be archival</span>

<span style="color: #7bc275;">\\usepackage[T1]{fontenc}</span>
<span style="color: #7bc275;">\\usepackage[osf,helvratio=0.9]{newpxtext} % pallatino</span>
<span style="color: #7bc275;">\\usepackage[scale=0.92]{sourcecodepro}</span>

<span style="color: #7bc275;">\\usepackage[varbb]{newpxmath}</span>
<span style="color: #7bc275;">\\usepackage{mathtools}</span>
<span style="color: #7bc275;">\\usepackage{amssymb}</span>

<span style="color: #7bc275;">\\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=2000]{microtype}</span>
<span style="color: #7bc275;">% microtype makes text look nicer</span>

<span style="color: #7bc275;">\\usepackage{graphicx} % include graphics</span>
<span style="color: #7bc275;">\\usepackage{grffile} % fix allowed graphicx filenames</span>

<span style="color: #7bc275;">\\usepackage{booktabs} % nice table rules</span>
<span style="color: #7bc275;">"</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">tec/yas-latex-get-class-choice</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #7e7e87;">"Prompt user for LaTeX class choice"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> tec/yas-latex-class-choice <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">ivy-read</span> <span style="color: #7bc275;">"Select document class: "</span> <span style="color: #C57BDB;">'</span><span style="color: #51afef;">(</span><span style="color: #7bc275;">"article"</span> <span style="color: #7bc275;">"scrartcl"</span> <span style="color: #7bc275;">"bmc"</span><span style="color: #51afef;">)</span> <span style="color: #C57BDB;">:def</span> <span style="color: #7bc275;">"bmc"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">tec/yas-latex-preamble-if</span> <span style="color: #C57BDB;">()</span>
  <span style="color: #7e7e87;">"Based on class choice prompt for insertion of default preamble"</span>
    <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">equal</span> tec/yas-latex-class-choice <span style="color: #7bc275;">"bmc"</span><span style="color: #7bc275;">)</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">nil</span>
             <span style="color: #7bc275;">(</span><span style="color: #a991f1;">eq</span> <span style="color: #51afef;">(</span><span style="color: #5cEfFF;">read-char-choice</span> <span style="color: #7bc275;">"Include default preamble? [Type y/n]"</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>?y ?n<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> ?y<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org46175a5" class="outline-4">
<h4 id="org46175a5"><span class="section-number-4">5.2.4</span> Editor visuals</h4>
<div class="outline-text-4" id="text-5-2-4">
<p>
Once again, <i>all hail mixed pitch mode!</i>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #5cEfFF;">add-hook</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">LaTeX-mode-hook</span> <span style="color: #C57BDB;">#'</span><span style="color: #DFDFDF;">mixed-pitch-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Let&rsquo;s enhance <code>TeX-fold-math</code> a bit
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> latex
  <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">setcar</span> <span style="color: #7bc275;">(</span><span style="color: #a991f1;">assoc</span> <span style="color: #7bc275;">"&#8902;"</span> <span style="color: #DFDFDF;">LaTeX-fold-math-spec-list</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"&#9733;"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">make \star bigger</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">TeX-fold-math-spec-list</span>
      <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #62686E;">;; </span><span style="color: #62686E;">missing/better symbols</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8804;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"le"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8805;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"ge"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8800;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"ne"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">conviniance shorts</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8249;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"left"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8250;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"right"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">private macros</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8477;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"RR"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8469;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"NN"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8484;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"ZZ"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8474;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"QQ"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8450;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"CC"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8473;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"PP"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8461;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"HH"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#120124;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"EE"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#119889;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"dd"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">known commands</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">""</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"phantom"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#10090;{1}&#65295;{2}&#10091;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"frac"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>arg<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">"&#8730;"</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">TeX-fold-parenthesize-as-neccesary</span> arg<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"sqrt"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>arg<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #7bc275;">"&#11105;"</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">TeX-fold-parenthesize-as-neccesary</span> arg<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"vec"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8216;</span><span style="color: #a991f1;">{1}</span><span style="color: #7bc275;">&#8217;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"text"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">private commands</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"|{1}|"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"abs"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8214;{1}&#8214;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"norm"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8970;{1}&#8971;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"floor"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8968;{1}&#8969;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"ceil"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8970;{1}&#8969;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"round"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#119889;{1}/&#119889;{2}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"dv"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8706;{1}/&#8706;{2}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"pdv"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">fancification</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathrm"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">119743</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathbf"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">119951</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathcal"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">120003</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathfrak"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">120055</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathbb"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">120159</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathsf"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>word<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #e69055; font-weight: bold;">120367</span> word<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"mathtt"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #C57BDB;">)</span>
      <span style="color: #DFDFDF;">TeX-fold-macro-spec-list</span>
      <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">as the defaults</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[f]"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"footnote"</span> <span style="color: #7bc275;">"marginpar"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[c]"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"cite"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[l]"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"label"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[r]"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"ref"</span> <span style="color: #7bc275;">"pageref"</span> <span style="color: #7bc275;">"eqref"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[i]"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"index"</span> <span style="color: #7bc275;">"glossary"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"..."</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"dots"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"emph"</span> <span style="color: #7bc275;">"textit"</span> <span style="color: #7bc275;">"textsl"</span> <span style="color: #7bc275;">"textmd"</span> <span style="color: #7bc275;">"textrm"</span> <span style="color: #7bc275;">"textsf"</span> <span style="color: #7bc275;">"texttt"</span>
            <span style="color: #7bc275;">"textbf"</span> <span style="color: #7bc275;">"textsc"</span> <span style="color: #7bc275;">"textup"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">tweaked defaults</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#169;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"copyright"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#174;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"textregistered"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#8482;"</span>  <span style="color: #51afef;">(</span><span style="color: #7bc275;">"texttrademark"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"[1]:||&#9658;"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"item"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#10081;&#10081;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"part"</span> <span style="color: #7bc275;">"part*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#10081;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"chapter"</span> <span style="color: #7bc275;">"chapter*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#167;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"section"</span> <span style="color: #7bc275;">"section*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#167;&#167;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"subsection"</span> <span style="color: #7bc275;">"subsection*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#167;&#167;&#167;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"subsubsection"</span> <span style="color: #7bc275;">"subsubsection*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#182;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"paragraph"</span> <span style="color: #7bc275;">"paragraph*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#182;&#182;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"subparagraph"</span> <span style="color: #7bc275;">"subparagraph*"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #62686E;">;; </span><span style="color: #62686E;">extra</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#11030;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"begin"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"&#11031;&#8198;{1}"</span> <span style="color: #51afef;">(</span><span style="color: #7bc275;">"end"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
        <span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">string-offset-roman-chars</span> <span style="color: #C57BDB;">(</span>offset word<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Shift the codepoint of each charachter in WORD by OFFSET with an extra -6 shift if the letter is lowercase"</span>
    <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">apply</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">string</span>
       <span style="color: #7bc275;">(</span><span style="color: #a991f1;">mapcar</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">lambda</span> <span style="color: #C57BDB;">(</span>c<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">(</span><span style="color: #a991f1;">+</span> <span style="color: #7bc275;">(</span><span style="color: #51afef;">if</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">&gt;=</span> c <span style="color: #e69055; font-weight: bold;">97</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">(</span><span style="color: #a991f1;">-</span> c <span style="color: #e69055; font-weight: bold;">6</span><span style="color: #51afef;">)</span> c<span style="color: #7bc275;">)</span> offset<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> word<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">TeX-fold-parenthesize-as-neccesary</span> <span style="color: #C57BDB;">(</span>tokens <span style="color: #FCCE7B;">&amp;optional</span> suppress-left suppress-right<span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Add &#10090; &#10091; parenthesis as if multiple LaTeX tokens appear to be present"</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">if</span> <span style="color: #7bc275;">(</span><span style="color: #5cEfFF;">string-match-p</span> <span style="color: #7bc275;">"^\\\\?\\w+$"</span> tokens<span style="color: #7bc275;">)</span> tokens
    <span style="color: #7bc275;">(</span><span style="color: #a991f1;">concat</span> <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> suppress-left <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">"&#10090;"</span><span style="color: #51afef;">)</span>
            tokens
            <span style="color: #51afef;">(</span><span style="color: #51afef;">if</span> suppress-right <span style="color: #7bc275;">""</span> <span style="color: #7bc275;">"&#10091;"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Some local keybindings to make life a bit easier
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> tex
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">map!</span>
   <span style="color: #C57BDB;">:map</span> <span style="color: #DFDFDF;">LaTeX-mode-map</span>
   <span style="color: #C57BDB;">:ei</span> <span style="color: #7bc275;">[</span>C-return<span style="color: #7bc275;">]</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">LaTeX-insert-item</span>

   <span style="color: #62686E;">;; </span><span style="color: #62686E;">normal stuff here</span>
   <span style="color: #C57BDB;">:localleader</span>
   <span style="color: #C57BDB;">:desc</span> <span style="color: #7bc275;">"View"</span> <span style="color: #7bc275;">"v"</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">TeX-view</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">TeX-electric-math</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"</span><span style="color: #C57BDB; font-weight: bold;">\\</span><span style="color: #C57BDB; font-weight: bold;">(</span><span style="color: #7bc275;">"</span> . <span style="color: #7bc275;">""</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
Maths deliminators can be de-emphasised a bit
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #62686E;">;; </span><span style="color: #62686E;">Making \( \) less visible</span>
<span style="color: #51afef;">(</span><span style="color: #51afef;">defface</span> <span style="color: #DFDFDF;">unimportant-latex-face</span>
  <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>t
     <span style="color: #C57BDB;">:inherit</span> <span style="color: #DFDFDF;">font-lock-comment-face</span> <span style="color: #C57BDB;">:family</span> <span style="color: #7bc275;">"Overpass"</span> <span style="color: #C57BDB;">:weight</span> light<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #7e7e87;">"Face used to make \\(\\), \\[</span><span style="color: #a991f1;">\\</span><span style="color: #7e7e87;">] less visible."</span>
  <span style="color: #C57BDB;">:group</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">LaTeX-math</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">font-lock-add-keywords</span>
 <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex-mode</span>
 <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>,<span style="color: #51afef;">(</span><span style="color: #51afef;">rx</span> <span style="color: #C57BDB;">(</span><span style="color: #51afef;">and</span> <span style="color: #7bc275;">"\\"</span> <span style="color: #7bc275;">(</span>any <span style="color: #7bc275;">"()[]"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span> <span style="color: #e69055; font-weight: bold;">0</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">unimportant-latex-face</span> prepend<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
 <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">end</span><span style="color: #51afef;">)</span>

<span style="color: #51afef;">(</span><span style="color: #5cEfFF;">font-lock-add-keywords</span>
 <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">latex-mode</span>
 <span style="color: #C57BDB;">`</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">(</span>,<span style="color: #7bc275;">"\\\\[[:word:]]+"</span> <span style="color: #e69055; font-weight: bold;">0</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">font-lock-keyword-face</span> prepend<span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
 <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">end</span><span style="color: #51afef;">)</span>
</pre>
</div>

<p>
And enable shell escape for the preview
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> <span style="color: #DFDFDF;">preview-LaTeX-command</span> <span style="color: #C57BDB;">'</span><span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"%`%l \"\\nonstopmode\\nofiles\</span>
<span style="color: #7bc275;">\\PassOptionsToPackage{"</span> <span style="color: #7bc275;">(</span><span style="color: #7bc275;">","</span> . <span style="color: #DFDFDF;">preview-required-option-list</span><span style="color: #7bc275;">)</span> <span style="color: #7bc275;">"}{preview}\</span>
<span style="color: #7bc275;">\\AtBeginDocument{\\ifx\\ifPreview\\undefined"</span>
<span style="color: #DFDFDF;">preview-default-preamble</span> <span style="color: #7bc275;">"\\fi}\"%' \"\\detokenize{\" %t \"}\""</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0d253ef" class="outline-4">
<h4 id="org0d253ef"><span class="section-number-4">5.2.5</span> CDLaTeX</h4>
<div class="outline-text-4" id="text-5-2-5">
<p>
The symbols and modifies are very nice by default, but could do with a bit of
fleshing out. Let&rsquo;s change the prefix to a key which is similarly rarely used,
but more convinient, like <kbd>;</kbd>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> cdlatex
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">cdlatex-math-symbol-prefix ?\; ;; doesn't work at the moment :(</span>
   <span style="color: #DFDFDF;">cdlatex-math-symbol-alist</span>
   <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">adding missing functions to 3rd level symbols</span>
     <span style="color: #51afef;">(</span>?_    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\downarrow"</span>  <span style="color: #7bc275;">""</span>           <span style="color: #7bc275;">"\\inf"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?^    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\uparrow"</span>    <span style="color: #7bc275;">""</span>           <span style="color: #7bc275;">"\\sup"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?k    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\kappa"</span>      <span style="color: #7bc275;">""</span>           <span style="color: #7bc275;">"\\ker"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?m    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\mu"</span>         <span style="color: #7bc275;">""</span>           <span style="color: #7bc275;">"\\lim"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?c    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">""</span>             <span style="color: #7bc275;">"\\circ"</span>     <span style="color: #7bc275;">"\\cos"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?d    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\delta"</span>      <span style="color: #7bc275;">"\\partial"</span>  <span style="color: #7bc275;">"\\dim"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?D    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\Delta"</span>      <span style="color: #7bc275;">"\\nabla"</span>    <span style="color: #7bc275;">"\\deg"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #62686E;">;; </span><span style="color: #62686E;">no idea why \Phi isnt on 'F' in first place, \phi is on 'f'.</span>
     <span style="color: #51afef;">(</span>?F    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\Phi"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #62686E;">;; </span><span style="color: #62686E;">now just conveniance</span>
     <span style="color: #51afef;">(</span>?.    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\cdot"</span> <span style="color: #7bc275;">"\\dots"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?:    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\vdots"</span> <span style="color: #7bc275;">"\\ddots"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?*    <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\times"</span> <span style="color: #7bc275;">"\\star"</span> <span style="color: #7bc275;">"\\ast"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span>
   <span style="color: #DFDFDF;">cdlatex-math-modify-alist</span>
   <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span> <span style="color: #62686E;">;; </span><span style="color: #62686E;">my own stuff</span>
     <span style="color: #51afef;">(</span>?B    <span style="color: #7bc275;">"\\mathbb"</span>        nil          t    nil  nil<span style="color: #51afef;">)</span>
     <span style="color: #51afef;">(</span>?a    <span style="color: #7bc275;">"\\abs"</span>           nil          t    nil  nil<span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8a25f33" class="outline-4">
<h4 id="org8a25f33"><span class="section-number-4">5.2.6</span> SyncTeX</h4>
<div class="outline-text-4" id="text-5-2-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> tex
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">TeX-view-program-list</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #7bc275;">"Evince"</span> <span style="color: #7bc275;">"evince %o"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">add-to-list</span> <span style="color: #C57BDB;">'</span><span style="color: #DFDFDF;">TeX-view-program-selection</span> <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span>output-pdf <span style="color: #7bc275;">"Evince"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9013058" class="outline-3">
<h3 id="org9013058"><span class="section-number-3">5.3</span> R</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-org7511e8a" class="outline-4">
<h4 id="org7511e8a"><span class="section-number-4">5.3.1</span> Editor Visuals</h4>
<div class="outline-text-4" id="text-5-3-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">after!</span> ess-r-mode
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">appendq!</span> <span style="color: #DFDFDF;">+pretty-code-symbols</span>
            <span style="color: #C57BDB;">'</span><span style="color: #7bc275;">(</span><span style="color: #C57BDB;">:assign</span> <span style="color: #7bc275;">"&#10229;"</span>
              <span style="color: #C57BDB;">:multiply</span> <span style="color: #7bc275;">"&#215;"</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">set-pretty-symbols!</span> <span style="color: #C57BDB;">'</span><span style="color: #FCCE7B;">ess-r-mode</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Functional</span>
    <span style="color: #C57BDB;">:def</span> <span style="color: #7bc275;">"function"</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Types</span>
    <span style="color: #C57BDB;">:null</span> <span style="color: #7bc275;">"NULL"</span>
    <span style="color: #C57BDB;">:true</span> <span style="color: #7bc275;">"TRUE"</span>
    <span style="color: #C57BDB;">:false</span> <span style="color: #7bc275;">"FALSE"</span>
    <span style="color: #C57BDB;">:int</span> <span style="color: #7bc275;">"int"</span>
    <span style="color: #C57BDB;">:floar</span> <span style="color: #7bc275;">"float"</span>
    <span style="color: #C57BDB;">:bool</span> <span style="color: #7bc275;">"bool"</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Flow</span>
    <span style="color: #C57BDB;">:not</span> <span style="color: #7bc275;">"!"</span>
    <span style="color: #C57BDB;">:and</span> <span style="color: #7bc275;">"&amp;&amp;"</span> <span style="color: #C57BDB;">:or</span> <span style="color: #7bc275;">"||"</span>
    <span style="color: #C57BDB;">:for</span> <span style="color: #7bc275;">"for"</span>
    <span style="color: #C57BDB;">:in</span> <span style="color: #7bc275;">"%in%"</span>
    <span style="color: #C57BDB;">:return</span> <span style="color: #7bc275;">"return"</span>
    <span style="color: #62686E;">;; </span><span style="color: #62686E;">Other</span>
    <span style="color: #C57BDB;">:assign</span> <span style="color: #7bc275;">"&lt;-"</span>
    <span style="color: #C57BDB;">:multiply</span> <span style="color: #7bc275;">"%*%"</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9d7b800" class="outline-3">
<h3 id="org9d7b800"><span class="section-number-3">5.4</span> hledger</h3>
<div class="outline-text-3" id="text-5-4">
<p>
<code>ledger-mode</code> is great and all, but <code>hledger</code> seems to be more actively maintained.
For example, from 2018&#x2013;2020, the most prolific contributor to <code>ledger</code> produced
31 commits. For <code>hledger</code> this statistic is 1800 commits. In addition, over the
last decade, <code>ledger</code> seems to have lost steam, while <code>hledger</code> seems as actively
developed as ever. From this basic comparison <code>hledger</code> looks to have a more
promising outlook. It also has a few extra nicities that <code>ledger</code> doesn&rsquo;t, but is
a little slower (<code>haskell</code> vs. <code>c++</code>).
Since this uses the same format, and <code>ledger-mode</code> is well integrated into emacs,
and produced by John Wiegley &#x2014; author of <code>ledger</code> and current Emacs maintainer
&#x2014; using this seems like a good idea. Thankfully we can, with a little modification.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">setq</span> ledger-mode-should-check-version nil
      ledger-report-links-in-register nil
      ledger-binary-path <span style="color: #7bc275;">"hledger"</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7fad74f" class="outline-3">
<h3 id="org7fad74f"><span class="section-number-3">5.5</span> Markdown</h3>
<div class="outline-text-3" id="text-5-5">
<p>
Let&rsquo;s use mixed pitch, because it&rsquo;s great
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">add-hook!</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">gfm-mode</span> markdown-mode<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">#'</span><span style="color: #DFDFDF;">mixed-pitch-mode</span><span style="color: #51afef;">)</span>
</pre>
</div>
<p>
Most of the time when I write markdown, it&rsquo;s going into some app/website which
will do it&rsquo;s own line wrapping, hence we <i>only</i> want to use visual line wrapping. No hard stuff.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">add-hook!</span> <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">gfm-mode</span> markdown-mode<span style="color: #C57BDB;">)</span> <span style="color: #C57BDB;">#'</span><span style="color: #DFDFDF;">visual-line-mode</span> <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">turn-off-auto-fill</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2096635" class="outline-3">
<h3 id="org2096635"><span class="section-number-3">5.6</span> Beancount</h3>
<div class="outline-text-3" id="text-5-6">
<p>
The <a href="https://bitbucket.org/blais/beancount/src/tip/editors/emacs/beancount.el">beancount package</a> online has been put into <code>./lisp</code>, we just need to load and
enable it for <code>.beancount</code> files.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #51afef;">(</span><span style="color: #51afef;">use-package!</span> beancount
  <span style="color: #C57BDB;">:load-path</span> <span style="color: #7bc275;">"~/.config/doom/lisp"</span>
  <span style="color: #C57BDB;">:mode</span> <span style="color: #C57BDB;">(</span><span style="color: #7bc275;">"\\.beancount\\'"</span> . beancount-mode<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">:config</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">setq</span> beancount-electric-currency t<span style="color: #C57BDB;">)</span>
  <span style="color: #C57BDB;">(</span><span style="color: #51afef;">defun</span> <span style="color: #5cEfFF;">beancount-bal</span> <span style="color: #7bc275;">()</span>
    <span style="color: #7e7e87;">"Run bean-report bal."</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">interactive</span><span style="color: #7bc275;">)</span>
    <span style="color: #7bc275;">(</span><span style="color: #51afef;">let</span> <span style="color: #51afef;">(</span><span style="color: #C57BDB;">(</span><span style="color: #DFDFDF;">compilation-read-command</span> nil<span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
      <span style="color: #51afef;">(</span>beancount--run <span style="color: #7bc275;">"bean-report"</span>
                      <span style="color: #C57BDB;">(</span><span style="color: #5cEfFF;">file-relative-name</span> <span style="color: #DFDFDF;">buffer-file-name</span><span style="color: #C57BDB;">)</span> <span style="color: #7bc275;">"bal"</span><span style="color: #51afef;">)</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span>
  <span style="color: #62686E;">;; </span><span style="color: #FCCE7B; font-weight: bold;">TODO</span><span style="color: #62686E;"> make the following *work*</span>
  <span style="color: #C57BDB;">:bind</span> <span style="color: #C57BDB;">(</span><span style="color: #C57BDB;">:map</span> beancount-mode-map <span style="color: #7bc275;">(</span><span style="color: #7bc275;">"S-RET"</span> . <span style="color: #C57BDB;">#'</span><span style="color: #FCCE7B;">beancount-align-to-previous-number</span><span style="color: #7bc275;">)</span><span style="color: #C57BDB;">)</span><span style="color: #51afef;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: tecosaur</p>
<p class="date">Created: 2020-04-13 Mon 01:04</p>
</div>
</body>
</html>
